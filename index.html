<!DOCTYPE html>






  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.2.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.2.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="李国玉的技术博客，主要研究区块链方向，坚信区块链是第三次革命，拥抱区块链">
<meta property="og:type" content="website">
<meta property="og:title" content="李国玉区块链博客">
<meta property="og:url" content="http://liguoyu.com/index.html">
<meta property="og:site_name" content="李国玉区块链博客">
<meta property="og:description" content="李国玉的技术博客，主要研究区块链方向，坚信区块链是第三次革命，拥抱区块链">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="李国玉区块链博客">
<meta name="twitter:description" content="李国玉的技术博客，主要研究区块链方向，坚信区块链是第三次革命，拥抱区块链">






  <link rel="canonical" href="http://liguoyu.com/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>李国玉区块链博客</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">李国玉区块链博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>




<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-首页"></i> <br />Home</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />Tags</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-分类"></i> <br />Categories</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-归档"></i> <br />Archives</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://liguoyu.com/2018/05/11/bulas-06 手把手教你开发一款基于星云链的DAPP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李国玉">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李国玉区块链博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/11/bulas-06 手把手教你开发一款基于星云链的DAPP/" itemprop="url">
                  Nebulas-06 手把手教你开发一款基于星云链的DAPP
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-05-11 14:35:58" itemprop="dateCreated datePublished" datetime="2018-05-11T14:35:58+08:00">2018-05-11</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-05-16 09:21:38" itemprop="dateModified" datetime="2018-05-16T09:21:38+08:00">2018-05-16</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近因为星云链主网上线推出的星云激励计划，导致nas的价格一定拉升，肯定有不少朋友感觉幸运链的DAPP挺神秘的，其实不然，这里手把手教你如何开发一款基于星云链的dapp。</p>
<p>星云链主页：<a href="https://nebulas.io/cn/index.html" target="_blank" rel="noopener">https://nebulas.io/cn/index.html</a></p>
<h2 id="哪类人群适合阅读本教程呢？"><a href="#哪类人群适合阅读本教程呢？" class="headerlink" title="哪类人群适合阅读本教程呢？"></a>哪类人群适合阅读本教程呢？</h2><p>只要您具备 JavaScript 、 HTML 和 CSS一些基础知识，您就可以阅读本教程，进而开发出一款基于星云链的dapp。</p>
<p>话不多少，直接上截图：</p>
<p><img src="http://p8ghkzll5.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-14%20%E4%B8%8B%E5%8D%887.26.50.png" alt=""></p>
<p>背景图片是可以轮播变换的，这时候想象下放些从恋爱时约会、求婚、结婚、生娃、老年陪伴的图片做背景图，循环播放是不是很有感觉呢。</p>
<p>好了，上代码前先附上我的目录结构：</p>
<p><img src="http://p8ghkzll5.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-14%20%E4%B8%8B%E5%8D%888.05.53.png" alt="目录"></p>
<p>其中 lib 文件夹中的nebPay.js. 和nebulas.js 需要下载</p>
<h2 id="1-合约编写"><a href="#1-合约编写" class="headerlink" title="1. 合约编写"></a>1. 合约编写</h2><p>跟以太坊类似，Nebulas实现了NVM虚拟机来运行智能合约，NVM的实现使用了JavaScript V8引擎，所以当前的开发版，我们可以使用JavaScript、TypeScript来编写智能合约。</p>
<p>编写智能合约的简要规范：</p>
<ol>
<li>智能合约代码必须是一个Prototype的对象；</li>
<li>智能合约代码必须有一个init()的方法，这个方法只会在部署的时候被执行一次；</li>
<li>智能合约里面的私有方法是以_开头的方法，私有方法不能被外部直接调用；</li>
</ol>
<p>定义文件：contract.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//合约 n1eMo1ANL5DymS7saJz67ou1Z7kRTCGoULU</span></span><br><span class="line"><span class="comment">//hash ea3f9680c61b93262e9e031b82e676312dc53dbf82119de317bbc0af5b3b1a63</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//作为单独的类，封装一些参数，这些参数都是页面提交过来或者想展示到页面上的集合体</span></span><br><span class="line"><span class="keyword">var</span> LoveInfo = <span class="function"><span class="keyword">function</span> (<span class="params">arrys</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (arrys) &#123;</span><br><span class="line">        <span class="keyword">var</span> obj = <span class="built_in">JSON</span>.parse(arrys);</span><br><span class="line">        <span class="keyword">this</span>.mn = obj.mn;</span><br><span class="line">        <span class="keyword">this</span>.wm = obj.wm;</span><br><span class="line">        <span class="keyword">this</span>.ai = obj.ai;</span><br><span class="line">        <span class="keyword">this</span>.now = obj.now;</span><br><span class="line">        <span class="keyword">this</span>.author = obj.author;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.mn = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">this</span>.wm = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">this</span>.ai = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">this</span>.now = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">this</span>.author = <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//定义方法，转换成字符串</span></span><br><span class="line">LoveInfo.prototype = &#123;</span><br><span class="line">    toString: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//结婚登记</span></span><br><span class="line"><span class="keyword">var</span> Married = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">//LocalContractStorage.defineMapProperty是合约存储区内定义好的方法，可以直接使用，如果有小伙伴不知道怎么使用的话下面会给个链接讲解，很容易理解的</span></span><br><span class="line">    <span class="comment">//简单的理解就是给当前合约申明了一个属性叫love，然后love内部又有两个方法，parse和stringify对应着从区块链读取数据，后面操作区块链可以直接使用this.love调用对应的存取方法完成操作</span></span><br><span class="line">    LocalContractStorage.defineMapProperty(<span class="keyword">this</span>,<span class="string">"love"</span>,&#123;</span><br><span class="line">        parse : <span class="function"><span class="keyword">function</span> (<span class="params">arrys</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> LoveInfo(arrys)</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        stringify: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> res.toString()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//合约内定义的方法</span></span><br><span class="line">Married.prototype = &#123;</span><br><span class="line">    init:<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//保存到区块链的方法 需要传递的三个参数，男人名字，女人名字，爱情宣言，当前时间</span></span><br><span class="line">    save:<span class="function"><span class="keyword">function</span> (<span class="params">mn,wm,ai,now</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//做去空格处理</span></span><br><span class="line">        mn = mn.trim();</span><br><span class="line">        wm = wm.trim();</span><br><span class="line">        ai = ai.trim();</span><br><span class="line">        now = now.trim();</span><br><span class="line">        <span class="comment">//空字符串处理</span></span><br><span class="line">        <span class="keyword">if</span> (mn === <span class="string">""</span>|| mn === <span class="string">""</span>||mn === <span class="string">""</span>||mn === <span class="string">""</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"请检查登记信息，禁止登记空信息"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ai.length &gt; <span class="number">1024</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"可能你们彼此只想说一句简单的'我爱你'"</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取添加来自哪个地址</span></span><br><span class="line">        <span class="keyword">var</span> <span class="keyword">from</span> = Blockchain.transaction.from;</span><br><span class="line">        <span class="comment">//这里我们设定的key是两个名字加一起的字符串</span></span><br><span class="line">        <span class="keyword">var</span> loveInfo =  <span class="keyword">this</span>.repo.get(mn+wm);</span><br><span class="line">       <span class="comment">//如果链上有信息，说明保存过，返回提示信息</span></span><br><span class="line">        <span class="keyword">if</span> (loveInfo)&#123;</span><br><span class="line">            <span class="keyword">throw</span>  <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"信息已存在链上，可直接查看婚姻状况"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//没有信息就添加到区块链中</span></span><br><span class="line">        loveInfo = <span class="keyword">new</span> LoveInfo();</span><br><span class="line">        loveInfo.mn = mn;</span><br><span class="line">        loveInfo.wm = wm;</span><br><span class="line">        loveInfo.now = now;</span><br><span class="line">        loveInfo.ai = ai;</span><br><span class="line">        loveInfo.author = <span class="keyword">from</span>;</span><br><span class="line">        <span class="comment">//保存</span></span><br><span class="line">        <span class="keyword">this</span>.love.put(mn+wm,loveInfo);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//从区块链获取的方法 我这里定义的是两个参数，拼接在一起就是要从区块链查询的key值了</span></span><br><span class="line">    get: <span class="function"><span class="keyword">function</span> (<span class="params">mn,wm</span>) </span>&#123;</span><br><span class="line">        mn = mn.trim();</span><br><span class="line">    	wm = wm.trim();</span><br><span class="line">        <span class="keyword">if</span> ( mn === <span class="string">""</span> ) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"男方姓名不能为空"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">if</span> ( wm === <span class="string">""</span> ) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"女方姓名不能为空"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.love.get(mn+wm);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = Married;</span><br></pre></td></tr></table></figure>
<p>如果对上面调用的 LocalContractStorage.defineMapProperty 不太理解的可以点击下面的链接，有详细解释</p>
<p>智能合约存储区：<a href="https://github.com/nebulasio/wiki/blob/master/tutorials/%5B%E4%B8%AD%E6%96%87%5D%20Nebulas%20101%20-%2004%20%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%AD%98%E5%82%A8%E5%8C%BA.md" target="_blank" rel="noopener">https://github.com/nebulasio/wiki/blob/master/tutorials/%5B%E4%B8%AD%E6%96%87%5D%20Nebulas%20101%20-%2004%20%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%AD%98%E5%82%A8%E5%8C%BA.md</a></p>
<p>这样只能合约就写好了，是不是很简单，接下来就是部署了，部署方法也很简单，如果有不会的可以查看我前面写的文章</p>
<p>使用星云WEB钱包部署合约：<a href="https://www.jianshu.com/p/9c990453767c" target="_blank" rel="noopener">https://www.jianshu.com/p/9c990453767c</a></p>
<p><strong>提示：</strong>如果你们去看其他已提交的基于星云的dapp，合约都大同小异，唯一不同的就是前端页面的变化，所以，如果你的前端技术不错的话，完全可以写出几十种不同的DAPP，</p>
<h2 id="2-页面编写"><a href="#2-页面编写" class="headerlink" title="2 页面编写"></a>2 页面编写</h2><p>我这里使用到了bootstrap</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>婚姻登记所<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"assets/css/bootstrap-responsive.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--这是我自定义的css文件，用来实现页面的一些效果  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/style.css"</span>&gt;</span> </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;div class="div01"&gt;</span></span><br><span class="line"><span class="comment">    &lt;div class="search"&gt;</span></span><br><span class="line"><span class="comment">        男方姓名：&lt;input id="mn" class="input-xlarge" type="text" placeholder="username"&gt;&lt;br /&gt;</span></span><br><span class="line"><span class="comment">        女方姓名：&lt;input id="wm" class="input-xlarge" type="text" placeholder="username"&gt;&lt;br /&gt;</span></span><br><span class="line"><span class="comment">        爱情宣言：&lt;br /&gt;&lt;textarea rows="3" id = "ai"&gt;&lt;/textarea&gt;&lt;br /&gt;</span></span><br><span class="line"><span class="comment">        &lt;button id="add" class="btn btn-large btn-block btn-primary" type="button"&gt;登记&lt;/button&gt;</span></span><br><span class="line"><span class="comment">    &lt;/div&gt;</span></span><br><span class="line"><span class="comment">&lt;/div&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"div01"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form row"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-horizontal col-md-offset-3"</span> <span class="attr">id</span>=<span class="string">"login_form"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"form-title"</span>&gt;</span>婚姻登记<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-9"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--&lt;i class="fa fa-user fa-lg"&gt;&lt;/i&gt;--&gt;</span></span><br><span class="line">                   男方姓名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control required"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"man name"</span> <span class="attr">id</span>=<span class="string">"mn"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">autofocus</span>=<span class="string">"autofocus"</span> <span class="attr">maxlength</span>=<span class="string">"20"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--&lt;i class="fa fa-user fa-lg"&gt;&lt;/i&gt;--&gt;</span></span><br><span class="line">                    女方姓名：<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control required"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"woman name"</span> <span class="attr">id</span>=<span class="string">"wm"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">autofocus</span>=<span class="string">"autofocus"</span> <span class="attr">maxlength</span>=<span class="string">"20"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!--&lt;i class="fa fa-apple fa-lg"&gt;&lt;/i&gt;--&gt;</span></span><br><span class="line">                    爱情宣言：</span><br><span class="line">                    <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">maxlength</span>=<span class="string">"120"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group col-md-offset-9"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-large btn-block btn-primary"</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span> = <span class="string">'add'</span>&gt;</span>登记结婚<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">lib/nebPay.js</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">lib/nebulas.js</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="meta">    "use strict"</span>;</span></span><br><span class="line"><span class="xml">    <span class="comment">&lt;!--合约地址--&gt;</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> dappAddress = <span class="string">"n1eMo1ANL5DymS7saJz67ou1Z7kRTCGoULU"</span>;</span></span><br><span class="line"><span class="javascript">    <span class="comment">//导包 nebulas 的 API</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> nebulas = <span class="built_in">require</span>(<span class="string">"nebulas"</span>),</span></span><br><span class="line"><span class="javascript">        <span class="comment">//账户</span></span></span><br><span class="line"><span class="undefined">        Account = nebulas.Account,</span></span><br><span class="line"><span class="javascript">        <span class="comment">//neb：一套API</span></span></span><br><span class="line"><span class="javascript">        neb = <span class="keyword">new</span> nebulas.Neb();</span></span><br><span class="line"><span class="javascript">    <span class="comment">//设置网络：主网  测试网 本地网 这里使用的是测试网，所以部署合约的时候就要把合约部署到测试网上</span></span></span><br><span class="line"><span class="javascript">    neb.setRequest(<span class="keyword">new</span> nebulas.HttpRequest(<span class="string">"https://testnet.nebulas.io"</span>));</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">//添加数据，需要支付手续费 这里导包</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> NebPay = <span class="built_in">require</span>(<span class="string">"nebpay"</span>);     <span class="comment">//https://github.com/nebulasio/nebPay</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> nebPay = <span class="keyword">new</span> NebPay();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> serialNumber</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> intervalQuery</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// 添加信息功能: 像合约中添加婚姻登记信息</span></span></span><br><span class="line"><span class="javascript">    $(<span class="string">"#add"</span>).click (<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">//获取当前时间</span></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="keyword">function</span> <span class="title">p</span>(<span class="params">s</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> s &lt; <span class="number">10</span> ? <span class="string">'0'</span> + s: s;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> myDate = <span class="keyword">new</span> <span class="built_in">Date</span>();</span></span><br><span class="line"><span class="javascript">        <span class="comment">//获取当前年</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> year=myDate.getFullYear();</span></span><br><span class="line"><span class="javascript">        <span class="comment">//获取当前月</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> month=myDate.getMonth()+<span class="number">1</span>;</span></span><br><span class="line"><span class="javascript">        <span class="comment">//获取当前日</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> date=myDate.getDate();</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> h=myDate.getHours();       <span class="comment">//获取当前小时数(0-23)</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> m=myDate.getMinutes();     <span class="comment">//获取当前分钟数(0-59)</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> s=myDate.getSeconds();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> now = year+<span class="string">'-'</span>+p(month)+<span class="string">"-"</span>+p(date)+<span class="string">" "</span>+p(h)+<span class="string">':'</span>+p(m)+<span class="string">':'</span>+p(s);</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(now);</span></span><br><span class="line"><span class="javascript">        <span class="comment">//合约地址</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> to = dappAddress;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> value = <span class="string">"0"</span>;</span></span><br><span class="line"><span class="javascript">        <span class="comment">//调用的合约内哪个方法</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> callFunction = <span class="string">"save"</span>;</span></span><br><span class="line"><span class="javascript">        <span class="comment">//发送的参数</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> callArgs = <span class="string">"[\""</span> + $(<span class="string">"#mn"</span>).val() + <span class="string">"\",\""</span> + $(<span class="string">"#wm"</span>).val() +<span class="string">"\",\""</span> +$(<span class="string">"#ai"</span>).val()+ <span class="string">"\",\""</span> + now +<span class="string">"\"]"</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">//调用nebpay自带的方法，开始往区块链添加数据</span></span></span><br><span class="line"><span class="javascript">        serialNumber = nebPay.call(to, value, callFunction, callArgs, &#123;    <span class="comment">//使用nebpay的call接口去调用合约,</span></span></span><br><span class="line"><span class="javascript">            listener: cbPush        <span class="comment">//设置listener, 处理交易返回信息</span></span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="javascript">        <span class="comment">//定时器监听交易信息</span></span></span><br><span class="line"><span class="javascript">        intervalQuery = setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">            funcIntervalQuery();</span></span><br><span class="line"><span class="undefined">        &#125;, 5000);</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">funcIntervalQuery</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="undefined">        nebPay.queryPayInfo(serialNumber)</span></span><br><span class="line"><span class="javascript">            .then(<span class="function"><span class="keyword">function</span> (<span class="params">resp</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">"tx result: "</span> + resp)</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> respObject = <span class="built_in">JSON</span>.parse(resp)</span></span><br><span class="line"><span class="javascript">                <span class="keyword">if</span>(respObject.code === <span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="built_in">console</span>.log(<span class="string">"已完成登记"</span>)</span></span><br><span class="line"><span class="undefined">                    clearInterval(intervalQuery)</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;)</span></span><br><span class="line"><span class="javascript">            .catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(err);</span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="function"><span class="keyword">function</span> <span class="title">cbPush</span>(<span class="params">resp</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"response of push: "</span> + <span class="built_in">JSON</span>.stringify(resp))</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>定义的 style.css 文件</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.div01</span>&#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">"../img/love01.jpeg"</span>);</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">830px</span>;</span><br><span class="line">    <span class="attribute">animation-name</span>:myPics;</span><br><span class="line">    <span class="attribute">background-size</span>: cover;</span><br><span class="line">    <span class="attribute">animation-duration</span>:<span class="number">30s</span>;</span><br><span class="line">    <span class="comment">/*变换时间*/</span></span><br><span class="line">    <span class="attribute">animation-delay</span>:<span class="number">2s</span>;</span><br><span class="line">    <span class="comment">/*动画开始时间*/</span></span><br><span class="line">    <span class="attribute">animation-iteration-count</span>:infinite;</span><br><span class="line">    <span class="comment">/*下一周期循环播放*/</span></span><br><span class="line">    <span class="attribute">animation-play-state</span>:running;</span><br><span class="line">    <span class="comment">/*动画开始运行*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* .search &#123;</span></span><br><span class="line"><span class="comment">    width: 50%;</span></span><br><span class="line"><span class="comment">    height: 50%;</span></span><br><span class="line"><span class="comment">    margin: auto;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">.search button &#123;*/</span></span><br><span class="line">    <span class="comment">/*width: 18%;*/</span></span><br><span class="line">    <span class="comment">/*height: 30px;*/</span></span><br><span class="line">    <span class="comment">/*margin-left: 6px;*/</span></span><br><span class="line">    <span class="comment">/*box-shadow: 3px 5px grey, 1px 1px #333;*/</span></span><br><span class="line"><span class="comment">/*&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">@keyframes myPics</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    0%   &#123;background:url("../img/love01.jpeg");background-size: cover;&#125;</span></span><br><span class="line"><span class="comment">    25%  &#123;background:url("../img/love02.jpeg");background-size: cover;&#125;</span></span><br><span class="line"><span class="comment">    /*50%  &#123;background:url("../img/love3.jpeg");background-size: cover;&#125;*/</span></span><br><span class="line">    <span class="comment">/*75%  &#123;background:url("../img/love4.jpeg");background-size: cover;&#125;*/</span></span><br><span class="line">    <span class="comment">/*100% &#123;background:url("../img/love5.jpeg");background-size: cover;&#125;*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.form</span>&#123;<span class="attribute">background</span>: <span class="built_in">rgba</span>(255,255,255,0.2);<span class="attribute">width</span>:<span class="number">400px</span>;<span class="attribute">margin</span>:<span class="number">120px</span> auto;&#125;</span><br><span class="line"><span class="comment">/*阴影*/</span></span><br><span class="line"><span class="selector-class">.fa</span>&#123;<span class="attribute">display</span>: inline-block;<span class="attribute">top</span>: <span class="number">27px</span>;<span class="attribute">left</span>: <span class="number">6px</span>;<span class="attribute">position</span>: relative;<span class="attribute">color</span>: <span class="number">#ccc</span>;&#125;</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type="text"]</span>&#123;<span class="attribute">padding-left</span>:<span class="number">26px</span>;&#125;</span><br><span class="line"><span class="selector-class">.checkbox</span>&#123;<span class="attribute">padding-left</span>:<span class="number">21px</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>这样前端页面部分也就完成啦，现在让我测试下：</p>
<p>打开index.html</p>
<p><img src="http://p8ghkzll5.bkt.clouddn.com/1.png" alt="屏幕快照 2018-05-14 下午8.09.40"></p>
<p><img src="http://p8ghkzll5.bkt.clouddn.com/2.png" alt="屏幕快照 2018-05-14 下午8.09.56"></p>
<p><img src="http://p8ghkzll5.bkt.clouddn.com/3.png" alt="屏幕快照 2018-05-14 下午8.10.45"></p>
<p>大功告成！！！！！！</p>
<p>如果有心的哥们，肯定会发现我没有写查询的方法，因为时间紧张还有其他事要做，这块就留给你们了。还是那句话，在我看来前端技术好了，写星云的dapp很简单。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://liguoyu.com/2018/05/04/Nebulas-05 React整合nebulasAPI开发(下)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李国玉">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李国玉区块链博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/04/Nebulas-05 React整合nebulasAPI开发(下)/" itemprop="url">
                  Nebulas-05 React整合nebulasAPI开发(下)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-05-04 22:35:58" itemprop="dateCreated datePublished" datetime="2018-05-04T22:35:58+08:00">2018-05-04</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-05-10 19:17:22" itemprop="dateModified" datetime="2018-05-10T19:17:22+08:00">2018-05-10</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="完善前端页面"><a href="#完善前端页面" class="headerlink" title="完善前端页面"></a>完善前端页面</h1><h2 id="展示效果"><a href="#展示效果" class="headerlink" title="展示效果"></a>展示效果</h2><p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-1.png" alt="01"></p>
<h3 id="src文件夹创建文件-resultInfo-js"><a href="#src文件夹创建文件-resultInfo-js" class="headerlink" title="src文件夹创建文件 resultInfo.js"></a>src文件夹创建文件 resultInfo.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResultInfo</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">    <span class="keyword">super</span>(props)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render()&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line"></span><br><span class="line">      &lt;div style=&#123;&#123;</span><br><span class="line">        width: <span class="string">"70"</span>,</span><br><span class="line">        height: <span class="number">200</span>,</span><br><span class="line">        backgroundColor: <span class="string">"blue"</span>,</span><br><span class="line">        marginTop: <span class="number">50</span>,</span><br><span class="line">        display: <span class="string">"flex"</span>,</span><br><span class="line">        flexDirection: <span class="string">"column"</span>,</span><br><span class="line">        justifyContent: <span class="string">"space-between"</span>,</span><br><span class="line">        alignItems:<span class="string">'flex-start'</span></span><br><span class="line">      &#125;&#125;&gt;</span><br><span class="line">          &lt;h2 style=&#123;&#123;<span class="attr">margin</span>: <span class="number">0</span>,<span class="attr">fontSize</span>: <span class="number">45</span>&#125;&#125;&gt;TEST&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">          &lt;hr style=&#123;&#123;</span></span><br><span class="line"><span class="regexp">            width: 600,</span></span><br><span class="line"><span class="regexp">            height: 1,</span></span><br><span class="line"><span class="regexp">            backgroundColor: "black"</span></span><br><span class="line"><span class="regexp">          &#125;&#125;&gt;&lt;/</span>hr&gt;</span><br><span class="line">          &lt;h2 style=&#123;&#123;<span class="attr">margin</span>: <span class="number">0</span>,<span class="attr">marginLeft</span>: <span class="number">100</span>&#125;&#125;&gt;测试使用&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">          &lt;h2 style=&#123;&#123;margin: 0,alignSelf: 'flex-end'&#125;&#125;&gt;Autor:Ljl454vxxvbxLjl45454HJKHKJ&lt;/</span>h2&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default ResultInfo</span></span><br></pre></td></tr></table></figure>
<h3 id="上面样式的含义："><a href="#上面样式的含义：" class="headerlink" title="上面样式的含义："></a>上面样式的含义：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">width：宽度</span><br><span class="line"></span><br><span class="line">height：高度</span><br><span class="line"></span><br><span class="line">backgroundColor：背景颜色</span><br><span class="line"></span><br><span class="line">marginTop：上外边距</span><br><span class="line"></span><br><span class="line">display：使段落生出行内框 &lt;http://www.runoob.com/cssref/pr-class-display.html&gt;</span><br><span class="line"></span><br><span class="line">flexDirection:设置 &lt;div&gt; 元素内弹性盒元素的方向为相反的顺序 &lt;http://www.runoob.com/cssref/css3-pr-flex-direction.html&gt;</span><br><span class="line"></span><br><span class="line">justifyContent: 在弹性盒对象的 &lt;div&gt; 元素中的各项周围留有空白 &lt;http://www.runoob.com/cssref/css3-pr-justify-content.html&gt;</span><br><span class="line"></span><br><span class="line">alignItems:居中对齐弹性盒的各项 &lt;div&gt; 元素 &lt;http://www.runoob.com/cssref/css3-pr-align-items.html&gt;</span><br><span class="line"></span><br><span class="line">margin:设置元素的 4 个外边距</span><br><span class="line"></span><br><span class="line">fontSize:设置字体大小</span><br></pre></td></tr></table></figure>
<h2 id="修改app-js文件"><a href="#修改app-js文件" class="headerlink" title="修改app.js文件"></a>修改app.js文件</h2><h3 id="1-引入resultInfo-js文件"><a href="#1-引入resultInfo-js文件" class="headerlink" title="1. 引入resultInfo.js文件"></a>1. 引入resultInfo.js文件</h3><p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-2.png" alt="02"></p>
<h3 id="2-结构体内添加state状态机"><a href="#2-结构体内添加state状态机" class="headerlink" title="2. 结构体内添加state状态机"></a>2. 结构体内添加state状态机</h3><p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-3.png" alt="03"></p>
<h3 id="3-修改-render-渲染代码，新增部分内容"><a href="#3-修改-render-渲染代码，新增部分内容" class="headerlink" title="3.修改 render 渲染代码，新增部分内容"></a>3.修改 render 渲染代码，新增部分内容</h3><p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-4.png" alt="04"></p>
<h3 id="app-js-代码："><a href="#app-js-代码：" class="headerlink" title="app.js 代码："></a>app.js 代码：</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ResultInfo <span class="keyword">from</span> <span class="string">'./resultinfo'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Nebulas = <span class="built_in">require</span>(<span class="string">'nebulas'</span>)</span><br><span class="line"><span class="keyword">var</span> Neb = Nebulas.Neb; <span class="comment">// Neb</span></span><br><span class="line"><span class="keyword">var</span> neb = <span class="keyword">new</span> Neb(<span class="keyword">new</span> Nebulas.HttpRequest(<span class="string">"https://testnet.nebulas.io"</span>));</span><br><span class="line"><span class="keyword">var</span> Account = Nebulas.Account;</span><br><span class="line"><span class="keyword">var</span> api = neb.api;</span><br><span class="line"></span><br><span class="line"><span class="comment">//第一个 props  -----app的属性</span></span><br><span class="line"><span class="comment">//第二个  this.state ------app私有的属性</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">	<span class="comment">//结构提</span></span><br><span class="line">	<span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">		<span class="keyword">super</span>(props)</span><br><span class="line">		<span class="comment">//statu里面的内容属于私有，只有内部能够使访问</span></span><br><span class="line">		<span class="comment">//state又被称为 状态机变量</span></span><br><span class="line">		<span class="comment">//一旦发生变化，会重新调用render方法重新渲染</span></span><br><span class="line">		<span class="keyword">this</span>.state = &#123;</span><br><span class="line">			isResult : <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//页面渲染</span></span><br><span class="line">	render() &#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line"></span><br><span class="line">			&lt;div style=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="string">"rgb(52,83,136)"</span>,<span class="attr">flex</span>: <span class="number">1</span></span><br><span class="line">				,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">flexDirection</span>: <span class="string">'column'</span>,<span class="attr">alignItems</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">          		&lt;img src=<span class="string">"imag/logo.png"</span> style=&#123;&#123;<span class="attr">marginTop</span>: <span class="number">20</span>&#125;&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span></span><br><span class="line">         	  	&lt;div style=&#123;&#123;<span class="attr">width</span>: <span class="string">"100%"</span>,<span class="attr">height</span>: <span class="number">100</span>,<span class="attr">marginTop</span>: <span class="number">100</span>,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">justifyContent</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">              	&lt;input</span><br><span class="line">                	ref=<span class="string">"inputRef"</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">borderWidth</span>: <span class="number">3</span>,<span class="attr">borderColor</span>: <span class="string">"gray"</span>,<span class="attr">fontSize</span>: <span class="number">50</span>,<span class="attr">flex</span>: <span class="number">1</span>,<span class="attr">marginLeft</span>: <span class="number">100</span>&#125;&#125;/&gt;</span><br><span class="line">          			&#123;<span class="comment">/* //按钮标签，绑定onclick 点击时间 */</span>&#125;</span><br><span class="line">                	&lt;button onClick = &#123;() =&gt; &#123;</span><br><span class="line">                		<span class="built_in">console</span>.log(<span class="string">"搜索"</span>)</span><br><span class="line">                  	<span class="built_in">console</span>.log(<span class="keyword">this</span>.refs.inputRef.value)</span><br><span class="line"></span><br><span class="line">                  <span class="comment">//以下是调用neb自带的查询方法,用来实现从区块链上查询内容</span></span><br><span class="line">                  <span class="keyword">var</span> <span class="keyword">from</span> = <span class="string">"n1NPapTqKduzc9vFVsP1uqm1FqFEQWxj3Mp"</span>;</span><br><span class="line">                  <span class="keyword">var</span> dappAddress = <span class="string">"n1sUp7tGWfPpTZA19xgQZoWxbWobWJP52j4"</span></span><br><span class="line">                  <span class="keyword">var</span> value = <span class="string">"0"</span>;</span><br><span class="line">                  <span class="keyword">var</span> nonce = <span class="string">"0"</span></span><br><span class="line">                  <span class="keyword">var</span> gas_price = <span class="string">"1000000"</span></span><br><span class="line">                  <span class="keyword">var</span> gas_limit = <span class="string">"2000000"</span></span><br><span class="line">                  <span class="keyword">var</span> callFunction = <span class="string">"get"</span>;</span><br><span class="line">                  <span class="comment">//获取input标签输入的内容</span></span><br><span class="line">                  <span class="keyword">var</span> callArgs = <span class="string">"[\""</span> + <span class="keyword">this</span>.refs.inputRef.value + <span class="string">"\"]"</span>;</span><br><span class="line">                  <span class="keyword">var</span> contract = &#123;</span><br><span class="line">                      <span class="string">"function"</span>: callFunction,</span><br><span class="line">                      <span class="string">"args"</span>: callArgs</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">                  neb.api.call(<span class="keyword">from</span>,dappAddress,value,nonce,gas_price,gas_limit,contract).then(<span class="function">(<span class="params">resp</span>) =&gt;</span> &#123;</span><br><span class="line">                      <span class="comment">// console.log("over\n")</span></span><br><span class="line">                      <span class="built_in">console</span>.log(resp)</span><br><span class="line">											<span class="keyword">if</span> (resp[<span class="string">"result"</span>] !== <span class="string">"null"</span>) &#123;</span><br><span class="line">												<span class="comment">//修改状态机变量的值</span></span><br><span class="line">												<span class="comment">// this.setState(function()&#123;</span></span><br><span class="line">												<span class="comment">// 	return &#123;</span></span><br><span class="line">												<span class="comment">// 		isResult: true;</span></span><br><span class="line">												<span class="comment">// 	&#125;</span></span><br><span class="line">												<span class="comment">// &#125;)</span></span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">isResult</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">											&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">isResult</span>: <span class="literal">false</span>&#125;)</span><br><span class="line">											&#125;</span><br><span class="line"></span><br><span class="line">                  &#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">                      <span class="built_in">console</span>.log(<span class="string">"error:"</span> + err.message)</span><br><span class="line">                  &#125;)</span><br><span class="line"></span><br><span class="line">                	&#125;&#125;</span><br><span class="line">                	<span class="comment">//设置按钮样式</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">width</span>: <span class="number">200</span>,<span class="attr">marginLeft</span>: <span class="number">40</span>,<span class="attr">fontSize</span>: <span class="number">50</span>,<span class="attr">marginRight</span>: <span class="number">100</span>&#125;&#125; &gt;SEARCH&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">          		&lt;/</span>div&gt;</span><br><span class="line"></span><br><span class="line">							&#123;</span><br><span class="line">								<span class="comment">//根据判断结果，展示不同内容</span></span><br><span class="line">								<span class="keyword">this</span>.state.isResult ? <span class="xml"><span class="tag">&lt;<span class="name">ResultInfo</span> /&gt;</span>:<span class="tag">&lt;<span class="name">div</span> /&gt;</span></span></span><br><span class="line"><span class="xml">							&#125;</span></span><br><span class="line"><span class="xml">        	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-5.png" alt="05"></p>
<h1 id="展示添加内容"><a href="#展示添加内容" class="headerlink" title="展示添加内容"></a>展示添加内容</h1><p>效果图：</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-6.png" alt="06"></p>
<h2 id="resultInfo-js-修改两处"><a href="#resultInfo-js-修改两处" class="headerlink" title="resultInfo.js 修改两处"></a>resultInfo.js 修改两处</h2><h3 id="结构体的私有默认值"><a href="#结构体的私有默认值" class="headerlink" title="结构体的私有默认值"></a>结构体的私有默认值</h3><p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-7.png" alt="07"></p>
<h3 id="取值"><a href="#取值" class="headerlink" title="取值"></a>取值</h3><p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-8.png" alt="08"></p>
<h3 id="resultinfo-js完整代码："><a href="#resultinfo-js完整代码：" class="headerlink" title="resultinfo.js完整代码："></a>resultinfo.js完整代码：</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResultInfo</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">    <span class="keyword">super</span>(props)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//没有穿数据，使用默认数据</span></span><br><span class="line">  <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">    keyInfo : <span class="string">"ceshi01"</span>,</span><br><span class="line">    valueInfo: <span class="string">"测试02"</span>,</span><br><span class="line">    accountInfo: <span class="string">"123456789qwertyuiopasdfhkjhkh"</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render()&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line"></span><br><span class="line">      &lt;div style=&#123;&#123;</span><br><span class="line">        width: <span class="string">"70"</span>,</span><br><span class="line">        height: <span class="number">200</span>,</span><br><span class="line">        backgroundColor: <span class="string">"blue"</span>,</span><br><span class="line">        marginTop: <span class="number">50</span>,</span><br><span class="line">        display: <span class="string">"flex"</span>,</span><br><span class="line">        flexDirection: <span class="string">"column"</span>,</span><br><span class="line">        justifyContent: <span class="string">"space-between"</span>,</span><br><span class="line">        alignItems:<span class="string">'flex-start'</span></span><br><span class="line">      &#125;&#125;&gt;	</span><br><span class="line">        <span class="comment">//取值</span></span><br><span class="line">          &lt;h2 style=&#123;&#123;<span class="attr">margin</span>: <span class="number">0</span>,<span class="attr">fontSize</span>: <span class="number">45</span>&#125;&#125;&gt;&#123;<span class="keyword">this</span>.props.keyInfo&#125;&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">          &lt;hr style=&#123;&#123;</span></span><br><span class="line"><span class="regexp">            width: 600,</span></span><br><span class="line"><span class="regexp">            height: 1,</span></span><br><span class="line"><span class="regexp">            backgroundColor: "black"</span></span><br><span class="line"><span class="regexp">          &#125;&#125;&gt;&lt;/</span>hr&gt;</span><br><span class="line">          &lt;h2 style=&#123;&#123;<span class="attr">margin</span>: <span class="number">0</span>,<span class="attr">marginLeft</span>: <span class="number">100</span>&#125;&#125;&gt;&#123;<span class="keyword">this</span>.props.valueInfo&#125;&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">          &lt;h2 style=&#123;&#123;margin: 0,alignSelf: 'flex-end'&#125;&#125;&gt;Autor:&#123;this.props.accountInfo&#125;&lt;/</span>h2&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default ResultInfo</span></span><br></pre></td></tr></table></figure>
<h2 id="app-js修改部分"><a href="#app-js修改部分" class="headerlink" title="app.js修改部分"></a>app.js修改部分</h2><p>1</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-9.png" alt="09"></p>
<p>2</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-10.png" alt="10"></p>
<p>3</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-11.png" alt="11"></p>
<h3 id="app-js-s完整代码："><a href="#app-js-s完整代码：" class="headerlink" title="app.js s完整代码："></a>app.js s完整代码：</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ResultInfo <span class="keyword">from</span> <span class="string">'./resultinfo'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Nebulas = <span class="built_in">require</span>(<span class="string">'nebulas'</span>)</span><br><span class="line"><span class="keyword">var</span> Neb = Nebulas.Neb; <span class="comment">// Neb</span></span><br><span class="line"><span class="keyword">var</span> neb = <span class="keyword">new</span> Neb(<span class="keyword">new</span> Nebulas.HttpRequest(<span class="string">"https://testnet.nebulas.io"</span>));</span><br><span class="line"><span class="keyword">var</span> Account = Nebulas.Account;</span><br><span class="line"><span class="keyword">var</span> api = neb.api;</span><br><span class="line"></span><br><span class="line"><span class="comment">//第一个 props  -----app的属性</span></span><br><span class="line"><span class="comment">//第二个  this.state ------app私有的属性</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">	<span class="comment">//结构提</span></span><br><span class="line">	<span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">		<span class="keyword">super</span>(props)</span><br><span class="line">		<span class="comment">//statu里面的内容属于私有，只有内部能够使访问</span></span><br><span class="line">		<span class="comment">//state又被称为 状态机变量</span></span><br><span class="line">		<span class="comment">//一旦发生变化，会重新调用render方法重新渲染</span></span><br><span class="line">		<span class="keyword">this</span>.state = &#123;</span><br><span class="line">			isResult : <span class="literal">false</span>,</span><br><span class="line">			resultObj:&#123;&#125;,</span><br><span class="line">			<span class="comment">//判断是否第一次进入页面的标识，第一次进入不展示默认值</span></span><br><span class="line">			isSearchFail: <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//页面渲染</span></span><br><span class="line">	render() &#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line"></span><br><span class="line">			&lt;div style=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="string">"rgb(52,83,136)"</span>,<span class="attr">flex</span>: <span class="number">1</span></span><br><span class="line">				,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">flexDirection</span>: <span class="string">'column'</span>,<span class="attr">alignItems</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">          		&lt;img src=<span class="string">"imag/logo.png"</span> style=&#123;&#123;<span class="attr">marginTop</span>: <span class="number">20</span>&#125;&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span></span><br><span class="line">         	  	&lt;div style=&#123;&#123;<span class="attr">width</span>: <span class="string">"100%"</span>,<span class="attr">height</span>: <span class="number">100</span>,<span class="attr">marginTop</span>: <span class="number">100</span>,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">justifyContent</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">              	&lt;input</span><br><span class="line">                	ref=<span class="string">"inputRef"</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">borderWidth</span>: <span class="number">3</span>,<span class="attr">borderColor</span>: <span class="string">"gray"</span>,<span class="attr">fontSize</span>: <span class="number">40</span>,<span class="attr">flex</span>: <span class="number">1</span>,<span class="attr">marginLeft</span>: <span class="number">100</span>&#125;&#125;/&gt;</span><br><span class="line">          			&#123;<span class="comment">/* //按钮标签，绑定onclick 点击时间 */</span>&#125;</span><br><span class="line">                	&lt;button onClick = &#123;() =&gt; &#123;</span><br><span class="line">                		<span class="built_in">console</span>.log(<span class="string">"搜索"</span>)</span><br><span class="line">                  	<span class="built_in">console</span>.log(<span class="keyword">this</span>.refs.inputRef.value)</span><br><span class="line"></span><br><span class="line">                  <span class="comment">//以下是调用neb自带的查询方法,用来实现从区块链上查询内容</span></span><br><span class="line">                  <span class="keyword">var</span> <span class="keyword">from</span> = <span class="string">"n1NPapTqKduzc9vFVsP1uqm1FqFEQWxj3Mp"</span>;</span><br><span class="line">                  <span class="keyword">var</span> dappAddress = <span class="string">"n1sUp7tGWfPpTZA19xgQZoWxbWobWJP52j4"</span></span><br><span class="line">                  <span class="keyword">var</span> value = <span class="string">"0"</span>;</span><br><span class="line">                  <span class="keyword">var</span> nonce = <span class="string">"0"</span></span><br><span class="line">                  <span class="keyword">var</span> gas_price = <span class="string">"1000000"</span></span><br><span class="line">                  <span class="keyword">var</span> gas_limit = <span class="string">"2000000"</span></span><br><span class="line">                  <span class="keyword">var</span> callFunction = <span class="string">"get"</span>;</span><br><span class="line">                  <span class="comment">//获取input标签输入的内容</span></span><br><span class="line">                  <span class="keyword">var</span> callArgs = <span class="string">"[\""</span> + <span class="keyword">this</span>.refs.inputRef.value + <span class="string">"\"]"</span>;</span><br><span class="line">                  <span class="keyword">var</span> contract = &#123;</span><br><span class="line">                      <span class="string">"function"</span>: callFunction,</span><br><span class="line">                      <span class="string">"args"</span>: callArgs</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">                  neb.api.call(<span class="keyword">from</span>,dappAddress,value,nonce,gas_price,gas_limit,contract).then(<span class="function">(<span class="params">resp</span>) =&gt;</span> &#123;</span><br><span class="line">                      <span class="built_in">console</span>.log(resp)</span><br><span class="line">											<span class="keyword">if</span> (resp[<span class="string">"result"</span>] !== <span class="string">"null"</span>) &#123;</span><br><span class="line">												<span class="comment">//修改状态机变量的值</span></span><br><span class="line">												<span class="comment">// this.setState(function()&#123;</span></span><br><span class="line">												<span class="comment">// 	return &#123;</span></span><br><span class="line">												<span class="comment">// 		isResult: true;</span></span><br><span class="line">												<span class="comment">// 	&#125;</span></span><br><span class="line">												<span class="comment">// &#125;)</span></span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">isResult</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">												<span class="comment">//有数据展示查询出的数据，json转换</span></span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">resultObj</span>: <span class="built_in">JSON</span>.parse(resp[<span class="string">"result"</span>]),<span class="attr">isSearchFail</span>:<span class="literal">false</span>&#125;)</span><br><span class="line">											&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">												<span class="comment">//没有展示处 添加 按钮 </span></span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">isResult</span>: <span class="literal">false</span>,<span class="attr">isSearchFail</span>: <span class="literal">true</span>&#125;)</span><br><span class="line"></span><br><span class="line">											&#125;</span><br><span class="line"></span><br><span class="line">                  &#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">                      <span class="built_in">console</span>.log(<span class="string">"error:"</span> + err.message)</span><br><span class="line">                  &#125;)</span><br><span class="line"></span><br><span class="line">                	&#125;&#125;</span><br><span class="line">                	<span class="comment">//设置按钮样式</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">width</span>: <span class="number">200</span>,<span class="attr">marginLeft</span>: <span class="number">40</span>,<span class="attr">fontSize</span>: <span class="number">50</span>,<span class="attr">marginRight</span>: <span class="number">100</span>&#125;&#125; &gt;SEARCH&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">          		&lt;/</span>div&gt;</span><br><span class="line"></span><br><span class="line">							&#123;</span><br><span class="line">								<span class="comment">//根据判断结果，展示不同内容</span></span><br><span class="line">								<span class="keyword">this</span>.state.isResult ? <span class="xml"><span class="tag">&lt;<span class="name">ResultInfo</span></span></span></span><br><span class="line"><span class="xml">									keyInfo=&#123;this.state.resultObj["key"]&#125;</span></span><br><span class="line"><span class="xml">									valueInfo=&#123;this.state.resultObj["value"]&#125;</span></span><br><span class="line"><span class="xml">									accountInfo=&#123;this.state.resultObj["author"]&#125;/&gt;</span></span><br><span class="line"><span class="xml">									:</span></span><br><span class="line">									&lt;div&gt;</span><br><span class="line">										&#123;</span><br><span class="line">											this.state.isSearchFail?</span><br><span class="line">											&lt;div style=&#123;&#123;display: "flex",marginTop: 50&#125;&#125;&gt;</span><br><span class="line">												&lt;div style=&#123;&#123;height:30,fontSize: 20,color:"white"&#125;&#125;&gt;未找到内容,是否&lt;/div&gt;</span><br><span class="line">												&lt;button style=&#123;&#123;height:30,backgroundColor: "gray"&#125;&#125;&gt;add&lt;/button&gt;</span><br><span class="line">												&lt;div style=&#123;&#123;height:30,fontSize: 20,color:"white"&#125;&#125;&gt;"add"到区块链中&lt;/div&gt;</span><br><span class="line">											&lt;/div&gt;</span><br><span class="line">											:</span><br><span class="line">											&lt;div /&gt;</span><br><span class="line">										&#125;</span><br><span class="line"><span class="xml">									<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">							&#125;</span></span><br><span class="line"><span class="xml">        	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure>
<h2 id="bug修复：查询空字符串时依然展示默认数据的状况"><a href="#bug修复：查询空字符串时依然展示默认数据的状况" class="headerlink" title="bug修复：查询空字符串时依然展示默认数据的状况"></a>bug修复：查询空字符串时依然展示默认数据的状况</h2><h3 id="修改app-js文件："><a href="#修改app-js文件：" class="headerlink" title="修改app.js文件："></a>修改app.js文件：</h3><p><img src="http://p8ghajf4r.bkt.clouddn.com/0510%E2%80%94%E2%80%9412.png" alt="0510——12"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//封装传回页面的数据</span></span><br><span class="line">												<span class="keyword">var</span> obj = &#123;&#125;</span><br><span class="line">												<span class="comment">//判断是否为空数据</span></span><br><span class="line">												<span class="keyword">if</span>(resp[<span class="string">"result"</span>]==<span class="string">"Error: empty key"</span>)&#123;</span><br><span class="line">														<span class="comment">//封装空数据  模拟前端返回的数据结构</span></span><br><span class="line">														obj[<span class="string">"key"</span>] = <span class="string">""</span></span><br><span class="line">														obj[<span class="string">"value"</span>] = resp[<span class="string">"result"</span>]</span><br><span class="line">														obj[<span class="string">"author"</span>] = <span class="string">""</span></span><br><span class="line">												&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">													<span class="comment">//封装查询到的数据，使用json解析</span></span><br><span class="line">													obj = <span class="built_in">JSON</span>.parse(resp[<span class="string">"result"</span>])</span><br><span class="line">												&#125;</span><br><span class="line"></span><br><span class="line">												<span class="comment">//有数据展示查询出的数据</span></span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">resultObj</span>: obj,<span class="attr">isSearchFail</span>:<span class="literal">false</span>&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="封装"><a href="#封装" class="headerlink" title="封装"></a>封装</h2><h3 id="创建-failInfoView-js-文件"><a href="#创建-failInfoView-js-文件" class="headerlink" title="创建 failInfoView.js 文件"></a>创建 failInfoView.js 文件</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FailInfoView</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">		<span class="keyword">super</span>(props)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">    searchText : <span class="string">""</span>,</span><br><span class="line">    addFunc: <span class="function"><span class="params">()</span> =&gt;</span>&#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render()&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div style=&#123;&#123;<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">marginTop</span>: <span class="number">50</span>&#125;&#125;&gt;</span><br><span class="line">        &lt;div style=&#123;&#123;<span class="attr">height</span>:<span class="number">30</span>,<span class="attr">fontSize</span>: <span class="number">20</span>,<span class="attr">color</span>:<span class="string">"white"</span>&#125;&#125;&gt;未找到内容,是否&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;button</span></span><br><span class="line"><span class="regexp">          onClick=&#123;this.props.addFunc&#125;</span></span><br><span class="line"><span class="regexp">          style=&#123;&#123;height:30,backgroundColor: "gray"&#125;&#125;&gt;add&lt;/</span>button&gt;</span><br><span class="line">        &lt;div style=&#123;&#123;<span class="attr">height</span>:<span class="number">30</span>,<span class="attr">fontSize</span>: <span class="number">20</span>,<span class="attr">color</span>:<span class="string">"white"</span>&#125;&#125;&gt; <span class="string">"&#123;this.props.searchText&#125;"</span> 到区块链中&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> FailInfoView</span><br></pre></td></tr></table></figure>
<p>修改 app.js 文件，引入刚才封装的 failInfoView,js 模块</p>
<p><strong>注意：我创建的文件名不一样，各位换下</strong></p>
<p>引包</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-13.png" alt="0510-13"></p>
<p>改用自定义标签（引入的包对象）</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-14.png" alt="0510-14"></p>
<p>没有数据，展示新增数据的input框，效果如下</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-15.png" alt="0510-15"></p>
<p>代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ResultInfo <span class="keyword">from</span> <span class="string">'./resultinfo'</span></span><br><span class="line"><span class="keyword">import</span> FailInfo <span class="keyword">from</span> <span class="string">'./failInfo'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Nebulas = <span class="built_in">require</span>(<span class="string">'nebulas'</span>)</span><br><span class="line"><span class="keyword">var</span> Neb = Nebulas.Neb; <span class="comment">// Neb</span></span><br><span class="line"><span class="keyword">var</span> neb = <span class="keyword">new</span> Neb(<span class="keyword">new</span> Nebulas.HttpRequest(<span class="string">"https://testnet.nebulas.io"</span>));</span><br><span class="line"><span class="keyword">var</span> Account = Nebulas.Account;</span><br><span class="line"><span class="keyword">var</span> api = neb.api;</span><br><span class="line"></span><br><span class="line"><span class="comment">//第一个 props  -----app的属性</span></span><br><span class="line"><span class="comment">//第二个  this.state ------app私有的属性</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">	<span class="comment">//结构提</span></span><br><span class="line">	<span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">		<span class="keyword">super</span>(props)</span><br><span class="line">		<span class="comment">//statu里面的内容属于私有，只有内部能够使访问</span></span><br><span class="line">		<span class="comment">//state又被称为 状态机变量</span></span><br><span class="line">		<span class="comment">//一旦发生变化，会重新调用render方法重新渲染</span></span><br><span class="line">		<span class="keyword">this</span>.state = &#123;</span><br><span class="line">			isResult : <span class="literal">false</span>,</span><br><span class="line">			resultObj:&#123;&#125;,</span><br><span class="line">			<span class="comment">//判断是否第一次进入页面的标识，第一次进入不展示默认值</span></span><br><span class="line">			isSearchFail: <span class="literal">false</span>,</span><br><span class="line">			isShowInputView: <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//页面渲染</span></span><br><span class="line">	render() &#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line"></span><br><span class="line">			&lt;div style=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="string">"rgb(52,83,136)"</span>,<span class="attr">flex</span>: <span class="number">1</span></span><br><span class="line">				,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">flexDirection</span>: <span class="string">'column'</span>,<span class="attr">alignItems</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">          		&lt;img src=<span class="string">"imag/logo.png"</span> style=&#123;&#123;<span class="attr">marginTop</span>: <span class="number">20</span>&#125;&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span></span><br><span class="line">         	  	&lt;div style=&#123;&#123;<span class="attr">width</span>: <span class="string">"100%"</span>,<span class="attr">height</span>: <span class="number">100</span>,<span class="attr">marginTop</span>: <span class="number">100</span>,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">justifyContent</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">              	&lt;input</span><br><span class="line">                	ref=<span class="string">"inputRef"</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">borderWidth</span>: <span class="number">3</span>,<span class="attr">borderColor</span>: <span class="string">"gray"</span>,<span class="attr">fontSize</span>: <span class="number">40</span>,<span class="attr">flex</span>: <span class="number">1</span>,<span class="attr">marginLeft</span>: <span class="number">100</span>&#125;&#125;/&gt;</span><br><span class="line">          			&#123;<span class="comment">/* //按钮标签，绑定onclick 点击时间 */</span>&#125;</span><br><span class="line">                	&lt;button onClick = &#123;() =&gt; &#123;</span><br><span class="line">                		<span class="built_in">console</span>.log(<span class="string">"搜索"</span>)</span><br><span class="line">                  	<span class="built_in">console</span>.log(<span class="keyword">this</span>.refs.inputRef.value)</span><br><span class="line">										<span class="keyword">this</span>.setState(&#123;<span class="attr">isShowInputView</span>: <span class="literal">false</span>&#125;)</span><br><span class="line">										<span class="comment">// if(this.refs.inputRef.value == "")&#123;</span></span><br><span class="line">										<span class="comment">// 	this.setState(&#123;isSearchFail: false&#125;)</span></span><br><span class="line">										<span class="comment">// &#125;</span></span><br><span class="line">                  <span class="comment">//以下是调用neb自带的查询方法,用来实现从区块链上查询内容</span></span><br><span class="line">                  <span class="keyword">var</span> <span class="keyword">from</span> = <span class="string">"n1NPapTqKduzc9vFVsP1uqm1FqFEQWxj3Mp"</span>;</span><br><span class="line">                  <span class="keyword">var</span> dappAddress = <span class="string">"n1sUp7tGWfPpTZA19xgQZoWxbWobWJP52j4"</span></span><br><span class="line">                  <span class="keyword">var</span> value = <span class="string">"0"</span>;</span><br><span class="line">                  <span class="keyword">var</span> nonce = <span class="string">"0"</span></span><br><span class="line">                  <span class="keyword">var</span> gas_price = <span class="string">"1000000"</span></span><br><span class="line">                  <span class="keyword">var</span> gas_limit = <span class="string">"2000000"</span></span><br><span class="line">                  <span class="keyword">var</span> callFunction = <span class="string">"get"</span>;</span><br><span class="line">                  <span class="comment">//获取input标签输入的内容</span></span><br><span class="line">                  <span class="keyword">var</span> callArgs = <span class="string">"[\""</span> + <span class="keyword">this</span>.refs.inputRef.value + <span class="string">"\"]"</span>;</span><br><span class="line">                  <span class="keyword">var</span> contract = &#123;</span><br><span class="line">                      <span class="string">"function"</span>: callFunction,</span><br><span class="line">                      <span class="string">"args"</span>: callArgs</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">                  neb.api.call(<span class="keyword">from</span>,dappAddress,value,nonce,gas_price,gas_limit,contract).then(<span class="function">(<span class="params">resp</span>) =&gt;</span> &#123;</span><br><span class="line">                      <span class="built_in">console</span>.log(resp)</span><br><span class="line">											<span class="keyword">if</span> (resp[<span class="string">"result"</span>] !== <span class="string">"null"</span>) &#123;</span><br><span class="line">												<span class="comment">//修改状态机变量的值</span></span><br><span class="line">												<span class="comment">// this.setState(function()&#123;</span></span><br><span class="line">												<span class="comment">// 	return &#123;</span></span><br><span class="line">												<span class="comment">// 		isResult: true;</span></span><br><span class="line">												<span class="comment">// 	&#125;</span></span><br><span class="line">												<span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">												<span class="comment">//c参数为空的情况处理</span></span><br><span class="line">												<span class="comment">//Error: empty key</span></span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">isResult</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">												<span class="comment">//封装传回页面的数据</span></span><br><span class="line">												<span class="keyword">var</span> obj = &#123;&#125;</span><br><span class="line">												<span class="comment">//判断是否为空数据</span></span><br><span class="line">												<span class="keyword">if</span>(resp[<span class="string">"result"</span>]==<span class="string">"Error: empty key"</span>)&#123;</span><br><span class="line">														<span class="comment">//封装空数据  模拟前端返回的数据结构</span></span><br><span class="line">														obj[<span class="string">"key"</span>] = <span class="string">""</span></span><br><span class="line">														obj[<span class="string">"value"</span>] = resp[<span class="string">"result"</span>]</span><br><span class="line">														obj[<span class="string">"author"</span>] = <span class="string">""</span></span><br><span class="line">												&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">													<span class="comment">//封装查询到的数据，使用json解析</span></span><br><span class="line">													obj = <span class="built_in">JSON</span>.parse(resp[<span class="string">"result"</span>])</span><br><span class="line">												&#125;</span><br><span class="line"></span><br><span class="line">												<span class="comment">//有数据展示查询出的数据</span></span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">resultObj</span>: obj,<span class="attr">isSearchFail</span>:<span class="literal">false</span>&#125;)</span><br><span class="line">											&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">												<span class="comment">//没有展示处 添加 按钮</span></span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">isResult</span>: <span class="literal">false</span>,<span class="attr">isSearchFail</span>: <span class="literal">true</span>&#125;)</span><br><span class="line"></span><br><span class="line">											&#125;</span><br><span class="line"></span><br><span class="line">                  &#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">                      <span class="built_in">console</span>.log(<span class="string">"error:"</span> + err.message)</span><br><span class="line">                  &#125;)</span><br><span class="line"></span><br><span class="line">                	&#125;&#125;</span><br><span class="line">                	<span class="comment">//设置按钮样式</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">width</span>: <span class="number">200</span>,<span class="attr">marginLeft</span>: <span class="number">40</span>,<span class="attr">fontSize</span>: <span class="number">50</span>,<span class="attr">marginRight</span>: <span class="number">100</span>&#125;&#125; &gt;SEARCH&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">          		&lt;/</span>div&gt;</span><br><span class="line"></span><br><span class="line">							&#123;</span><br><span class="line"></span><br><span class="line">									<span class="keyword">this</span>.state.isShowInputView ?</span><br><span class="line">									&lt;div style=&#123;&#123;<span class="attr">width</span>: <span class="string">"100%"</span>,<span class="attr">display</span>: <span class="string">'flex'</span>,<span class="attr">height</span>: <span class="number">100</span>,<span class="attr">marginTop</span>: <span class="number">50</span>&#125;&#125;&gt;</span><br><span class="line">										&lt;input</span><br><span class="line">		                	ref=<span class="string">"inputRef"</span></span><br><span class="line">		                	style=&#123;&#123;<span class="attr">borderWidth</span>: <span class="number">3</span>,<span class="attr">borderColor</span>: <span class="string">"gray"</span>,<span class="attr">fontSize</span>: <span class="number">40</span>,<span class="attr">flex</span>: <span class="number">1</span>,<span class="attr">marginLeft</span>: <span class="number">100</span>&#125;&#125;/&gt;</span><br><span class="line"></span><br><span class="line">		                	&lt;button</span><br><span class="line">													onClick= &#123;()=&gt;&#123;</span><br><span class="line">														<span class="built_in">console</span>.log(<span class="string">"调用合约的save方法!"</span>)</span><br><span class="line">													&#125;&#125;</span><br><span class="line">		                	<span class="comment">//设置按钮样式</span></span><br><span class="line">		                	style=&#123;&#123;<span class="attr">width</span>: <span class="number">200</span>,<span class="attr">marginLeft</span>: <span class="number">40</span>,<span class="attr">fontSize</span>: <span class="number">50</span>,<span class="attr">marginRight</span>: <span class="number">100</span>&#125;&#125; &gt;submit&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">									&lt;/</span>div&gt;:</span><br><span class="line">									&lt;div style = &#123;&#123;<span class="attr">display</span>:<span class="string">"flex"</span>&#125;&#125;&gt;</span><br><span class="line">									&#123;</span><br><span class="line">										<span class="comment">//根据判断结果，展示不同内容</span></span><br><span class="line">										<span class="keyword">this</span>.state.isResult ? <span class="xml"><span class="tag">&lt;<span class="name">ResultInfo</span></span></span></span><br><span class="line"><span class="xml">											keyInfo=&#123;this.state.resultObj["key"]&#125;</span></span><br><span class="line"><span class="xml">											valueInfo=&#123;this.state.resultObj["value"]&#125;</span></span><br><span class="line"><span class="xml">											accountInfo=&#123;this.state.resultObj["author"]&#125;/&gt;</span></span><br><span class="line"><span class="xml">											:</span></span><br><span class="line">											&lt;div&gt;</span><br><span class="line">												&#123;</span><br><span class="line">													this.state.isSearchFail?</span><br><span class="line"></span><br><span class="line">													&lt;FailInfo</span><br><span class="line">														addFunc = &#123;()=&gt;&#123;</span><br><span class="line">															console.log("app.js  输出")</span><br><span class="line">															this.setState(&#123;isShowInputView: true&#125;)</span><br><span class="line">														&#125;&#125;</span><br><span class="line">														searchText = &#123;this.refs.inputRef.value&#125;/&gt;</span><br><span class="line">													:</span><br><span class="line">													&lt;div /&gt;</span><br><span class="line">												&#125;</span><br><span class="line">											&lt;/div&gt;</span><br><span class="line">									&#125;</span><br><span class="line"><span class="xml">									<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">							&#125;</span></span><br><span class="line"><span class="xml">        	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure>
<h3 id="细节部分（需要修改的地方）：跟着这些步骤走，思路不会乱"><a href="#细节部分（需要修改的地方）：跟着这些步骤走，思路不会乱" class="headerlink" title="细节部分（需要修改的地方）：跟着这些步骤走，思路不会乱"></a>细节部分（需要修改的地方）：跟着这些步骤走，思路不会乱</h3><p>1、定义标识，用以区分展示的是input框还是 没有数据时 提示的 add 方法</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-16.png" alt="0510-16"></p>
<p>2、标识修改<img src="http://p8ghajf4r.bkt.clouddn.com/0510-17.png" alt="0510-17"></p>
<p>3、标识修改，这个图话错了，应该是红框上面的那段代码<img src="http://p8ghajf4r.bkt.clouddn.com/0510-19.png" alt="0510-19"></p>
<p>4、input框展示代码片段<img src="http://p8ghajf4r.bkt.clouddn.com/0510-18.png" alt="0510-18"></p>
<h2 id="nebpay代码下载"><a href="#nebpay代码下载" class="headerlink" title="nebpay代码下载"></a>nebpay代码下载</h2><p>网址 <a href="https://github.com/nebulasio/nebPay" target="_blank" rel="noopener">https://github.com/nebulasio/nebPay</a></p>
<p>进入工程目录下打开终端输入以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/nebulasio/nebPay.git</span><br></pre></td></tr></table></figure>
<p>进入nebpay文件夹，执行下列命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure>
<p>打包，获取dist文件夹，复制到本目录src文件夹下</p>
<p><strong>操作package.json后需重新instal</strong>l</p>
<p>目录结构如下</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/%E9%80%89%E5%8C%BA_041.png" alt="0510-20"></p>
<p>修改本目录下package.json 添加如下内容（也可从下载的 nebpay =&gt; package.json 拷贝</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"qrcode"</span>: <span class="string">"^1.2.0"</span>,</span><br><span class="line">  <span class="string">"extend"</span>: <span class="string">"&gt;=3.0.1"</span>,</span><br><span class="line">  <span class="string">"bignumber.js"</span>: <span class="string">"^5.0.0"</span>,</span><br></pre></td></tr></table></figure>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-21.png" alt="0510-21"></p>
<h2 id="修改app-js代码"><a href="#修改app-js代码" class="headerlink" title="修改app.js代码"></a>修改app.js代码</h2><p>1、导包</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-22.png" alt="0510-22"></p>
<p>2、调用nebpay提供的方法执行保存</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/0510-23.png" alt="0510-23"></p>
<p>3、监听器对应的方法，内部定义定时器，刷新获取交易状态<img src="http://p8ghajf4r.bkt.clouddn.com/%E9%80%89%E5%8C%BA_040.png" alt="选区_040"></p>
<p>app.js完整代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> ResultInfo <span class="keyword">from</span> <span class="string">'./resultinfo'</span></span><br><span class="line"><span class="keyword">import</span> FailInfo <span class="keyword">from</span> <span class="string">'./failInfo'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> NebPay = <span class="built_in">require</span>(<span class="string">"./dist/nebpay"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建对象</span></span><br><span class="line"><span class="keyword">var</span> nebPay = <span class="keyword">new</span> NebPay()</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Nebulas = <span class="built_in">require</span>(<span class="string">'nebulas'</span>)</span><br><span class="line"><span class="keyword">var</span> Neb = Nebulas.Neb; <span class="comment">// Neb</span></span><br><span class="line"><span class="keyword">var</span> neb = <span class="keyword">new</span> Neb(<span class="keyword">new</span> Nebulas.HttpRequest(<span class="string">"https://testnet.nebulas.io"</span>));</span><br><span class="line"><span class="keyword">var</span> Account = Nebulas.Account;</span><br><span class="line"><span class="keyword">var</span> api = neb.api;</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义合约地址，换成自己的</span></span><br><span class="line"><span class="keyword">const</span> dappAddress = <span class="string">"n1sUp7tGWfPpTZA19xgQZoWxbWobWJP52j4"</span></span><br><span class="line"><span class="comment">//第一个 props  -----app的属性</span></span><br><span class="line"><span class="comment">//第二个  this.state ------app私有的属性</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">	<span class="comment">//结构提</span></span><br><span class="line">	<span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">		<span class="keyword">super</span>(props)</span><br><span class="line">		<span class="comment">//statu里面的内容属于私有，只有内部能够使访问</span></span><br><span class="line">		<span class="comment">//state又被称为 状态机变量</span></span><br><span class="line">		<span class="comment">//一旦发生变化，会重新调用render方法重新渲染</span></span><br><span class="line">		<span class="keyword">this</span>.state = &#123;</span><br><span class="line">			isResult : <span class="literal">false</span>,</span><br><span class="line">			resultObj:&#123;&#125;,</span><br><span class="line">			<span class="comment">//判断是否第一次进入页面的标识，第一次进入不展示默认值</span></span><br><span class="line">			isSearchFail: <span class="literal">false</span>,</span><br><span class="line">			isShowInputView: <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//交易状态查询，本质定时器</span></span><br><span class="line">	cbPush = <span class="function">(<span class="params">resp</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"response of push: "</span> + <span class="built_in">JSON</span>.stringify(resp))</span><br><span class="line">      setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        api.getTransactionReceipt(&#123;<span class="attr">hash</span>: resp[<span class="string">"txhash"</span>]&#125;).then(<span class="function">(<span class="params">receipt</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// 判断状态值，1 成功 2 打包中</span></span><br><span class="line">            <span class="keyword">if</span> (receipt[<span class="string">"status"</span>] == <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"pending....."</span>)</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(receipt[<span class="string">"status"</span>] == <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"交易成功......"</span>)</span><br><span class="line">								<span class="comment">//停止定时器</span></span><br><span class="line">								clearInterval(intervalId);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">								<span class="comment">//停止定时器</span></span><br><span class="line">								clearInterval(intervalId);</span><br><span class="line">						&#125;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;, <span class="number">5000</span>);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//页面渲染</span></span><br><span class="line">	render() &#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line"></span><br><span class="line">			&lt;div style=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="string">"rgb(52,83,136)"</span>,<span class="attr">flex</span>: <span class="number">1</span></span><br><span class="line">				,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">flexDirection</span>: <span class="string">'column'</span>,<span class="attr">alignItems</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">          		&lt;img src=<span class="string">"imag/logo.png"</span> style=&#123;&#123;<span class="attr">marginTop</span>: <span class="number">20</span>&#125;&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span></span><br><span class="line">         	  	&lt;div style=&#123;&#123;<span class="attr">width</span>: <span class="string">"100%"</span>,<span class="attr">height</span>: <span class="number">100</span>,<span class="attr">marginTop</span>: <span class="number">100</span>,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">justifyContent</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">              	&lt;input</span><br><span class="line">                	ref=<span class="string">"inputRef"</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">borderWidth</span>: <span class="number">3</span>,<span class="attr">borderColor</span>: <span class="string">"gray"</span>,<span class="attr">fontSize</span>: <span class="number">40</span>,<span class="attr">flex</span>: <span class="number">1</span>,<span class="attr">marginLeft</span>: <span class="number">100</span>&#125;&#125;/&gt;</span><br><span class="line">          			&#123;<span class="comment">/* //按钮标签，绑定onclick 点击时间 */</span>&#125;</span><br><span class="line">                	&lt;button onClick = &#123;() =&gt; &#123;</span><br><span class="line">                		<span class="built_in">console</span>.log(<span class="string">"搜索"</span>)</span><br><span class="line">                  	<span class="built_in">console</span>.log(<span class="keyword">this</span>.refs.inputRef.value)</span><br><span class="line">										<span class="keyword">this</span>.setState(&#123;<span class="attr">isShowInputView</span>: <span class="literal">false</span>&#125;)</span><br><span class="line">										<span class="comment">// if(this.refs.inputRef.value == "")&#123;</span></span><br><span class="line">										<span class="comment">// 	this.setState(&#123;isSearchFail: false&#125;)</span></span><br><span class="line">										<span class="comment">// &#125;</span></span><br><span class="line">                  <span class="comment">//以下是调用neb自带的查询方法,用来实现从区块链上查询内容</span></span><br><span class="line">                  <span class="keyword">var</span> <span class="keyword">from</span> = <span class="string">"n1NPapTqKduzc9vFVsP1uqm1FqFEQWxj3Mp"</span>;</span><br><span class="line">                  <span class="keyword">var</span> dappAddress = <span class="string">"n1sUp7tGWfPpTZA19xgQZoWxbWobWJP52j4"</span></span><br><span class="line">                  <span class="keyword">var</span> value = <span class="string">"0"</span>;</span><br><span class="line">                  <span class="keyword">var</span> nonce = <span class="string">"0"</span></span><br><span class="line">                  <span class="keyword">var</span> gas_price = <span class="string">"1000000"</span></span><br><span class="line">                  <span class="keyword">var</span> gas_limit = <span class="string">"2000000"</span></span><br><span class="line">                  <span class="keyword">var</span> callFunction = <span class="string">"get"</span>;</span><br><span class="line">                  <span class="comment">//获取input标签输入的内容</span></span><br><span class="line">                  <span class="keyword">var</span> callArgs = <span class="string">"[\""</span> + <span class="keyword">this</span>.refs.inputRef.value + <span class="string">"\"]"</span>;</span><br><span class="line">                  <span class="keyword">var</span> contract = &#123;</span><br><span class="line">                      <span class="string">"function"</span>: callFunction,</span><br><span class="line">                      <span class="string">"args"</span>: callArgs</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">                  neb.api.call(<span class="keyword">from</span>,dappAddress,value,nonce,gas_price,gas_limit,contract).then(<span class="function">(<span class="params">resp</span>) =&gt;</span> &#123;</span><br><span class="line">                      <span class="built_in">console</span>.log(resp)</span><br><span class="line">											<span class="keyword">if</span> (resp[<span class="string">"result"</span>] !== <span class="string">"null"</span>) &#123;</span><br><span class="line">												<span class="comment">//修改状态机变量的值</span></span><br><span class="line">												<span class="comment">// this.setState(function()&#123;</span></span><br><span class="line">												<span class="comment">// 	return &#123;</span></span><br><span class="line">												<span class="comment">// 		isResult: true;</span></span><br><span class="line">												<span class="comment">// 	&#125;</span></span><br><span class="line">												<span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">												<span class="comment">//c参数为空的情况处理</span></span><br><span class="line">												<span class="comment">//Error: empty key</span></span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">isResult</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">												<span class="comment">//封装传回页面的数据</span></span><br><span class="line">												<span class="keyword">var</span> obj = &#123;&#125;</span><br><span class="line">												<span class="comment">//判断是否为空数据</span></span><br><span class="line">												<span class="keyword">if</span>(resp[<span class="string">"result"</span>]==<span class="string">"Error: empty key"</span>)&#123;</span><br><span class="line">														<span class="comment">//封装空数据  模拟前端返回的数据结构</span></span><br><span class="line">														obj[<span class="string">"key"</span>] = <span class="string">""</span></span><br><span class="line">														obj[<span class="string">"value"</span>] = resp[<span class="string">"result"</span>]</span><br><span class="line">														obj[<span class="string">"author"</span>] = <span class="string">""</span></span><br><span class="line">												&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">													<span class="comment">//封装查询到的数据，使用json解析</span></span><br><span class="line">													obj = <span class="built_in">JSON</span>.parse(resp[<span class="string">"result"</span>])</span><br><span class="line">												&#125;</span><br><span class="line"></span><br><span class="line">												<span class="comment">//有数据展示查询出的数据</span></span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">resultObj</span>: obj,<span class="attr">isSearchFail</span>:<span class="literal">false</span>&#125;)</span><br><span class="line">											&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">												<span class="comment">//没有展示处 添加 按钮</span></span><br><span class="line">												<span class="keyword">this</span>.setState(&#123;<span class="attr">isResult</span>: <span class="literal">false</span>,<span class="attr">isSearchFail</span>: <span class="literal">true</span>&#125;)</span><br><span class="line"></span><br><span class="line">											&#125;</span><br><span class="line"></span><br><span class="line">                  &#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">                      <span class="built_in">console</span>.log(<span class="string">"error:"</span> + err.message)</span><br><span class="line">                  &#125;)</span><br><span class="line"></span><br><span class="line">                	&#125;&#125;</span><br><span class="line">                	<span class="comment">//设置按钮样式</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">width</span>: <span class="number">200</span>,<span class="attr">marginLeft</span>: <span class="number">40</span>,<span class="attr">fontSize</span>: <span class="number">50</span>,<span class="attr">marginRight</span>: <span class="number">100</span>&#125;&#125; &gt;SEARCH&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">          		&lt;/</span>div&gt;</span><br><span class="line"></span><br><span class="line">							&#123;</span><br><span class="line"></span><br><span class="line">									<span class="keyword">this</span>.state.isShowInputView ?</span><br><span class="line">									&lt;div style=&#123;&#123;<span class="attr">width</span>: <span class="string">"100%"</span>,<span class="attr">display</span>: <span class="string">'flex'</span>,<span class="attr">height</span>: <span class="number">100</span>,<span class="attr">marginTop</span>: <span class="number">50</span>&#125;&#125;&gt;</span><br><span class="line">										&lt;input</span><br><span class="line">		                	ref=<span class="string">"inputValueRef"</span></span><br><span class="line">		                	style=&#123;&#123;<span class="attr">borderWidth</span>: <span class="number">3</span>,<span class="attr">borderColor</span>: <span class="string">"gray"</span>,<span class="attr">fontSize</span>: <span class="number">40</span>,<span class="attr">flex</span>: <span class="number">1</span>,<span class="attr">marginLeft</span>: <span class="number">100</span>&#125;&#125;/&gt;</span><br><span class="line"></span><br><span class="line">		                	&lt;button</span><br><span class="line">													<span class="comment">//如果是新数据，调用保存方法</span></span><br><span class="line">													onClick= &#123;()=&gt;&#123;</span><br><span class="line">														<span class="keyword">var</span> value = <span class="string">"0"</span>;</span><br><span class="line">					                  <span class="keyword">var</span> callFunction = <span class="string">"save"</span></span><br><span class="line">					                  <span class="keyword">var</span> callArgs = <span class="string">"[\""</span> + <span class="keyword">this</span>.refs.inputRef.value + <span class="string">"\",\""</span> + <span class="keyword">this</span>.refs.inputValueRef.value + <span class="string">"\"]"</span></span><br><span class="line">					                  <span class="built_in">console</span>.log(callArgs)</span><br><span class="line">														<span class="comment">//各种参数，回调函数监听器，用来监听触发交易状态，使用的nebpay的call接口去调用合约</span></span><br><span class="line">					                  nebPay.call(dappAddress, value, callFunction, callArgs, &#123;  ,</span><br><span class="line">					                      listener: <span class="keyword">this</span>.cbPush        <span class="comment">//设置listener, 处理交易返回信息</span></span><br><span class="line">					                  &#125;);</span><br><span class="line">													&#125;&#125;</span><br><span class="line">		                	<span class="comment">//设置按钮样式</span></span><br><span class="line">		                	style=&#123;&#123;<span class="attr">width</span>: <span class="number">200</span>,<span class="attr">marginLeft</span>: <span class="number">40</span>,<span class="attr">fontSize</span>: <span class="number">50</span>,<span class="attr">marginRight</span>: <span class="number">100</span>&#125;&#125; &gt;submit&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">									&lt;/</span>div&gt;:</span><br><span class="line">									&lt;div style = &#123;&#123;<span class="attr">display</span>:<span class="string">"flex"</span>&#125;&#125;&gt;</span><br><span class="line">									&#123;</span><br><span class="line">										<span class="comment">//根据判断结果，展示不同内容</span></span><br><span class="line">										<span class="keyword">this</span>.state.isResult ? <span class="xml"><span class="tag">&lt;<span class="name">ResultInfo</span></span></span></span><br><span class="line"><span class="xml">											keyInfo=&#123;this.state.resultObj["key"]&#125;</span></span><br><span class="line"><span class="xml">											valueInfo=&#123;this.state.resultObj["value"]&#125;</span></span><br><span class="line"><span class="xml">											accountInfo=&#123;this.state.resultObj["author"]&#125;/&gt;</span></span><br><span class="line"><span class="xml">											:</span></span><br><span class="line">											&lt;div&gt;</span><br><span class="line">												&#123;</span><br><span class="line">													this.state.isSearchFail?</span><br><span class="line"></span><br><span class="line">													&lt;FailInfo</span><br><span class="line">														addFunc = &#123;()=&gt;&#123;</span><br><span class="line">															console.log("app.js  输出")</span><br><span class="line">															this.setState(&#123;isShowInputView: true&#125;)</span><br><span class="line">														&#125;&#125;</span><br><span class="line">														searchText = &#123;this.refs.inputRef.value&#125;/&gt;</span><br><span class="line">													:</span><br><span class="line">													&lt;div /&gt;</span><br><span class="line">												&#125;</span><br><span class="line">											&lt;/div&gt;</span><br><span class="line">									&#125;</span><br><span class="line"><span class="xml">									<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">							&#125;</span></span><br><span class="line"><span class="xml">        	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">		)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://liguoyu.com/2018/05/03/Nebulas-04 React整合nebulasAPI开发 (上)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李国玉">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李国玉区块链博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/03/Nebulas-04 React整合nebulasAPI开发 (上)/" itemprop="url">
                  Nebulas-04 React整合nebulasAPI开发(上)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-05-03 09:35:58" itemprop="dateCreated datePublished" datetime="2018-05-03T09:35:58+08:00">2018-05-03</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-05-10 19:13:49" itemprop="dateModified" datetime="2018-05-10T19:13:49+08:00">2018-05-10</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="安装星云类库"><a href="#安装星云类库" class="headerlink" title="安装星云类库"></a>安装星云类库</h2><p><strong>默认全部安装好了 react 框架，没安装好的可以直接靠诶同桌的使用</strong></p>
<p>进入my-app目录下打开终端，输入以下命令，下载nebulas 类库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i nebulas</span><br></pre></td></tr></table></figure>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/01.png" alt="01"></p>
<h2 id="使用IDE打开my-app文件夹，导入工程，我使用的是sublime"><a href="#使用IDE打开my-app文件夹，导入工程，我使用的是sublime" class="headerlink" title="使用IDE打开my-app文件夹，导入工程，我使用的是sublime"></a>使用IDE打开my-app文件夹，导入工程，我使用的是sublime</h2><blockquote>
<p>这里建议拷贝 my-app ，在拷贝的文件中操作，我这里拷贝画出来的文件夹重新命名为0509-app</p>
</blockquote>
<p>目录结构如下</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/02.png" alt="02"></p>
<p>我们需要把 src 目录下除了index.js 文件的其他文件全部删除，然后编辑 index.js 文件，最终结果如下</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/03.png" alt="03"></p>
<p>也可以直接复制我的代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;div&gt; 这里可以随便写内容 &lt;<span class="regexp">/div&gt;,  </span></span><br><span class="line"><span class="regexp">  document.getElementById('root')</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>
<p>进入 0509-app 文件夹打开终端输入命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/04.png" alt="04"></p>
<p>打开浏览器输入上面的地址就能展示我们刚才定义的 DIV 内容。</p>
<h2 id="前端样式学习"><a href="#前端样式学习" class="headerlink" title="前端样式学习"></a>前端样式学习</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line">CSS是什么？作用？</span><br><span class="line">		css是：层叠样式表（Cascading Style Sheets）</span><br><span class="line">				层叠：一层层的。</span><br><span class="line">				样式表：属性和属性值组成的就是样式表</span><br><span class="line">		作用：1.加强html</span><br><span class="line">			  2.样式与显示分离。</span><br><span class="line">	css的书写规范</span><br><span class="line">		选择器&#123;</span><br><span class="line">		声明；</span><br><span class="line">		&#125;</span><br><span class="line">		选择器：确定要修饰的标签&lt;html&gt;.</span><br><span class="line">		声明：样式。</span><br><span class="line">		</span><br><span class="line">		选择器&#123;</span><br><span class="line">		   </span><br><span class="line">		   name1:vlue1;</span><br><span class="line">		   name2:value2 value3 value4 value5;</span><br><span class="line">		   name3:value1,value2,value3;</span><br><span class="line">		   name4:&quot;va  lue&quot;;	    例子：&quot;宋体&quot;</span><br><span class="line">		&#125;</span><br><span class="line">	 颜色 取值</span><br><span class="line">		1.英文单词（red）</span><br><span class="line">		2.#十六进制（#ffffff）</span><br><span class="line">		</span><br><span class="line">		&#123;了解&#125;</span><br><span class="line">		3.rgb(0,0,0)&#123;0~255&#125;</span><br><span class="line">		4.rgb（0%,0%,100%）;</span><br><span class="line">	单位</span><br><span class="line">	    px 像素 (计算机屏幕上的一个点)&#123;用&#125;</span><br><span class="line">		% 百分比 </span><br><span class="line">		in 英寸 </span><br><span class="line">		cm 厘米 </span><br><span class="line">		mm 毫米 </span><br><span class="line">		em 1em 等于当前的字体尺寸。</span><br><span class="line"></span><br><span class="line">		2em 等于当前字体尺寸的两倍。</span><br><span class="line"></span><br><span class="line">		例如，如果某元素以 12pt 显示，那么 2em 是24pt。</span><br><span class="line"></span><br><span class="line">		在 CSS 中，em 是非常有用的单位，因为它可以自动适应用户所使用的字体。</span><br><span class="line">		 </span><br><span class="line">		ex 一个 ex 是一个字体的 x-height。 (x-height 通常是字体尺寸的一半。) </span><br><span class="line">		pt 磅 (1 pt 等于 1/72 英寸) </span><br><span class="line">		pc 12 点活字 (1 pc 等于 12 点) </span><br><span class="line">	css如何加强html</span><br><span class="line">		内联样式表</span><br><span class="line">			绝大多数标签都具有style 属性。</span><br><span class="line">				&lt;div style=&quot;font-size:250px;&quot;&gt;</span><br><span class="line">					你好</span><br><span class="line">				&lt;/div&gt;	</span><br><span class="line">		内部样式表</span><br><span class="line">			head标签里面</span><br><span class="line">				子标签 style 里面写样式。</span><br><span class="line">				div&#123;</span><br><span class="line">				</span><br><span class="line">				  font-size:250px; /* 字体 */</span><br><span class="line">				  color:red;  /* 颜色 */</span><br><span class="line">				  border:1px solid red; /* 边框 */</span><br><span class="line">				&#125;</span><br><span class="line">		外部样式表</span><br><span class="line">				 &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./demo.css&quot;&gt;</span><br><span class="line">				    stylesheet：样式表。</span><br><span class="line">					type=&quot;text/css&quot;：按照css的语法进行解析。</span><br><span class="line">					href：引入css文件。</span><br><span class="line">					./：当前目录。</span><br><span class="line">					../上一个目录。</span><br><span class="line">			优先级：内联样式表&gt;内部样式表&gt;外部样式表		</span><br><span class="line">					</span><br><span class="line">		@import </span><br><span class="line">		    &lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">				@import &quot;demo.css&quot;</span><br><span class="line">			&lt;/style&gt;</span><br><span class="line">			  1、可以忘了,很多浏览器不支持。</span><br><span class="line">			  2.影响页面显示</span><br><span class="line">			  3.js不能操作导入进来的样式</span><br><span class="line">	常用选择器</span><br><span class="line">		1.id选择器</span><br><span class="line">				 #myid&#123;</span><br><span class="line">				   font-size:250px;</span><br><span class="line">				   border:1px solid red;</span><br><span class="line">				 &#125;</span><br><span class="line">			注意：id选择器加“#”</span><br><span class="line">		2.类（class）选择器</span><br><span class="line">		     .myclass&#123;</span><br><span class="line">				font-size:250px;</span><br><span class="line">			  &#125;</span><br><span class="line">			  注意：class选择器加“.”</span><br><span class="line">		3.标签（元素）选择器</span><br><span class="line">				 div&#123;</span><br><span class="line">				   font-size:200px;</span><br><span class="line">				   border:1px solid red;</span><br><span class="line">				 &#125;</span><br><span class="line">		4,属性选择器	</span><br><span class="line">				input[type=&quot;text&quot;]&#123;</span><br><span class="line">					border:1px solid red;</span><br><span class="line">			</span><br><span class="line">	        &#125;</span><br><span class="line">	伪类：在选择器的基础上继续添加样式</span><br><span class="line">	   a:link&#123; color:green;&#125;  /*  未点击  */</span><br><span class="line">       a:visited&#123;color:black;&#125; /* 点击以后 */</span><br><span class="line">       a:hover&#123;  color:yellow;&#125; /*鼠标放上去的一个颜色  */ </span><br><span class="line">       a:active&#123; color:red;&#125; /* 按住鼠标 */</span><br><span class="line">	   </span><br><span class="line">	常用的属性和样式</span><br><span class="line">			字体：</span><br><span class="line">			   font-style: italic;  斜体</span><br><span class="line">     		   font-size:100px;    大小</span><br><span class="line">     		   font-family: &quot;宋体&quot;;  字体</span><br><span class="line">			   font：简写属性。</span><br><span class="line">			文本：</span><br><span class="line">				color:red;  /*文本的样色  */</span><br><span class="line">				 text-align: center;/* 对齐方式 */</span><br><span class="line">				 /*letter-spacing: 50px; /* 字符间距 */</span><br><span class="line">				 word-spacing: 100px; /*词间距  */</span><br><span class="line">			 背景</span><br><span class="line">				/* background-color:red;  */ /* 背景颜色 */</span><br><span class="line">				background-image:url(1.gif);  /* 图片 */</span><br><span class="line">				background-repeat: repeat-y;  /* 是否重repeat-y  repeat-x  no-repeat*/</span><br><span class="line">			 尺寸</span><br><span class="line">				width:宽度</span><br><span class="line">				height:高度</span><br><span class="line">			 列表</span><br><span class="line">				/* list-style-image: url(1.gif);  列表符号图片 */ </span><br><span class="line">					list-style-type:none;  /*序列符号样式 */</span><br><span class="line">			 表格</span><br><span class="line">				/* border-collapse: collapse;  *//*是否要合并边框  */</span><br><span class="line">					border-spacing: 10px 20px;  /*  设置到水平和垂直的距离，如果我们写一个值，水平垂直距离相等。</span><br><span class="line">                                        如果两个值  第一个代表：水平 第二个代表垂直</span><br><span class="line">			*/</span><br><span class="line">				caption-side: bottom; 标题的对齐方式。</span><br><span class="line">			轮廓：</span><br><span class="line">				 outline-color: blue; 轮廓的颜色</span><br><span class="line">				 outline-style: solid;  轮廓显示</span><br><span class="line">				 outline-width: 10px;  厚度。</span><br><span class="line">	高级的</span><br><span class="line">		</span><br><span class="line">		定位：</span><br><span class="line">			相对定位和绝对定位</span><br><span class="line">			position&#123;设置定位&#125;</span><br><span class="line">				absolute:绝对定位</span><br><span class="line">					：相当于外部框的定位</span><br><span class="line">				relative：相对定位</span><br><span class="line">					：相对与自己的位置。</span><br><span class="line">		cursor</span><br><span class="line">		    设置小手：cursor：pointer；</span><br><span class="line">			</span><br><span class="line">		float</span><br><span class="line">		  浮动</span><br><span class="line">		clear	</span><br><span class="line">		  清除浮动。</span><br><span class="line">	盒子模型</span><br><span class="line">		 外边距：</span><br><span class="line">		   margin</span><br><span class="line">		   margin-top</span><br><span class="line">		   margin-left</span><br><span class="line">		   margin-right</span><br><span class="line">           margin-bottom		   </span><br><span class="line">		注意：		 </span><br><span class="line">   	      margin：20px; </span><br><span class="line">		  margin:  上 右 下 左 ;</span><br><span class="line">		  margin:  上 右&#123;下 左&#125; ;</span><br><span class="line">		  </span><br><span class="line">		 内边距：</span><br><span class="line">			padding</span><br><span class="line">			padding-top</span><br><span class="line">		   padding-left</span><br><span class="line">		   padding-right</span><br><span class="line">           padding-bottom</span><br><span class="line">		   padding：20px; ；</span><br><span class="line">	        padding:  上 右 下 左 ;</span><br><span class="line">		    padding:  上 右&#123;下 左&#125; ;</span><br><span class="line">	边框</span><br><span class="line">		border:简写属性。</span><br><span class="line">		border-color: red; 颜色</span><br><span class="line">         border-width: 10px; 宽度</span><br><span class="line">         border-style: double; 线的类型</span><br><span class="line">		 </span><br><span class="line">		 &#123;对具体边框的设置&#125;</span><br><span class="line">		 border-top  上</span><br><span class="line">		 border-left  左</span><br><span class="line">		 border-right 右</span><br><span class="line">		 border-bottom 下</span><br></pre></td></tr></table></figure>
<h3 id="内边框代码（可直接粘贴复制）："><a href="#内边框代码（可直接粘贴复制）：" class="headerlink" title="内边框代码（可直接粘贴复制）："></a>内边框代码（可直接粘贴复制）：</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>内边距.html<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"keywords"</span> <span class="attr">content</span>=<span class="string">"keyword1,keyword2,keyword3"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"description"</span> <span class="attr">content</span>=<span class="string">"this is my page"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--&lt;link rel="stylesheet" type="text/css" href="./styles.css"&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">      <span class="comment">/* 内边距 */</span></span></span><br><span class="line"><span class="undefined">      div&#123;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">border</span><span class="selector-pseudo">:1px</span> <span class="selector-tag">solid</span> <span class="selector-tag">red</span>;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">width</span><span class="selector-pseudo">:250px</span>;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">height</span><span class="selector-pseudo">:250px</span>;</span></span><br><span class="line"><span class="undefined">        </span></span><br><span class="line"><span class="undefined">        padding-top: 100px;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">padding-left</span><span class="selector-pseudo">:200px</span>;</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="外边框"><a href="#外边框" class="headerlink" title="外边框"></a>外边框</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>外边距.html<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"keywords"</span> <span class="attr">content</span>=<span class="string">"keyword1,keyword2,keyword3"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"description"</span> <span class="attr">content</span>=<span class="string">"this is my page"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--&lt;link rel="stylesheet" type="text/css" href="./styles.css"&gt;--&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">       </span></span><br><span class="line"><span class="css">         <span class="selector-class">.dd1</span>&#123;</span></span><br><span class="line"><span class="undefined">           </span></span><br><span class="line"><span class="css">           <span class="selector-tag">border</span><span class="selector-pseudo">:1px</span> <span class="selector-tag">solid</span> <span class="selector-tag">red</span>;</span></span><br><span class="line"><span class="css">           <span class="selector-tag">width</span><span class="selector-pseudo">:250px</span>;</span></span><br><span class="line"><span class="css">           <span class="selector-tag">height</span><span class="selector-pseudo">:250px</span>;</span></span><br><span class="line"><span class="undefined">         &#125;</span></span><br><span class="line"><span class="css">         <span class="selector-class">.dd2</span>&#123;</span></span><br><span class="line"><span class="undefined">           </span></span><br><span class="line"><span class="css">           <span class="selector-tag">border</span><span class="selector-pseudo">:1px</span> <span class="selector-tag">solid</span> <span class="selector-tag">blue</span>;</span></span><br><span class="line"><span class="css">           <span class="selector-tag">width</span><span class="selector-pseudo">:250px</span>;</span></span><br><span class="line"><span class="css">           <span class="selector-tag">height</span><span class="selector-pseudo">:250px</span>;</span></span><br><span class="line"><span class="undefined">           margin-top: 20px;</span></span><br><span class="line"><span class="undefined">           margin-left: 20px;</span></span><br><span class="line"><span class="undefined">           margin-right: 20px;</span></span><br><span class="line"><span class="undefined">         &#125;</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"dd1"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"dd2"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="attribute">font-size</span>:<span class="number">250px</span>;</span><br><span class="line">	<span class="attribute">color</span>:red;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="选择器-之-class-类选择器"><a href="#选择器-之-class-类选择器" class="headerlink" title="选择器 之  class 类选择器"></a>选择器 之  class 类选择器</h3><h3 id="选择器之-id-选择器"><a href="#选择器之-id-选择器" class="headerlink" title="选择器之 id 选择器"></a>选择器之 id 选择器</h3><p>学习地址：</p>
<p>html学习:<a href="http://www.runoob.com/html/html-tutorial.html" target="_blank" rel="noopener">http://www.runoob.com/html/html-tutorial.html</a></p>
<p>css样式学习：<a href="http://www.runoob.com/css/css-tutorial.html" target="_blank" rel="noopener">http://www.runoob.com/css/css-tutorial.html</a></p>
<h2 id="react初步学习"><a href="#react初步学习" class="headerlink" title="react初步学习"></a>react初步学习</h2><h3 id="遍历集合"><a href="#遍历集合" class="headerlink" title="遍历集合"></a>遍历集合</h3><p>index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//var arry = [&lt;div&gt;demo01&lt;/div&gt;, &lt;div&gt;demo02&lt;/div&gt;, &lt;div&gt;demo03&lt;/div&gt;]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> dArry = [<span class="string">"zhangsan"</span>,<span class="string">"lisi"</span>,<span class="string">"wangwu"</span>]</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line"></span><br><span class="line">  <span class="comment">//js可以放在 html 中，需要用 &#123;&#125; 扩起来</span></span><br><span class="line">  <span class="comment">//&lt;div&gt;&#123;arry&#125;&lt;/div&gt;,</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//遍历集合</span></span><br><span class="line">  &lt;div&gt;</span><br><span class="line">  	&#123;</span><br><span class="line">  		dArry.map(<span class="function"><span class="keyword">function</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">  			<span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">  		&#125;)</span><br><span class="line">  	&#125;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;, 	</span></span><br><span class="line"><span class="regexp">  document.getElementById('root')</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>
<h3 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h3><p>index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//箭头函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printA</span>(<span class="params">a</span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> printA1 = <span class="function">(<span class="params">a</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果箭头函数只有一句代码，可简写</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> printA2 = <span class="function">(<span class="params">a</span>) =&gt;</span> <span class="built_in">console</span>.log(a)</span><br><span class="line"></span><br><span class="line"><span class="comment">//上面printA，printA1,printA2 等价</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//*******************************************</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printB</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">20</span>;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> printB1 = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">20</span>;</span><br><span class="line">  <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//printB,printB1 等价</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//*************************************</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printC</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> a*b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> printC1 = <span class="function">(<span class="params">a,b</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> a*b </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> printC2 = <span class="function">(<span class="params">a,b</span>) =&gt;</span> a*b </span><br><span class="line"></span><br><span class="line"><span class="comment">//printC,printC1,print2 等价</span></span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    test</span><br><span class="line">  &lt;<span class="regexp">/div&gt;, 	</span></span><br><span class="line"><span class="regexp">  document.getElementById('root')</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>
<h3 id="自定义标签"><a href="#自定义标签" class="headerlink" title="自定义标签"></a>自定义标签</h3><p>index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义Person类继承React.Component</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造函数，创建类先执行构造函数的内容</span></span><br><span class="line">  <span class="comment">// constructor()&#123;</span></span><br><span class="line">  <span class="comment">//   console.log("先执行")</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//render渲染到页面上展示</span></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>zhangsan:zhaosi<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//下面编写html代码</span></span><br><span class="line">ReactDOM.render(</span><br><span class="line"></span><br><span class="line">  &lt;Person&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Person</span>&gt;</span></span>,</span><br><span class="line">   	</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="自定义标签代码优化"><a href="#自定义标签代码优化" class="headerlink" title="自定义标签代码优化"></a>自定义标签代码优化</h3><p>index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义Person类extends(继承)React.Component (主键)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//构造函数，创建类先执行构造函数的内容</span></span><br><span class="line">  <span class="comment">// constructor()&#123;</span></span><br><span class="line">  <span class="comment">//   console.log("先执行")</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//render渲染到页面上展示</span></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">//以后在render函数中，不管return几句代码，最好加（）小括号</span></span><br><span class="line">    <span class="comment">//return 只能返回一个顶级标签</span></span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;name:zhangsan&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;h1&gt;sex:man&lt;/</span>h1&gt;</span><br><span class="line">        &lt;h1&gt;age:<span class="number">18</span>&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">      ) </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//下面编写html代码</span></span><br><span class="line">ReactDOM.render(</span><br><span class="line"></span><br><span class="line">  &lt;Person&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Person</span>&gt;</span></span>,</span><br><span class="line">   	</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="代码优化"><a href="#代码优化" class="headerlink" title="代码优化"></a>代码优化</h3><h4 id="封装person类"><a href="#封装person类" class="headerlink" title="封装person类"></a>封装person类</h4><h4 id="persion-js"><a href="#persion-js" class="headerlink" title="persion.js"></a>persion.js</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// class 类的关键字</span></span><br><span class="line"><span class="comment">// Person 类名</span></span><br><span class="line"><span class="comment">// extends 继承</span></span><br><span class="line"><span class="comment">// React.Component 父组建</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 渲染</span></span><br><span class="line">  render() &#123;</span><br><span class="line">     <span class="comment">//以后在render函数中，不管return几句代码，最好加（）小括号</span></span><br><span class="line">    <span class="comment">//return 只能返回一个顶级标签</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;name:zhangsan&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;h1&gt;sex:man&lt;/</span>h1&gt;</span><br><span class="line">        &lt;h1&gt;age:<span class="number">18</span>&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 简单理解，向外暴露自己的位置，以便其他文件引入调用</span></span><br><span class="line"><span class="comment">// ES5</span></span><br><span class="line"><span class="comment">// module.exports = Person</span></span><br><span class="line"><span class="comment">// ES6</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Person;</span><br></pre></td></tr></table></figure>
<h4 id="调用person类完成页面展示"><a href="#调用person类完成页面展示" class="headerlink" title="调用person类完成页面展示"></a>调用person类完成页面展示</h4><p>index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="comment">// ES5</span></span><br><span class="line"><span class="comment">// var Person = require('./person')</span></span><br><span class="line"><span class="keyword">import</span> Person <span class="keyword">from</span> <span class="string">'./person'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 下面编写html代码</span></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Person&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Person</span>&gt;</span></span>,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="页面编写"><a href="#页面编写" class="headerlink" title="页面编写"></a>页面编写</h3><p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">	<span class="comment">//结构提</span></span><br><span class="line">	<span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">		<span class="keyword">super</span>(props)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//页面渲染</span></span><br><span class="line">	render() &#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">			<span class="comment">// &lt;div style=&#123;&#123;backgroundColor: "yellow",flex: 1&#125;&#125; &gt;</span></span><br><span class="line">			<span class="comment">// 	&lt;img </span></span><br><span class="line">			<span class="comment">// 		style=&#123;&#123;width: "100%",height: "100%"&#125;&#125;</span></span><br><span class="line">			<span class="comment">// 		src="imag/woman.jpeg"&gt;&lt;/img&gt;</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">// 	&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">// 	&lt;table &gt;</span></span><br><span class="line">			<span class="comment">// 		&lt;input type="text" /&gt;</span></span><br><span class="line">			<span class="comment">// 		&lt;button value="seach"&gt;seach&lt;/button&gt;</span></span><br><span class="line">			<span class="comment">// 	&lt;/table&gt;</span></span><br><span class="line">			<span class="comment">// &lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">			 &lt;div style=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="string">"rgb(52,83,136)"</span>,<span class="attr">flex</span>: <span class="number">1</span>,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">flexDirection</span>: <span class="string">'column'</span>,<span class="attr">alignItems</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">	          &lt;img src=<span class="string">"imag/woman.jpeg"</span> style=&#123;&#123;<span class="attr">marginTop</span>: <span class="number">20</span>&#125;&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span></span><br><span class="line">	          &lt;div style=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="string">"black"</span>,<span class="attr">width</span>: <span class="string">"100%"</span>,<span class="attr">height</span>: <span class="number">100</span>,<span class="attr">marginTop</span>: <span class="number">100</span>&#125;&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">	        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">			)</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="comment">//导包，能使用里面的方法</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./app'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下编写html代码</span></span><br><span class="line">ReactDOM.render(</span><br><span class="line">	&lt;App/&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>public ==&gt;index.html 修改内容</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/05.png" alt="05"></p>
<p>可直接粘贴下面代码替换</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;body style=<span class="string">"background-color:green;margin: 0px"</span>&gt;</span><br><span class="line">&lt;noscript&gt;</span><br><span class="line">      You need to enable JavaScript to run <span class="keyword">this</span> app.</span><br><span class="line">&lt;<span class="regexp">/noscript&gt;</span></span><br><span class="line"><span class="regexp">&lt;div style="background-color:red; width: 100vw;height: 100vh;display: flex" id="root"&gt;</span></span><br></pre></td></tr></table></figure>
<p>改造app.js文件，能够获取input标签输入的内容</p>
<p>最终代码</p>
<p>app.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">	<span class="comment">//结构提</span></span><br><span class="line">	<span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">		<span class="keyword">super</span>(props)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//页面渲染</span></span><br><span class="line">	render() &#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">			</span><br><span class="line">			&lt;div style=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="string">"rgb(52,83,136)"</span>,<span class="attr">flex</span>: <span class="number">1</span></span><br><span class="line">				,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">flexDirection</span>: <span class="string">'column'</span>,<span class="attr">alignItems</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">          		&lt;img src=<span class="string">"imag/logo.png"</span> style=&#123;&#123;<span class="attr">marginTop</span>: <span class="number">20</span>&#125;&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span></span><br><span class="line">         	  	&lt;div style=&#123;&#123;<span class="attr">width</span>: <span class="string">"100%"</span>,<span class="attr">height</span>: <span class="number">100</span>,<span class="attr">marginTop</span>: <span class="number">100</span>,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">justifyContent</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">              	&lt;input</span><br><span class="line">                	ref=<span class="string">"inputRef"</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">borderWidth</span>: <span class="number">3</span>,<span class="attr">borderColor</span>: <span class="string">"gray"</span>,<span class="attr">fontSize</span>: <span class="number">50</span>,<span class="attr">flex</span>: <span class="number">1</span>,<span class="attr">marginLeft</span>: <span class="number">100</span>&#125;&#125;/&gt;</span><br><span class="line">          			<span class="comment">//按钮标签，绑定onclick 点击时间</span></span><br><span class="line">                	&lt;button onClick = &#123;() =&gt; &#123;</span><br><span class="line">                		<span class="built_in">console</span>.log(<span class="string">"搜索"</span>)</span><br><span class="line">                  		<span class="built_in">console</span>.log(<span class="keyword">this</span>.refs.inputRef.value)</span><br><span class="line">                	&#125;&#125;</span><br><span class="line">                	<span class="comment">//设置按钮样式</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">width</span>: <span class="number">200</span>,<span class="attr">marginLeft</span>: <span class="number">40</span>,<span class="attr">fontSize</span>: <span class="number">50</span>,<span class="attr">marginRight</span>: <span class="number">100</span>&#125;&#125; &gt;SEARCH&lt;<span class="regexp">/button&gt;	</span></span><br><span class="line"><span class="regexp">          		&lt;/</span>div&gt;</span><br><span class="line">        	&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">			</span></span><br><span class="line"><span class="regexp">		)</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>
<p>页面展示：</p>
<p>进入目录结构内打开终端，输入以下指令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/06.png" alt="06"></p>
<h2 id="nebulas的API学习"><a href="#nebulas的API学习" class="headerlink" title="nebulas的API学习"></a>nebulas的API学习</h2><p>API地址：<a href="https://nebulasio.github.io/neb.js/API.html" target="_blank" rel="noopener">https://nebulasio.github.io/neb.js/API.html</a></p>
<h3 id="引入nebulas包"><a href="#引入nebulas包" class="headerlink" title="引入nebulas包"></a>引入nebulas包</h3><p>testAPI.js（<strong>注意：自定义的文件，放在src目录下，如果放在其他目录，在下面的导包时需要改变路径</strong>）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//引入包文件，可以使用里面提供的方法</span></span><br><span class="line"><span class="keyword">var</span> Nebulas = <span class="built_in">require</span>(<span class="string">'nebulas'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(Nebulas)</span><br></pre></td></tr></table></figure>
<p>在 testAPI.js 所在文件目录下打开控制台,输入以下命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node testAPI.js</span><br></pre></td></tr></table></figure>
<p>展示结果：nebulas提供的方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">&#123; HttpRequest: [Function: HttpRequest],</span><br><span class="line">  Neb: [Function: Neb],</span><br><span class="line">  Account: </span><br><span class="line">   &#123; [Function: Account]</span><br><span class="line">     NewAccount: [Function],</span><br><span class="line">     isValidAddress: [Function],</span><br><span class="line">     fromAddress: [Function],</span><br><span class="line">     getNormalType: [Function],</span><br><span class="line">     getContractType: [Function] &#125;,</span><br><span class="line">  Transaction: [Function: Transaction],</span><br><span class="line">  Utils: </span><br><span class="line">   &#123; isNull: [Function: isNull],</span><br><span class="line">     isBrowser: [Function: isBrowser],</span><br><span class="line">     isBigNumber: [Function: isBigNumber],</span><br><span class="line">     isString: [Function: isString],</span><br><span class="line">     isObject: [Function: isObject],</span><br><span class="line">     isFunction: [Function: isFunction],</span><br><span class="line">     isNumber: [Function: isNumber],</span><br><span class="line">     toBigNumber: [Function: toBigNumber],</span><br><span class="line">     toString: [Function: toString],</span><br><span class="line">     argumentsToObject: [Function: argumentsToObject],</span><br><span class="line">     zipArraysToObject: [Function: zipArraysToObject] &#125;,</span><br><span class="line">  CryptoUtils: </span><br><span class="line">   &#123; secp256k1: </span><br><span class="line">      &#123; privateKeyVerify: [Function],</span><br><span class="line">        privateKeyExport: [Function],</span><br><span class="line">        privateKeyImport: [Function],</span><br><span class="line">        privateKeyNegate: [Function],</span><br><span class="line">        privateKeyModInverse: [Function],</span><br><span class="line">        privateKeyTweakAdd: [Function],</span><br><span class="line">        privateKeyTweakMul: [Function],</span><br><span class="line">        publicKeyCreate: [Function],</span><br><span class="line">        publicKeyConvert: [Function],</span><br><span class="line">        publicKeyVerify: [Function],</span><br><span class="line">        publicKeyTweakAdd: [Function],</span><br><span class="line">        publicKeyTweakMul: [Function],</span><br><span class="line">        publicKeyCombine: [Function],</span><br><span class="line">        signatureNormalize: [Function],</span><br><span class="line">        signatureExport: [Function],</span><br><span class="line">        signatureImport: [Function],</span><br><span class="line">        signatureImportLax: [Function],</span><br><span class="line">        sign: [Function],</span><br><span class="line">        verify: [Function],</span><br><span class="line">        recover: [Function],</span><br><span class="line">        ecdh: [Function],</span><br><span class="line">        ecdhUnsafe: [Function],</span><br><span class="line">        path: <span class="string">'/home/lgy/桌面/0509-app/node_modules/secp256k1/build/Release/secp256k1.node'</span> &#125;,</span><br><span class="line">     keccak: [Function: keccak],</span><br><span class="line">     sha3: [Function: sha3],</span><br><span class="line">     ripemd160: [Function: ripemd160],</span><br><span class="line">     crypto: </span><br><span class="line">      &#123; _toBuf: [Function: toBuf],</span><br><span class="line">        createCipher: [Function: createCipher],</span><br><span class="line">        createCipheriv: [Function: createCipheriv],</span><br><span class="line">        createDecipher: [Function: createDecipher],</span><br><span class="line">        createDecipheriv: [Function: createDecipheriv],</span><br><span class="line">        createDiffieHellman: [Function: createDiffieHellman],</span><br><span class="line">        createDiffieHellmanGroup: [Function: createDiffieHellmanGroup],</span><br><span class="line">        createECDH: [Function: createECDH],</span><br><span class="line">        createHash: [Function: createHash],</span><br><span class="line">        createHmac: [Function: createHmac],</span><br><span class="line">        createSign: [Function: createSign],</span><br><span class="line">        createVerify: [Function: createVerify],</span><br><span class="line">        getCiphers: [Function],</span><br><span class="line">        getCurves: [Function],</span><br><span class="line">        getDiffieHellman: [Function: createDiffieHellmanGroup],</span><br><span class="line">        getHashes: [Function],</span><br><span class="line">        pbkdf2: [Function: pbkdf2],</span><br><span class="line">        pbkdf2Sync: [Function: pbkdf2Sync],</span><br><span class="line">        privateDecrypt: [Function],</span><br><span class="line">        privateEncrypt: [Function],</span><br><span class="line">        prng: [Function: randomBytes],</span><br><span class="line">        pseudoRandomBytes: [Function: randomBytes],</span><br><span class="line">        publicDecrypt: [Function],</span><br><span class="line">        publicEncrypt: [Function],</span><br><span class="line">        randomBytes: [Function: randomBytes],</span><br><span class="line">        randomFill: [Function: randomFill],</span><br><span class="line">        randomFillSync: [Function: randomFillSync],</span><br><span class="line">        rng: [Function: randomBytes],</span><br><span class="line">        setEngine: [Function: setEngine],</span><br><span class="line">        timingSafeEqual: [Function: timingSafeEqual],</span><br><span class="line">        getFips: [Function: getFipsDisabled],</span><br><span class="line">        setFips: [Function: setFipsDisabled],</span><br><span class="line">        Certificate: [Function],</span><br><span class="line">        Cipher: [Function],</span><br><span class="line">        Cipheriv: [Function],</span><br><span class="line">        Decipher: [Function],</span><br><span class="line">        Decipheriv: [Function],</span><br><span class="line">        DiffieHellman: [Function: DiffieHellman],</span><br><span class="line">        DiffieHellmanGroup: [Function: DiffieHellmanGroup],</span><br><span class="line">        ECDH: [Function],</span><br><span class="line">        Hash: [Function],</span><br><span class="line">        Hmac: [Function],</span><br><span class="line">        Sign: [Function],</span><br><span class="line">        Verify: [Function],</span><br><span class="line">        DEFAULT_ENCODING: [Getter/Setter],</span><br><span class="line">        constants: [Object],</span><br><span class="line">        createCredentials: [Getter],</span><br><span class="line">        Credentials: [Getter] &#125;,</span><br><span class="line">     scrypt: [Function: scrypt],</span><br><span class="line">     uuid: &#123; [Function: v4] v1: [Function: v1], v4: [Circular] &#125;,</span><br><span class="line">     zeros: [Function: zeros],</span><br><span class="line">     isHexPrefixed: [Function: isHexPrefixed],</span><br><span class="line">     padToBigEndian: [Function: padToBigEndian],</span><br><span class="line">     toBuffer: [Function: toBuffer],</span><br><span class="line">     bufferToHex: [Function: bufferToHex],</span><br><span class="line">     privateToPublic: [Function: privateToPublic],</span><br><span class="line">     isValidPublic: [Function: isValidPublic],</span><br><span class="line">     sign: [Function: sign],</span><br><span class="line">     verify: [Function: verify],</span><br><span class="line">     recover: [Function: recover] &#125;,</span><br><span class="line">  Unit: </span><br><span class="line">   &#123; toBasic: [Function: toBasic],</span><br><span class="line">     fromBasic: [Function: fromBasic],</span><br><span class="line">     nasToBasic: [Function: nasToBasic] &#125; &#125;</span><br></pre></td></tr></table></figure>
<p>课上调用的API方法完整版本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"><span class="comment">//导包</span></span><br><span class="line"><span class="keyword">var</span> Nebulas = <span class="built_in">require</span>(<span class="string">'nebulas'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//控制台输出结果显示nebulas自带的方法</span></span><br><span class="line"><span class="built_in">console</span>.log(Nebulas)</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过nebulas获取不同方法的对象</span></span><br><span class="line"><span class="keyword">var</span> Neb = Nebulas.Neb;</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试链,参数可换成localhost:8685,获取本地链对象</span></span><br><span class="line"><span class="keyword">var</span> neb = <span class="keyword">new</span> Neb(<span class="keyword">new</span> Nebulas.HttpRequest(<span class="string">"https://testnet.nebulas.io"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//账户</span></span><br><span class="line"><span class="keyword">var</span> Account = Nebulas.Account;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"\n\n"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(neb)</span><br><span class="line"></span><br><span class="line"><span class="comment">//链上提供的各种API方法，如果不清楚，可以去https://nebulasio.github.io/neb.js/API.html查看</span></span><br><span class="line"><span class="keyword">var</span> api = neb.api;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 当前区块链状态</span></span><br><span class="line">api.getNebState().then(<span class="function"><span class="keyword">function</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 异步 什么是异步：相当于多线程执行程序，不会因为某个方法未结束而阻塞</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"\n\n"</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(state)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 当前链上最新的区块信息</span></span><br><span class="line">api.latestIrreversibleBlock().then(<span class="function"><span class="keyword">function</span>(<span class="params">blockData</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"\n\n"</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(blockData)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询钱包状态  参数是钱包地址</span></span><br><span class="line">api.getAccountState(&#123;<span class="attr">address</span>: <span class="string">"n1YLc2ndCuzS5hKthxvpBDtv1c1YPa6Pacw"</span>&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"\n\n"</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(state)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//查询合约状态 参数是合约地址</span></span><br><span class="line">api.getAccountState(&#123;<span class="attr">address</span>: <span class="string">"n1qGHtVR16SDtuzM9KSGvxtpT9PpUfr8QaR"</span>&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"\n\n"</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(state)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//查询区块链上的信息</span></span><br><span class="line"><span class="comment">//新生成的钱包地址，因为查询是谁都能查</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">from</span> = Account.NewAccount().getAddressString();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"\n\n\n"</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">from</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"\n\n\n"</span>)</span><br><span class="line"><span class="comment">//合约地址：制定从哪个合约上查询</span></span><br><span class="line"><span class="keyword">var</span> dappAddress = <span class="string">"n1qGHtVR16SDtuzM9KSGvxtpT9PpUfr8QaR"</span></span><br><span class="line"><span class="keyword">var</span> value = <span class="string">"0"</span>;</span><br><span class="line"><span class="keyword">var</span> nonce = <span class="string">"0"</span></span><br><span class="line"><span class="keyword">var</span> gas_price = <span class="string">"1000000"</span></span><br><span class="line"><span class="keyword">var</span> gas_limit = <span class="string">"2000000"</span></span><br><span class="line"><span class="comment">//调用的方法，get获取</span></span><br><span class="line"><span class="keyword">var</span> callFunction = <span class="string">"get"</span>;</span><br><span class="line"><span class="comment">//需要查询的内容，字符串表示//</span></span><br><span class="line"><span class="keyword">var</span> callArgs = <span class="string">"[\""</span> + <span class="string">"test"</span> + <span class="string">"\"]"</span>;</span><br><span class="line"><span class="keyword">var</span> contract = &#123;</span><br><span class="line">    <span class="string">"function"</span>: callFunction,</span><br><span class="line">    <span class="string">"args"</span>: callArgs</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//调用查询方法,上面写的一堆参数</span></span><br><span class="line">neb.api.call(<span class="keyword">from</span>,dappAddress,value,nonce,gas_price,gas_limit,contract).then(<span class="function"><span class="keyword">function</span> (<span class="params">resp</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(resp)</span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//cbSearch(err)</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"error:"</span> + err.message)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>改造app.js 实现从区块链上查询内容</p>
<p><img src="http://p8ghajf4r.bkt.clouddn.com/07.png" alt="07"></p>
<p>代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Nebulas = <span class="built_in">require</span>(<span class="string">'nebulas'</span>)</span><br><span class="line"><span class="keyword">var</span> Neb = Nebulas.Neb; <span class="comment">// Neb</span></span><br><span class="line"><span class="keyword">var</span> neb = <span class="keyword">new</span> Neb(<span class="keyword">new</span> Nebulas.HttpRequest(<span class="string">"https://testnet.nebulas.io"</span>));</span><br><span class="line"><span class="keyword">var</span> Account = Nebulas.Account;</span><br><span class="line"><span class="keyword">var</span> api = neb.api;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">	<span class="comment">//结构提</span></span><br><span class="line">	<span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">		<span class="keyword">super</span>(props)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//页面渲染</span></span><br><span class="line">	render() &#123;</span><br><span class="line">		<span class="keyword">return</span> (</span><br><span class="line">			</span><br><span class="line">			&lt;div style=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="string">"rgb(52,83,136)"</span>,<span class="attr">flex</span>: <span class="number">1</span></span><br><span class="line">				,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">flexDirection</span>: <span class="string">'column'</span>,<span class="attr">alignItems</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">          		&lt;img src=<span class="string">"imag/logo.png"</span> style=&#123;&#123;<span class="attr">marginTop</span>: <span class="number">20</span>&#125;&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span></span><br><span class="line">         	  	&lt;div style=&#123;&#123;<span class="attr">width</span>: <span class="string">"100%"</span>,<span class="attr">height</span>: <span class="number">100</span>,<span class="attr">marginTop</span>: <span class="number">100</span>,<span class="attr">display</span>: <span class="string">"flex"</span>,<span class="attr">justifyContent</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">              	&lt;input</span><br><span class="line">                	ref=<span class="string">"inputRef"</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">borderWidth</span>: <span class="number">3</span>,<span class="attr">borderColor</span>: <span class="string">"gray"</span>,<span class="attr">fontSize</span>: <span class="number">50</span>,<span class="attr">flex</span>: <span class="number">1</span>,<span class="attr">marginLeft</span>: <span class="number">100</span>&#125;&#125;/&gt;</span><br><span class="line">          			<span class="comment">//按钮标签，绑定onclick 点击时间</span></span><br><span class="line">                	&lt;button onClick = &#123;() =&gt; &#123;</span><br><span class="line">                		<span class="built_in">console</span>.log(<span class="string">"搜索"</span>)</span><br><span class="line">                  	<span class="built_in">console</span>.log(<span class="keyword">this</span>.refs.inputRef.value)</span><br><span class="line"></span><br><span class="line">                  <span class="comment">//以下是调用neb自带的查询方法,用来实现从区块链上查询内容</span></span><br><span class="line">                  <span class="keyword">var</span> <span class="keyword">from</span> = Account.NewAccount().getAddressString();</span><br><span class="line">                  <span class="keyword">var</span> dappAddress = <span class="string">"n1NPapTqKduzc9vFVsP1uqm1FqFEQWxj3Mp"</span></span><br><span class="line">                  <span class="keyword">var</span> value = <span class="string">"0"</span>;</span><br><span class="line">                  <span class="keyword">var</span> nonce = <span class="string">"0"</span></span><br><span class="line">                  <span class="keyword">var</span> gas_price = <span class="string">"1000000"</span></span><br><span class="line">                  <span class="keyword">var</span> gas_limit = <span class="string">"2000000"</span></span><br><span class="line">                  <span class="keyword">var</span> callFunction = <span class="string">"get"</span>;</span><br><span class="line">                  <span class="comment">//获取input标签输入的内容</span></span><br><span class="line">                  <span class="keyword">var</span> callArgs = <span class="string">"[\""</span> + <span class="keyword">this</span>.refs.inputRef.value + <span class="string">"\"]"</span>;</span><br><span class="line">                  <span class="keyword">var</span> contract = &#123;</span><br><span class="line">                      <span class="string">"function"</span>: callFunction,</span><br><span class="line">                      <span class="string">"args"</span>: callArgs</span><br><span class="line">                  &#125;</span><br><span class="line"></span><br><span class="line">                  neb.api.call(<span class="keyword">from</span>,dappAddress,value,nonce,gas_price,gas_limit,contract).then(<span class="function"><span class="keyword">function</span> (<span class="params">resp</span>) </span>&#123;</span><br><span class="line">                      <span class="built_in">console</span>.log(<span class="string">"over\n"</span>)</span><br><span class="line">                      <span class="built_in">console</span>.log(resp)</span><br><span class="line">                  &#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">                      <span class="built_in">console</span>.log(<span class="string">"error:"</span> + err.message)</span><br><span class="line">                  &#125;)</span><br><span class="line"></span><br><span class="line">                	&#125;&#125;</span><br><span class="line">                	<span class="comment">//设置按钮样式</span></span><br><span class="line">                	style=&#123;&#123;<span class="attr">width</span>: <span class="number">200</span>,<span class="attr">marginLeft</span>: <span class="number">40</span>,<span class="attr">fontSize</span>: <span class="number">50</span>,<span class="attr">marginRight</span>: <span class="number">100</span>&#125;&#125; &gt;SEARCH&lt;<span class="regexp">/button&gt;	</span></span><br><span class="line"><span class="regexp">          		&lt;/</span>div&gt;</span><br><span class="line">        	&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">			</span></span><br><span class="line"><span class="regexp">		)</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>
<p>自测一遍没什么问题，如有问题可能细节出错</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://liguoyu.com/2018/05/02/Nebulas-03  使用星云WEB钱包部署合约/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李国玉">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李国玉区块链博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/02/Nebulas-03  使用星云WEB钱包部署合约/" itemprop="url">
                  Nebulas-03  使用星云WEB钱包部署合约
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-05-02 19:45:07" itemprop="dateCreated datePublished" datetime="2018-05-02T19:45:07+08:00">2018-05-02</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-05-10 19:13:26" itemprop="dateModified" datetime="2018-05-10T19:13:26+08:00">2018-05-10</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##下载安装web端钱包</p>
<p>地址：<a href="https://github.com/nebulasio/web-wallet" target="_blank" rel="noopener">https://github.com/nebulasio/web-wallet</a></p>
<p>结构目录如下：</p>
<p><img src="http://p8iex6zz4.bkt.clouddn.com/%E9%92%B1%E5%8C%85%E5%9B%BE%E7%89%87.png" alt="钱包图片"></p>
<h2 id="部署合约"><a href="#部署合约" class="headerlink" title="部署合约"></a>部署合约</h2><p>​                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              打开刚下载的钱包目录，打开index.html,  展示页面如下</p>
<p><img src="http://p8iex6zz4.bkt.clouddn.com/%E9%92%B1%E5%8C%85%E9%A1%B5%E9%9D%A2.png" alt="钱包页面"></p>
<p>默认打开是英文页面，右上角有语言选择，切换到中文即可</p>
<p>接下来<strong>点击 合约</strong>，这里我们切换到本地网络部署，方法如下</p>
<p><img src="http://p8iex6zz4.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-08%20%E4%B8%8B%E5%8D%8810.21.33.png" alt="屏幕快照 2018-05-08 下午10.21.33"></p>
<p>最终页面展示如下：</p>
<p><img src="http://p8iex6zz4.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-08%20%E4%B8%8B%E5%8D%8810.24.36.png" alt="屏幕快照 2018-05-08 下午10.24.36"></p>
<p>以下代码是官方提供的合约内容，可直接粘贴使用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">"use strict"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> DictItem = <span class="function"><span class="keyword">function</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (text) &#123;</span><br><span class="line">		<span class="keyword">var</span> obj = <span class="built_in">JSON</span>.parse(text);</span><br><span class="line">		<span class="keyword">this</span>.key = obj.key;</span><br><span class="line">		<span class="keyword">this</span>.value = obj.value;</span><br><span class="line">		<span class="keyword">this</span>.author = obj.author;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	    <span class="keyword">this</span>.key = <span class="string">""</span>;</span><br><span class="line">	    <span class="keyword">this</span>.author = <span class="string">""</span>;</span><br><span class="line">	    <span class="keyword">this</span>.value = <span class="string">""</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">DictItem.prototype = &#123;</span><br><span class="line">	toString: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> SuperDictionary = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    LocalContractStorage.defineMapProperty(<span class="keyword">this</span>, <span class="string">"repo"</span>, &#123;</span><br><span class="line">        parse: <span class="function"><span class="keyword">function</span> (<span class="params">text</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> DictItem(text);</span><br><span class="line">        &#125;,</span><br><span class="line">        stringify: <span class="function"><span class="keyword">function</span> (<span class="params">o</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> o.toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">SuperDictionary.prototype = &#123;</span><br><span class="line">    init: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// todo</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    save: <span class="function"><span class="keyword">function</span> (<span class="params">key, value</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">        key = key.trim();</span><br><span class="line">        value = value.trim();</span><br><span class="line">        <span class="keyword">if</span> (key === <span class="string">""</span> || value === <span class="string">""</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"empty key / value"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (value.length &gt; <span class="number">64</span> || key.length &gt; <span class="number">64</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"key / value exceed limit length"</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> <span class="keyword">from</span> = Blockchain.transaction.from;</span><br><span class="line">        <span class="keyword">var</span> dictItem = <span class="keyword">this</span>.repo.get(key);</span><br><span class="line">        <span class="keyword">if</span> (dictItem)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"value has been occupied"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        dictItem = <span class="keyword">new</span> DictItem();</span><br><span class="line">        dictItem.author = <span class="keyword">from</span>;</span><br><span class="line">        dictItem.key = key;</span><br><span class="line">        dictItem.value = value;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.repo.put(key, dictItem);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    get: <span class="function"><span class="keyword">function</span> (<span class="params">key</span>) </span>&#123;</span><br><span class="line">        key = key.trim();</span><br><span class="line">        <span class="keyword">if</span> ( key === <span class="string">""</span> ) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"empty key"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.repo.get(key);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">module</span>.exports = SuperDictionary;</span><br></pre></td></tr></table></figure>
<p>现在需要把上面提到的智能合约粘贴到“<strong>合约代码</strong>”一栏中：</p>
<p><img src="http://p8iex6zz4.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-08%20%E4%B8%8B%E5%8D%8810.29.34.png" alt="屏幕快照 2018-05-08 下午10.29.34"></p>
<blockquote>
<p><strong>注意</strong>：星云链合约支持javascript和typescript两种语言。</p>
<p>智能合约必须完整地复制到“合约”一栏中（手动输入可能导致无效）</p>
</blockquote>
<p><strong>参数</strong> 一栏空着即可 此智能合约使用JavaScript语言书写，</p>
<p>单击“<strong>选择你的钱包文件</strong>”来选择秘钥文件，然后单击“<strong>解锁</strong>”，你将看到以下信息：</p>
<p><img src="http://p8iex6zz4.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-08%20%E4%B8%8B%E5%8D%8810.35.53.png" alt="屏幕快照 2018-05-08 下午10.35.53"></p>
<p>有些同学打开可能会报网络错误，如下：</p>
<p><img src="http://p8iex6zz4.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-08%20%E4%B8%8B%E5%8D%8810.33.31.png" alt="屏幕快照 2018-05-08 下午10.33.31"></p>
<p><strong>解决方法</strong></p>
<ol>
<li>检查本地的种子节点和矿工节点是否启动。</li>
<li>如果第一步启动还报错，就到安装的星云链主目录下找到 <strong>conf文件夹 &gt;default文件夹 &gt; config.conf</strong>,修改配置，如下</li>
</ol>
<p><img src="http://p8iex6zz4.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-08%20%E4%B8%8B%E5%8D%8810.41.12.png" alt="屏幕快照 2018-05-08 下午10.41.12"></p>
<p><img src="/Users/liguoyu/Desktop/WX20180508-224739@2x.png" alt="WX20180508-224739@2x"></p>
<p>上述步骤完成后单击“<strong>测试</strong>”，检查智能合约有无错误。</p>
<p>因为我之前有向这个钱包转了NAS,所以显示成功，但是如果第一次操作，大部分测试结果显示“余额不足”。因为账户里没有NAS，这是需要你往钱包转点NAS了，当然转的事本地链上的。</p>
<p><img src="http://p8iex6zz4.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-08%20%E4%B8%8B%E5%8D%8810.51.04.png" alt="屏幕快照 2018-05-08 下午10.51.04"></p>
<p>点击“<strong>提交</strong>”继续操作，这时会收到一个 <strong>TX Hash</strong>地址和一个<strong>智能合约地址</strong>。保存这两个地址以查看交易。</p>
<p><img src="http://p8iex6zz4.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-08%20%E4%B8%8B%E5%8D%8810.54.42.png" alt="屏幕快照 2018-05-08 下午10.54.42"></p>
<p>接下来让我们搜索我们自己的合约。 向上滑动鼠标至页面顶端，单击“<strong>搜索</strong>”选项卡</p>
<p>键入我们保存的TxHash地址，单击“搜索”选项</p>
<p>这一步结束后会看到原始的智能合约</p>
<p>这样就成功的了解了如何在星云网络上部署智能合约以及搜索合约.</p>
<p><strong>声明：版权所有，转载请注明出处 威信：lixuan111222</strong></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://liguoyu.com/2018/04/28/Nebulas-02 在星云链上发送交易/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李国玉">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李国玉区块链博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/28/Nebulas-02 在星云链上发送交易/" itemprop="url">
                  Nebulas-02 在星云链上发送交易
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-04-28 13:27:07" itemprop="dateCreated datePublished" datetime="2018-04-28T13:27:07+08:00">2018-04-28</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-05-10 19:00:22" itemprop="dateModified" datetime="2018-05-10T19:00:22+08:00">2018-05-10</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Nebulas提供了三种方式去发送我们的交易：</p>
<ol>
<li>签名 &amp; 发送</li>
<li>密码 &amp; 发送</li>
<li>解锁 &amp; 发送</li>
</ol>
<p>下面我们分别介绍如何通过以上三种方式在nebulas中发送一笔交易，并验证交易是否成功。</p>
<h2 id="准备账户"><a href="#准备账户" class="headerlink" title="准备账户"></a>准备账户</h2><p>在星云链上，每个地址表示一个唯一的账户，一一对应。</p>
<p>在发送交易前，我们需要准备两个账户：一个账户用来发送代币 (称为”from”) 和另一个账户来接受代币 (称为”to”).</p>
<h3 id="发送者账户"><a href="#发送者账户" class="headerlink" title="发送者账户"></a>发送者账户</h3><p>在这里，我们将会使用配置文件<code>conf/default/genesis.conf</code>中预分配过代币的账户中选择一个作为发送者账户，默认选择<code>n1FF1nz6tarkDVwWQkMnnwFPuPKUaQTdptE</code>。</p>
<h3 id="接受者账户"><a href="#接受者账户" class="headerlink" title="接受者账户"></a>接受者账户</h3><p>我们使用如下指令创建一个全新的账户来做接受者，请记住输入的密码。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ./neb account new</span><br><span class="line">Your new account is locked with a passphrase. Please give a passphrase. Do not forget this passphrase.</span><br><span class="line">Passphrase:</span><br><span class="line">Repeat passphrase:</span><br><span class="line">Address: n1SQe5d1NKHYFMKtJ5sNHPsSPVavGzW71Wy</span><br></pre></td></tr></table></figure>
<blockquote>
<p>提示：你创建的新账户和上面可能不一样，请以你创建的账户做为接受者继续接下来的实验。</p>
</blockquote>
<p>新账户的keystore文件将会被放置在<code>$GOPATH/src/github.com/nebulasio/go-nebulas/keydir/</code>内。</p>
<h2 id="启动私有链"><a href="#启动私有链" class="headerlink" title="启动私有链"></a>启动私有链</h2><p>我们将在本地搭建一个私有链来作为本教程的测试环境。</p>
<h3 id="启动种子节点"><a href="#启动种子节点" class="headerlink" title="启动种子节点"></a>启动种子节点</h3><p>首先，我们启动本地私有链的第一个节点，它可以作为其他节点的种子节点。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./neb -c conf/default/config.conf</span><br></pre></td></tr></table></figure>
<h3 id="启动矿工节点"><a href="#启动矿工节点" class="headerlink" title="启动矿工节点"></a>启动矿工节点</h3><p>接着，我们启动一个矿工节点接入本地私有链，这个节点之后将会产生新的区块。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./neb -c conf/example/miner.conf</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>多久会生成一个新的区块?</strong></p>
<p>在星云链上, 在贡献度证明（Proof-of-Devotion， <a href="https://nebulas.io/docs/NebulasTechnicalWhitepaper.pdf" target="_blank" rel="noopener">技术白皮书</a>中有详细描述）被充分验证前，DPoS被选择作为一个过渡方案。在我们采用DPoS共识算法中，总共有21个矿工，每个矿工会轮流每15s出一个新区块。</p>
<p>在我们目前的测试环境中，由于我们只启动了21个矿工中的一个，所以需要等待15*21s才会出一个新区块。</p>
</blockquote>
<p>一旦一个新区块被挖出，挖块奖励将会被自动发送到当前矿工配置的Coinbase账户中，在<code>conf/example/miner.conf</code>里，该账户就是<code>n1FF1nz6tarkDVwWQkMnnwFPuPKUaQTdptE</code>.</p>
<h2 id="星云链交互"><a href="#星云链交互" class="headerlink" title="星云链交互"></a>星云链交互</h2><p>星云链提供给开发者HTTP API, RPC API和CLI来和运行中的星云节点交互。在教程中，我们将会基于HTTP API（<a href="https://github.com/nebulasio/wiki/blob/master/rpc.md" target="_blank" rel="noopener">API Module</a> | <a href="https://github.com/nebulasio/wiki/blob/master/rpc_admin.md" target="_blank" rel="noopener">Admin Module</a>）来介绍三种发送交易的方法。</p>
<blockquote>
<p>提示：星云链的HTTP服务默认端口号为8685。</p>
</blockquote>
<p>首先，在发送新交易前，我们检查下发送者账户的状态。</p>
<h3 id="检查账户状态"><a href="#检查账户状态" class="headerlink" title="检查账户状态"></a>检查账户状态</h3><p><strong>（一下使用的钱包全部是系统分配的钱包，如果想测试自己创建的钱包可以把转账目的的钱包地址换成自己的）</strong></p>
<p>每个交易如果需要上链，都需要给矿工缴纳一部分手续费，所以发送者账户中需要有一部分钱才能成功发送交易。一般一个普通转账交易，手续费在0.000000002NAS左右，非常少。</p>
<p>我们可以通过<a href="https://github.com/nebulasio/wiki/blob/master/rpc.md#getaccountstate" target="_blank" rel="noopener">API Module</a>中的<code>/v1/user/accountstate</code>接口来获取发送者账户<code>n1FF1nz6tarkDVwWQkMnnwFPuPKUaQTdptE</code>的账户信息，检查下是否有足够的钱支付上链手续费。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; curl -i -H Accept:application/json -X POST http://localhost:8685/v1/user/accountstate -d <span class="string">'&#123;"address":"n1FF1nz6tarkDVwWQkMnnwFPuPKUaQTdptE"&#125;'</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"result"</span>:&#123;<span class="string">"balance"</span>:<span class="string">"5000000000000000000000000"</span>,<span class="string">"nonce"</span>:<span class="string">"0"</span>,<span class="string">"type"</span>:87&#125;&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>提示：<code>Type</code>用于标记账户类型。88表示该账户为智能合约账户，部署一个合约之后，就可以得到一个合约账户。87表示非合约账户，我们通过<code>./neb account new</code>创建的账户就是非合约账户，用户存储链上资产。</p>
</blockquote>
<blockquote>
<p>提示：<code>Nonce</code>用于标记账户发起的所有交易的顺序。同一个账户，每发起一个新的交易，<code>Nonce</code>就加一，初始为0，第一个交易的<code>Nonce</code>为1。</p>
</blockquote>
<p>如我们所见，发送者账户在预分配后拥有5000000000000000000000000(5 * 10^24)个代币，1个NAS是1000000000000000000（10^18）个代币，用于支付交易上链的手续费绰绰有余。</p>
<p>然后我们检查接受者账户的状态。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; curl -i -H Accept:application/json -X POST http://localhost:8685/v1/user/accountstate -d <span class="string">'&#123;"address":"n1SQe5d1NKHYFMKtJ5sNHPsSPVavGzW71Wy"&#125;'</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"result"</span>:&#123;<span class="string">"balance"</span>:<span class="string">"0"</span>,<span class="string">"nonce"</span>:<span class="string">"0"</span>,<span class="string">"type"</span>:87&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>如我们期望的那样，新账户没有任何代币。</p>
<h3 id="发送交易"><a href="#发送交易" class="headerlink" title="发送交易"></a>发送交易</h3><p>接下来，我们将介绍星云链上三种发送交易的方式。</p>
<h4 id="签名-amp-发送"><a href="#签名-amp-发送" class="headerlink" title="签名 &amp; 发送"></a>签名 &amp; 发送</h4><p>使用这种方式，我们可以在离线环境下先使用私钥签名好交易，然后把签好名的交易在联网的机器上发出。这是最安全的发送交易的方式，私钥可以完全离线保存，不触网。<a href="https://github.com/nebulasio/web-wallet" target="_blank" rel="noopener">Web-Wallet</a>正是基于<a href="https://github.com/nebulasio/neb.js" target="_blank" rel="noopener">Neb.js</a>采用这种方法发送的交易。</p>
<p>首先，我们使用<a href="https://github.com/nebulasio/wiki/blob/master/rpc_admin.md#signtransactionwithpassphrase" target="_blank" rel="noopener">Admin Module</a>中的<code>v1/admin/sign</code>接口给准备发的交易签名，得到交易的二进制数据。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; curl -i -H <span class="string">'Content-Type: application/json'</span> -X POST http://localhost:8685/v1/admin/sign -d <span class="string">'&#123;"transaction":&#123;"from":"n1FF1nz6tarkDVwWQkMnnwFPuPKUaQTdptE","to":"n1QZMXSZtW7BUerroSms4axNfyBGyFGkrh5", "value":"1000000000000000000","nonce":1,"gasPrice":"1000000","gasLimit":"2000000"&#125;, "passphrase":"passphrase"&#125;'</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"result"</span>:&#123;<span class="string">"data"</span>:<span class="string">"CiAbjMP5dyVsTWILfXL1MbwZ8Q6xOgX/JKinks1dpToSdxIaGVcH+WT/SVMkY18ix7SG4F1+Z8evXJoA35caGhlXbip8PupTNxwV4SRM87r798jXWADXpWngIhAAAAAAAAAAAA3gtrOnZAAAKAEwuKuC1wU6CAoGYmluYXJ5QGRKEAAAAAAAAAAAAAAAAAAPQkBSEAAAAAAAAAAAAAAAAAAehIBYAWJBVVuRHWSNY1e3bigbVKd9i6ci4f1LruDC7AUtXDLirHlsmTDZXqjSMGLio1ziTmxYJiLj+Jht5RoZxFKqFncOIQA="</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>提示：在发送交易时，对于同一个账户，只有当他<code>Nonce</code>为N的交易上链后，<code>Nonce</code>为N+1的交易才能上链，有严格的顺序，<code>Nonce</code>必须严格加1。可以通过<a href="https://github.com/nebulasio/wiki/blob/master/rpc.md#getaccountstate" target="_blank" rel="noopener">GetAccountState</a>接口查看最新的Nonce。</p>
</blockquote>
<p>然后，我们将签好名的交易原始数据提交到本地私有链里的星云节点。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; curl -i -H &apos;Content-Type: application/json&apos; -X POST http://localhost:8685/v1/user/rawtransaction -d &apos;&#123;&quot;data&quot;:&quot;CiAbjMP5dyVsTWILfXL1MbwZ8Q6xOgX/JKinks1dpToSdxIaGVcH+WT/SVMkY18ix7SG4F1+Z8evXJoA35caGhlXbip8PupTNxwV4SRM87r798jXWADXpWngIhAAAAAAAAAAAA3gtrOnZAAAKAEwuKuC1wU6CAoGYmluYXJ5QGRKEAAAAAAAAAAAAAAAAAAPQkBSEAAAAAAAAAAAAAAAAAAehIBYAWJBVVuRHWSNY1e3bigbVKd9i6ci4f1LruDC7AUtXDLirHlsmTDZXqjSMGLio1ziTmxYJiLj+Jht5RoZxFKqFncOIQA=&quot;&#125;&apos;</span><br><span class="line"></span><br><span class="line">&#123;&quot;result&quot;:&#123;&quot;txhash&quot;:&quot;1b8cc3f977256c4d620b7d72f531bc19f10eb13a05ff24a8a792cd5da53a1277&quot;,&quot;contract_address&quot;:&quot;&quot;&#125;&#125;⏎</span><br></pre></td></tr></table></figure>
<h4 id="密码-amp-发送"><a href="#密码-amp-发送" class="headerlink" title="密码 &amp; 发送"></a>密码 &amp; 发送</h4><p>如果你信任一个星云节点帮你保存keystore文件，你可以使用第二种方法发送交易。</p>
<p>首先，上传你的keystore文件到你信任的星云节点的keydir文件夹下。如果在节点在本地，可以使用如下指令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /path/to/keystore.json /path/to/keydir/</span><br></pre></td></tr></table></figure>
<p>然后，我们发送交易的同时，带上我们keystore的密码，在被信任的节点使用<a href="https://github.com/nebulasio/wiki/blob/master/rpc_admin.md#sendtransactionwithpassphrase" target="_blank" rel="noopener">SendTransactionWithPassphrase</a>接口上一次性完成签名和发送过程。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; curl -i -H <span class="string">'Content-Type: application/json'</span> -X POST http://localhost:8685/v1/admin/transactionWithPassphrase -d <span class="string">'&#123;"transaction":&#123;"from":"n1FF1nz6tarkDVwWQkMnnwFPuPKUaQTdptE","to":"n1QZMXSZtW7BUerroSms4axNfyBGyFGkrh5", "value":"1000000000000000000","nonce":2,"gasPrice":"1000000","gasLimit":"2000000"&#125;,"passphrase":"passphrase"&#125;'</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"result"</span>:&#123;<span class="string">"txhash"</span>:<span class="string">"3cdd38a66c8f399e2f28134e0eb556b292e19d48439f6afde384ca9b60c27010"</span>,<span class="string">"contract_address"</span>:<span class="string">""</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>提示：因为我们在之前使用<code>n1FF1nz6tarkDVwWQkMnnwFPuPKUaQTdptE</code>发送了一个<code>Nonce</code>为1的交易，所以这里新的交易的<code>Nonce</code>应该增加1，变成2再提交。</p>
</blockquote>
<h4 id="解锁-amp-发送"><a href="#解锁-amp-发送" class="headerlink" title="解锁 &amp; 发送"></a>解锁 &amp; 发送</h4><p>这是最危险的发送交易的方法。除非你完全信任一个星云节点，否则不要使用这种方法来发送交易。</p>
<p>首先，上传你的keystore文件到你信任的星云节点的keydir文件夹下。如果在节点在本地，可以使用如下指令。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /path/to/keystore.json /path/to/keydir/</span><br></pre></td></tr></table></figure>
<p>然后，使用你的keystore文件的密码，在指定的时间范围来在被信任的节点上使用<a href="https://github.com/nebulasio/wiki/blob/master/rpc_admin.md#unlockaccount" target="_blank" rel="noopener">Unlock</a>接口解锁账户。时间单位为纳秒，300000000000为300s。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; curl -i -H <span class="string">'Content-Type: application/json'</span> -X POST http://localhost:8685/v1/admin/account/unlock -d <span class="string">'&#123;"address":"n1FF1nz6tarkDVwWQkMnnwFPuPKUaQTdptE","passphrase":"passphrase","duration":"300000000000"&#125;'</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"result"</span>:&#123;<span class="string">"result"</span>:<span class="literal">true</span>&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>一旦一个账户在节点上被解锁，任何可以访问该机器<a href="https://github.com/nebulasio/wiki/blob/master/rpc_admin.md#sendtransaction" target="_blank" rel="noopener">SendTransaction</a>接口的人，都可以直接使用该账户的身份发送交易。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; curl -i -H <span class="string">'Content-Type: application/json'</span> -X POST http://localhost:8685/v1/admin/transaction -d <span class="string">'&#123;"from":"n1FF1nz6tarkDVwWQkMnnwFPuPKUaQTdptE","to":"n1QZMXSZtW7BUerroSms4axNfyBGyFGkrh5", "value":"1000000000000000000","nonce":3,"gasPrice":"1000000","gasLimit":"2000000"&#125;'</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"result"</span>:&#123;<span class="string">"txhash"</span>:<span class="string">"8d69dea784f0edfb2ee678c464d99e155bca04b3d7e6cdba6c5c189f731110cf"</span>,<span class="string">"contract_address"</span>:<span class="string">""</span>&#125;&#125;⏎</span><br></pre></td></tr></table></figure>
<h2 id="交易收据"><a href="#交易收据" class="headerlink" title="交易收据"></a>交易收据</h2><p>不论使用的哪一种方法发送交易，我们都会得到两个返回值，<code>txhash</code>和<code>contract_address</code>。其中<code>txhash</code>为交易hash，是一个交易的唯一标识。如果当前交易是一个部署合约的交易，<code>contract_address</code>将会是合约地址，调用合约时都会使用这个地址，是合约的唯一标识。我们将在<a href="https://github.com/nebulasio/wiki/blob/master/tutorials/%5B%E4%B8%AD%E6%96%87%5D%20Nebulas%20101%20-%2003%20%E7%BC%96%E5%86%99%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6.md" target="_blank" rel="noopener">编写并运行智能合约</a>中介绍如何发送部署合约的交易。</p>
<p>使用<code>txhash</code>我们可以查看交易收据，知道当前交易的状态。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; curl -i -H Accept:application/json -X POST http://localhost:8685/v1/user/getTransactionReceipt -d <span class="string">'&#123;"hash":"8d69dea784f0edfb2ee678c464d99e155bca04b3d7e6cdba6c5c189f731110cf"&#125;'</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"result"</span>:&#123;<span class="string">"hash"</span>:<span class="string">"8d69dea784f0edfb2ee678c464d99e155bca04b3d7e6cdba6c5c189f731110cf"</span>,<span class="string">"chainId"</span>:100,<span class="string">"from"</span>:<span class="string">"n1FF1nz6tarkDVwWQkMnnwFPuPKUaQTdptE"</span>,<span class="string">"to"</span>:<span class="string">"n1QZMXSZtW7BUerroSms4axNfyBGyFGkrh5"</span>,<span class="string">"value"</span>:<span class="string">"1000000000000000000"</span>,<span class="string">"nonce"</span>:<span class="string">"3"</span>,<span class="string">"timestamp"</span>:<span class="string">"1524667888"</span>,<span class="string">"type"</span>:<span class="string">"binary"</span>,<span class="string">"data"</span>:null,<span class="string">"gas_price"</span>:<span class="string">"1000000"</span>,<span class="string">"gas_limit"</span>:<span class="string">"2000000"</span>,<span class="string">"contract_address"</span>:<span class="string">""</span>,<span class="string">"status"</span>:1,<span class="string">"gas_used"</span>:<span class="string">"20000"</span>&#125;&#125;⏎</span><br></pre></td></tr></table></figure>
<p>这里的<code>status</code>可能有三种状态值，0，1和2。</p>
<ul>
<li><strong>0: 交易失败.</strong> 表示当前交易已经上链，但是执行失败了。可能是因为部署合约或者调用合约参数错误。</li>
<li><strong>1: 交易成功.</strong> 表示当前交易已经上链，而且执行成功了。</li>
<li><strong>2: 交易待定.</strong> 表示当前交易还没有上链。可能是因为当前交易还没有被打包；如果长时间处于当前状态，可能是因为当前交易的发送者账户的余额不够支付上链手续费。</li>
</ul>
<h3 id="复查接受者账户余额"><a href="#复查接受者账户余额" class="headerlink" title="复查接受者账户余额"></a>复查接受者账户余额</h3><p>我们复查一下接受者账户上的钱是否已经到账了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; curl -i -H Accept:application/json -X POST http://localhost:8685/v1/user/accountstate -d <span class="string">'&#123;"address":"n1QZMXSZtW7BUerroSms4axNfyBGyFGkrh5"&#125;'</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"result"</span>:&#123;<span class="string">"balance"</span>:<span class="string">"3000000000000000000"</span>,<span class="string">"nonce"</span>:<span class="string">"0"</span>,<span class="string">"type"</span>:87&#125;&#125;</span><br></pre></td></tr></table></figure>
<p>我们用三种方式分别发送了一笔转账，每笔转一个NAS，所以这里看到接受者账户中已经有了3个NAS，即3000000000000000000个代币。</p>
<p><strong>声明：转载请注明出处 威信：lixuan111222</strong></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://liguoyu.com/2018/04/27/Nebulas-01-星云链编译安装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李国玉">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李国玉区块链博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/27/Nebulas-01-星云链编译安装/" itemprop="url">
                  Nebulas-01  星云链编译安装
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-04-27 10:15:25" itemprop="dateCreated datePublished" datetime="2018-04-27T10:15:25+08:00">2018-04-27</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-05-16 09:04:41" itemprop="dateModified" datetime="2018-05-16T09:04:41+08:00">2018-05-16</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>星云链的项目代码已经发布了几个版本，经过测试可以在本地运行，大家可以下载星云链源代码在本地编译私有链。</p>
<p>想了解星云链的同学可以阅读星云链非技术白皮书。</p>
<p>对技术感兴趣的同学可以看星云链技术白皮书和星云链Github</p>
<p>星云链现阶段只能在Mac和Linux上运行，后续会推出windows版本。</p>
<p>Golang环境搭建</p>
<p>  Components    Version     Description<br>  Golang        &gt;= 1.9.2    The Go Programming Language</p>
<p>我们会分别介绍Mac OSX和Linux两种系统下golang环境的搭建。</p>
<p>Mac OSX</p>
<p>在Mac OSX里，我们推荐使用Homebrew来安装Golang.</p>
<pre><code># 安装
brew install go

# 配置环境变量
export GOPATH=/path/to/workspace
</code></pre><p>提示: 在golang的开发中，GOPATH是必须的，它指定了我们使用golang开发的工作空间。所有的源码都应放在GOPATH之下。</p>
<p>Linux</p>
<pre><code># download
wget https://dl.google.com/go/go1.9.3.linux-amd64.tar.gz

# extract
tar -C /usr/local -xzf go1.9.3.linux-amd64.tar.gz

# environment variables
export PATH=$PATH:/usr/local/go/bin
export GOPATH=/path/to/workspace
</code></pre><p>编译星云链</p>
<p>下载源码</p>
<p>可以使用如下指令直接下载最新版本的星云链源码。</p>
<pre><code># 进入工作目录
mkdir -p $GOPATH/src/github.com/nebulasio
cd $GOPATH/src/github.com/nebulasio

# 下载源码
git clone https://github.com/nebulasio/go-nebulas.git

# 进入项目目录
cd go-nebulas

# 切换到最稳定的master分支
git checkout master
</code></pre><p>安装rocksdb依赖库</p>
<p>同样我们会介绍如何在MAC OSX和Linux正确安装RocksDB。</p>
<p>Mac OSX</p>
<p>可以直接通过Homebrew安装，运行   brew install rocksdb</p>
<p>Linux</p>
<p>在linux环境下，由于ubuntu和centos系统的用户偏多，我们将分别介绍这两个主流环境下RocksDB的安装。</p>
<p>Ubuntu</p>
<ul>
<li>首先安装RocksDB所需依赖库<pre><code>apt-get update
apt-get -y install build-essential libgflags-dev libsnappy-dev zlib1g-dev libbz2-dev liblz4-dev libzstd-dev
</code></pre></li>
<li>下载源码并编译安装<pre><code>git clone https://github.com/facebook/rocksdb.git
cd rocksdb &amp; make shared_lib &amp;&amp; make install-shared
</code></pre></li>
</ul>
<p>make shared_lib 有些同学会报错，请访问<a href="https://www.cnblogs.com/shuren/p/3981744.html" target="_blank" rel="noopener">https://www.cnblogs.com/shuren/p/3981744.html</a> 基本能解决问题</p>
<p>安装Go依赖库</p>
<p>在Go-Nebulas中，Go的三方库都通过Dep来做管理</p>
<pre><code>Components(-)          |          Version(-)           |          Description(-)          
[Dep](https://github.com/golang/dep)            |           &gt;= 0.3.1          |          Dep is a dependency management tool for Go.          
</code></pre><p>安装Dep工具</p>
<p>我们同样分别介绍Mac OSX和Linux下Dep的安装方法。</p>
<p>Mac OSX</p>
<ul>
<li>通过Homebrew直接安装并升级Dep<pre><code>brew install dep
brew upgrade dep
</code></pre></li>
</ul>
<p>Linux</p>
<ul>
<li>通过源码来安装Dep<pre><code>cd /usr/local/bin/
wget https://github.com/golang/dep/releases/download/v0.3.2/dep-linux-amd64
ln -s dep-linux-amd64 dep
</code></pre></li>
</ul>
<p>下载Go三方库</p>
<p>我们切换到Go-Nebulas项目根目录，然后使用Dep来下载三方库。</p>
<pre><code>cd $GOPATH/src/github.com/nebulasio/go-nebulas
make dep
</code></pre><p>有些同学执行 make dep 报错，可直接用下面的方法安装三方库，效果一样。</p>
<p>提示: make dep将会下载很多依赖库。在部分地区，这个过程可能比较耗时。所以，我们提供了依赖库的压缩包vendor.tar.gz。可以使用下列指令通过压缩包来安装GO依赖库。</p>
<pre><code>wget http://ory7cn4fx.bkt.clouddn.com/vendor.tar.gz
cd $GOPATH/src/github.com/nebulasio/go-nebulas
tar zxf vendor.tar.gz
</code></pre><p>安装Chrome V8依赖库</p>
<p>星云虚拟机目前依赖于Chrome的V8引擎，为了大家使用方便，我们已经为Mac OSX和Linux编译好了V8的动态库。运行如下指令就可以完成安装。</p>
<pre><code>cd $GOPATH/src/github.com/nebulasio/go-nebulas
make deploy-v8
</code></pre><p>编译可执行文件</p>
<p>完成所有上述依赖库的安装后，现在我们可以进入Go-Nebulas根目录编译星云链的可执行文件了。</p>
<pre><code>cd $GOPATH/src/github.com/nebulasio/go-nebulas
make build
</code></pre><p>编译成功后，将会看到如下信息。</p>
<p>运行星云链</p>
<p>创世区块</p>
<p>在启动一个新的星云链前，我们必须定义创世区块的配置文件。</p>
<p>创世区块配置</p>
<pre><code>meta {
  # 每条链的唯一标识
  # 每个区块和交易只会属于一条唯一的链，保证安全性
  chain_id: 100
}

consensus {
  # 在贡献度证明(PoD)被充分验证前，星云链采用DPoS共识算法
  # DPoS共识中，21个人组成一个朝代
  # 每隔一段时间都会切换朝代，每个朝代内，21个矿工轮流出块
  # 由于DPoS只是过渡方案，所以暂时不开放给公众挖矿，即当前版本朝代不会发生变更
  dpos {
    # 初始朝代，包含21个初始矿工地址
    dynasty: [
      [ miner address ],
      ...
    ]
  }
}

# 预分配的代币
token_distribution [
  {
    address: [ allocation address ]
    value: [ amount of allocation tokens ]
  },
  ...
]
</code></pre><p>可以在根目录  conf/default/genesis.conf 下，找到一个完整的创世区块配置实例。</p>
<p>配置文件</p>
<p>在我们启动一个星云节点前，我们需要定义好该节点的配置文件</p>
<p>星云节点配置文件</p>
<pre><code># 网络配置
network {
  # 对于全网第一个节点，不需要配置seed
  # 否则，其他节点启动时需要配置seed，seed节点将会把网络中其他节点的路由信息同步给刚启动的节点
  # 可以配置多个seed, [&quot;...&quot;, &quot;...&quot;]
  seed: [&quot;/ip4/127.0.0.1/tcp/8680/ipfs/QmP7HDFcYmJL12Ez4ZNVCKjKedfE7f48f1LAkUc3Whz4jP&quot;]

  # 节点监听网络消息端口，可以配置多个
  listen: [&quot;0.0.0.0:8680&quot;]

  # 网络私钥，用于确认身份节点
  # private_key: &quot;conf/network/id_ed25519&quot;
}

# 链配置
chain {
  # 链的唯一标识
  chain_id: 100

  # 数据存储地址
  datadir: &quot;data.db&quot;

  # 账户keystore文件存储地址
  keydir: &quot;keydir&quot;

  # 创世区块配置
  genesis: &quot;conf/default/genesis.conf&quot;

  # 签名算法，请勿修改
  signature_ciphers: [&quot;ECC_SECP256K1&quot;]

  # 矿工地址，矿工的keystore文件需要放置在配置的keydir下
  miner: &quot;n1XkoVVjswb5Gek3rRufqjKNpwrDdsnQ7Hq&quot;

  # Coinbase地址，该地址用于接收矿工的挖矿奖励，可以和矿工地址一致
  # 该地址的keystore无需暴露，不用放置在配置的keydir下
  coinbase: &quot;n1FF1nz6tarkDVwWQkMnnwFPuPKUaQTdptE&quot;

  # 矿工地址的密码
  passphrase: &quot;passphrase&quot;
}

# API配置
rpc {
    # GRPC服务端口
    rpc_listen: [&quot;127.0.0.1:8684&quot;]

    # HTTP服务端口
    http_listen: [&quot;127.0.0.1:8685&quot;]

    # 开放的API模块
    # API模块包含所有和用户私钥无关的接口
    # Admin模块包含所有和用户私钥相关的接口，需要慎重考虑该模块的访问权限
    http_module: [&quot;api&quot;, &quot;admin&quot;]
}

# 日志配置
app {
    # 日志级别: 支持[debug, info, warn, error, fatal]
    log_level: &quot;info&quot;

    # 日志存放位置
    log_file: &quot;logs&quot;

    # 是否打开crash report服务
    enable_crash_report: false
}

# 监控服务配置
stats {
    # 是否打开监控服务
    enable_metrics: false

    # 监控服务将数据上传到Influxdb
    # 配置Influxdb的访问信息
    influxdb: {
        host: &quot;http://localhost:8086&quot;
        db: &quot;nebulas&quot;
        user: &quot;admin&quot;
        password: &quot;admin&quot;
    }
}
</code></pre><p>A lot of examples can be found in $GOPATH/src/github.com/nebulasio/go-nebulas/conf/</p>
<p>启动星云链</p>
<p>此时启动的星云链是本地的私有链，和官方的测试网和主网没有任何相互关联</p>
<p>启动你的第一个星云节点。</p>
<pre><code>cd $GOPATH/src/github.com/nebulasio/go-nebulas
./neb -c conf/default/config.conf
</code></pre><p>启动成功的话，将会看到如下信息，有Started Neblet的日志输出。</p>
<p>默认情况下，使用配置文件conf/default/config.conf启动的节点不是矿工节点。</p>
<p>接下来，启动你的第一个矿工节点，它的seed节点即我们刚刚启动的第一个节点。</p>
<pre><code>cd $GOPATH/src/github.com/nebulasio/go-nebulas
./neb -c conf/example/miner.conf
</code></pre><p>在这个节点启动后，你会先看到如下信息，表示当前节点正在找种子节点同步。</p>
<p>等待一会儿，将会看到如下信息，表示当前节点已经连上了seed节点完成了同步。</p>
<p>再等待几分钟，你会看到如下信息，表示当前矿工节点挖出了第一个区块。</p>
<p>提示: 目前的DPoS共识算法，会有21个节点轮流出块。由于我们只启动了21个矿工节点中的一个矿工节点，所以每隔15*21s才出一个块。你可以启动更多的矿工节点，填补的空缺。但是需要注意，多个节点间的端口号不要相互冲突了。</p>
<p>声明：博客中的文章版权归博主所有，转载请注明出处，联系方式：lixuan111222(微信)</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://liguoyu.com/2018/04/17/ Go 实现AES-128加密解密/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李国玉">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李国玉区块链博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/17/ Go 实现AES-128加密解密/" itemprop="url">
                  Go 实现AES-128加密解密
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-04-17 19:35:58" itemprop="dateCreated datePublished" datetime="2018-04-17T19:35:58+08:00">2018-04-17</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-05-23 23:34:19" itemprop="dateModified" datetime="2018-05-23T23:34:19+08:00">2018-05-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>AES算法基于排列和置换运算。排列是对数据重新进行安排，置换是将一个数据单元替换为另一个。AES 使用几种不同的方法来执行排列和置换运算。  AES是一个迭代的、对称密钥分组的密码，它可以使用128、192 和 256 位密钥，并且用 128 位（16字节）分组加密和解密数据。与公共密钥密码使用密钥对不同，对称密钥密码使用相同的密钥加密和解密数据。通过分组密码返回的加密数据的位数与输入数据相同。迭代加密使用一个循环结构，在该循环中重复置换和替换输入数据。</p>
<p>加解密流程图：</p>
<p> <img src="http://a3.att.hudong.com/67/32/01300543767256145939329334463_s.jpg" alt="AES加密算法流程图"></p>
<h2 id="代码如下"><a href="#代码如下" class="headerlink" title="代码如下"></a>代码如下</h2><p><strong>使用CBC模式+PKCS7 填充方式实现AES的加密和解密</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"crypto/cipher"</span></span><br><span class="line">	<span class="string">"crypto/aes"</span></span><br><span class="line">	<span class="string">"bytes"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//AES加密解密</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//设置是要</span></span><br><span class="line">	key := []<span class="keyword">byte</span>(<span class="string">"1234567890123456"</span>)</span><br><span class="line">	<span class="comment">//明文</span></span><br><span class="line">	origData := []<span class="keyword">byte</span>(<span class="string">"hello world"</span>)</span><br><span class="line">	<span class="comment">//加密</span></span><br><span class="line">	en := AESEncrypt(origData,key)</span><br><span class="line">	<span class="comment">//解密</span></span><br><span class="line">	de := AESDecrypt(en,key)</span><br><span class="line">	fmt.Println(<span class="keyword">string</span>(de))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//解密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AESDecrypt</span><span class="params">(crypted,key []<span class="keyword">byte</span>)</span>[]<span class="title">byte</span></span>&#123;</span><br><span class="line">	block,_ := aes.NewCipher(key)</span><br><span class="line">	blockSize := block.BlockSize()</span><br><span class="line">	blockMode := cipher.NewCBCDecrypter(block,key[:blockSize])</span><br><span class="line">	origData := <span class="built_in">make</span>([]<span class="keyword">byte</span>,<span class="built_in">len</span>(crypted))</span><br><span class="line">	blockMode.CryptBlocks(origData,crypted)</span><br><span class="line">	origData = PKCS7UnPadding(origData)</span><br><span class="line">	<span class="keyword">return</span> origData</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//去补码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS7UnPadding</span><span class="params">(origData []<span class="keyword">byte</span>)</span>[]<span class="title">byte</span></span>&#123;</span><br><span class="line">	length := <span class="built_in">len</span>(origData)</span><br><span class="line">	unpadding := <span class="keyword">int</span>(origData[length<span class="number">-1</span>])</span><br><span class="line">	<span class="keyword">return</span> origData[:length-unpadding]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//加密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AESEncrypt</span><span class="params">(origData,key []<span class="keyword">byte</span>)</span>[]<span class="title">byte</span></span>&#123;</span><br><span class="line">	<span class="comment">//获取block块</span></span><br><span class="line">	block,_ :=aes.NewCipher(key)</span><br><span class="line">	<span class="comment">//补码</span></span><br><span class="line">	origData = PKCS7Padding(origData, block.BlockSize())</span><br><span class="line">	<span class="comment">//加密模式，</span></span><br><span class="line">	blockMode := cipher.NewCBCEncrypter(block,key[:block.BlockSize()])</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建明文长度的数组</span></span><br><span class="line">	crypted := <span class="built_in">make</span>([]<span class="keyword">byte</span>,<span class="built_in">len</span>(origData))</span><br><span class="line"></span><br><span class="line">	<span class="comment">//加密明文</span></span><br><span class="line">	blockMode.CryptBlocks(crypted,origData)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> crypted</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//补码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS7Padding</span><span class="params">(origData []<span class="keyword">byte</span>,blockSize <span class="keyword">int</span>)</span>[]<span class="title">byte</span></span>&#123;</span><br><span class="line">	<span class="comment">//计算需要补几位数</span></span><br><span class="line">	padding := blockSize-<span class="built_in">len</span>(origData)%blockSize</span><br><span class="line">	<span class="comment">//在切片后面追加char数量的byte(char)</span></span><br><span class="line">	padtext := bytes.Repeat([]<span class="keyword">byte</span>&#123;<span class="keyword">byte</span>(padding)&#125;,padding)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">append</span>(origData,padtext...)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://liguoyu.com/2018/04/17/ Go 实现 3DES 加密和解密/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李国玉">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李国玉区块链博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/17/ Go 实现 3DES 加密和解密/" itemprop="url">
                  Go 实现3DES加密解密
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-04-17 15:35:58" itemprop="dateCreated datePublished" datetime="2018-04-17T15:35:58+08:00">2018-04-17</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-05-23 23:33:57" itemprop="dateModified" datetime="2018-05-23T23:33:57+08:00">2018-05-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>3DES，也称Triple DES，3DES为DES向AES过渡的加密算法，它使用3条56位的密钥对数据进行三次加密。为了兼容普通的DES，3DES并没有直接使用 <code>加密-&gt;加密-&gt;加密</code> 的方式，而是采用了<code>加密-&gt;解密-&gt;加密</code> 的方式。</p>
<p><img src="http://oscd4dgpc.bkt.clouddn.com/00f3fb2538ec90b80eb9.jpg" alt=""></p>
<p>当三重密钥均相同时，前两步相互抵消，相当于仅实现了一次加密，因此可实现对普通DES加密算法的兼容。</p>
<p><img src="http://oscd4dgpc.bkt.clouddn.com/7de5d8dfcd0bd221596384.jpg" alt=""></p>
<h3 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h3><p>3DES解密过程，与加密过程相反，即逆序使用密钥。是以密钥3、密钥2、密钥1的顺序执行 <code>解密-&gt;加密-&gt;解密</code>。</p>
<p><img src="http://oscd4dgpc.bkt.clouddn.com/WX20180216-083713.png" alt=""></p>
<p>相比DES，3DES因密钥长度变长，安全性有所提高，但其处理速度不高。因此又出现了AES加密算法，AES较于3DES速度更快、安全性更高。</p>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>对比DES，3DES只是换了NewTripleDESCipher。不过，需要注意的是，密钥长度必须24byte，否则直接返回错误</p>
<p><strong>本代码采用CBC加密模式，填充方式采用PKCS5Padding</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"crypto/des"</span></span><br><span class="line">	<span class="string">"bytes"</span></span><br><span class="line">	<span class="string">"crypto/cipher"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//DES 和 3DES加密区别</span></span><br><span class="line"><span class="comment">//前者 加密  密钥必须是8byte</span></span><br><span class="line"><span class="comment">//后者加密 解密 再加密  密钥必须是24byte</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//定义密钥，必须是24byte</span></span><br><span class="line">	key := []<span class="keyword">byte</span>(<span class="string">"123456789012345678901234"</span>)</span><br><span class="line">	<span class="comment">//定义明文</span></span><br><span class="line">	origData := []<span class="keyword">byte</span>(<span class="string">"hello world"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//加密</span></span><br><span class="line">	en := ThriDESEnCrypt(origData,key)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//解密</span></span><br><span class="line">	de := ThriDESDeCrypt(en,key)</span><br><span class="line">	fmt.Println(<span class="keyword">string</span>(de))</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ThriDESDeCrypt</span><span class="params">(crypted,key []<span class="keyword">byte</span>)</span>[]<span class="title">byte</span></span>&#123;</span><br><span class="line">	<span class="comment">//获取block块</span></span><br><span class="line">	block,_ :=des.NewTripleDESCipher(key)</span><br><span class="line">	<span class="comment">//创建切片</span></span><br><span class="line">	context := <span class="built_in">make</span>([]<span class="keyword">byte</span>,<span class="built_in">len</span>(crypted))</span><br><span class="line"></span><br><span class="line">	<span class="comment">//设置解密方式</span></span><br><span class="line">	blockMode := cipher.NewCBCDecrypter(block,key[:<span class="number">8</span>])</span><br><span class="line">	<span class="comment">//解密密文到数组</span></span><br><span class="line">	blockMode.CryptBlocks(context,crypted)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//去补码</span></span><br><span class="line">	context = PKCSUnPadding(context)</span><br><span class="line">	<span class="keyword">return</span> context</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//去补码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCSUnPadding</span><span class="params">(origData []<span class="keyword">byte</span>)</span>[]<span class="title">byte</span></span>&#123;</span><br><span class="line">	length := <span class="built_in">len</span>(origData)</span><br><span class="line">	unpadding := <span class="keyword">int</span>(origData[length<span class="number">-1</span>])</span><br><span class="line">	<span class="keyword">return</span> origData[:length-unpadding]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//加密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ThriDESEnCrypt</span><span class="params">(origData,key []<span class="keyword">byte</span>)</span>[]<span class="title">byte</span></span>&#123;</span><br><span class="line">	<span class="comment">//获取block块</span></span><br><span class="line">	block,_ :=des.NewTripleDESCipher(key)</span><br><span class="line">	<span class="comment">//补码</span></span><br><span class="line">	origData = PKCSPadding(origData, block.BlockSize())</span><br><span class="line">	<span class="comment">//设置加密方式为 3DES  使用3条56位的密钥对数据进行三次加密</span></span><br><span class="line">	blockMode := cipher.NewCBCEncrypter(block,key[:<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建明文长度的数组</span></span><br><span class="line">	crypted := <span class="built_in">make</span>([]<span class="keyword">byte</span>,<span class="built_in">len</span>(origData))</span><br><span class="line"></span><br><span class="line">	<span class="comment">//加密明文</span></span><br><span class="line">	blockMode.CryptBlocks(crypted,origData)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> crypted</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//补码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCSPadding</span><span class="params">(origData []<span class="keyword">byte</span>,blockSize <span class="keyword">int</span>)</span>[]<span class="title">byte</span></span>&#123;</span><br><span class="line">	<span class="comment">//计算需要补几位数</span></span><br><span class="line">	padding := blockSize-<span class="built_in">len</span>(origData)%blockSize</span><br><span class="line">	<span class="comment">//在切片后面追加char数量的byte(char)</span></span><br><span class="line">	padtext := bytes.Repeat([]<span class="keyword">byte</span>&#123;<span class="keyword">byte</span>(padding)&#125;,padding)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">append</span>(origData,padtext...)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://liguoyu.com/2018/04/15/  Go实现DES加密解密/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李国玉">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李国玉区块链博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/15/  Go实现DES加密解密/" itemprop="url">
                  Go 实现 DES加密和解密
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-04-15 15:35:58" itemprop="dateCreated datePublished" datetime="2018-04-15T15:35:58+08:00">2018-04-15</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-05-23 23:33:25" itemprop="dateModified" datetime="2018-05-23T23:33:25+08:00">2018-05-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>DES加密算法，为对称加密算法中的一种。是以64比特的明文为一个单位来进行加密，超过64比特的数据，要求按固定的64比特的大小分组，分组有很多模式。</p>
<p><strong>DES使用的密钥长度为64比特</strong>,8 byte，但由于每隔7个比特设置一个奇偶校验位，因此其密钥长度实际为56比特。奇偶校验为最简单的错误检测码，即根据一组二进制代码中1的个数是奇数或偶数来检测错误。</p>
<h2 id="加密模式"><a href="#加密模式" class="headerlink" title="加密模式"></a>加密模式</h2><ul>
<li>ECB模式 全称Electronic Codebook模式，译为电子密码本模式</li>
<li>CBC模式 全称Cipher Block Chaining模式，译为密文分组链接模式</li>
<li>CFB模式 全称Cipher FeedBack模式，译为密文反馈模式</li>
<li>OFB模式 全称Output Feedback模式，译为输出反馈模式。</li>
<li>CTR模式 全称Counter模式，译为计数器模式。</li>
</ul>
<h2 id="填充方式"><a href="#填充方式" class="headerlink" title="填充方式"></a>填充方式</h2><p>当明文长度不为分组长度的整数倍时，需要在最后一个分组中填充一些数据使其凑满一个分组长度。</p>
<ul>
<li>NoPadding<br>API或算法本身不对数据进行处理，加密数据由加密双方约定填补算法。例如若对字符串数据进行加解密，可以补充\0或者空格，然后trim </li>
<li>PKCS5Padding<br>加密前：数据字节长度对8取余，余数为m，若m&gt;0,则补足8-m个字节，字节数值为8-m，即差几个字节就补几个字节，字节数值即为补充的字节数，若为0则补充8个字节的8<br>解密后：取最后一个字节，值为m，则从数据尾部删除m个字节，剩余数据即为加密前的原文。<br>加密字符串为为AAA，则补位为AAA55555;加密字符串为BBBBBB，则补位为BBBBBB22；加密字符串为CCCCCCCC，则补位为CCCCCCCC88888888。</li>
<li>PKCS7Padding<br>PKCS7Padding 的填充方式和PKCS5Padding 填充方式一样。只是加密块的字节数不同。PKCS5Padding明确定义了加密块是8字节，PKCS7Padding加密快可以是1-255之间。</li>
</ul>
<p>以下是go 实现的DES加密和解密代码：</p>
<p><strong>以下代码主要采用CBC加密模式 填充方式为PKCS5Padding</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"crypto/des"</span></span><br><span class="line">	<span class="string">"bytes"</span></span><br><span class="line">	<span class="string">"crypto/cipher"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"encoding/base64"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//DES加密方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">MyDESEncrypt</span> <span class="params">(origData,key []<span class="keyword">byte</span>)</span></span>&#123;</span><br><span class="line">	<span class="comment">//将字节秘钥转换成block快</span></span><br><span class="line">	block,_ := des.NewCipher(key)</span><br><span class="line">	<span class="comment">//对明文先进行补码操作</span></span><br><span class="line">	origData = PKCS5Padding(origData,block.BlockSize())</span><br><span class="line">	<span class="comment">//设置加密方式</span></span><br><span class="line">	blockMode := cipher.NewCBCEncrypter(block,key)</span><br><span class="line">	<span class="comment">//创建明文长度的字节数组</span></span><br><span class="line">	crypted := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(origData))</span><br><span class="line">	<span class="comment">//加密明文,加密后的数据放到数组中</span></span><br><span class="line">	blockMode.CryptBlocks(crypted,origData)</span><br><span class="line">	<span class="comment">//将字节数组转换成字符串</span></span><br><span class="line">	fmt.Println(base64.StdEncoding.EncodeToString(crypted))</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//实现明文的补码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS5Padding</span><span class="params">(ciphertext []<span class="keyword">byte</span>, blockSize <span class="keyword">int</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">	<span class="comment">//计算出需要补多少位</span></span><br><span class="line">	padding := blockSize - <span class="built_in">len</span>(ciphertext)%blockSize</span><br><span class="line">	<span class="comment">//Repeat()函数的功能是把参数一 切片复制 参数二count个,然后合成一个新的字节切片返回</span></span><br><span class="line">	<span class="comment">// 需要补padding位的padding值</span></span><br><span class="line">	padtext := bytes.Repeat([]<span class="keyword">byte</span>&#123;<span class="keyword">byte</span>(padding)&#125;, padding)</span><br><span class="line">	<span class="comment">//把补充的内容拼接到明文后面</span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">append</span>(ciphertext,padtext...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//解密</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">MyDESDecrypt</span><span class="params">(data <span class="keyword">string</span>, key []<span class="keyword">byte</span>)</span></span> &#123;</span><br><span class="line">	<span class="comment">//倒叙执行一遍加密方法</span></span><br><span class="line">	<span class="comment">//将字符串转换成字节数组</span></span><br><span class="line">	crypted,_ := base64.StdEncoding.DecodeString(data)</span><br><span class="line">	<span class="comment">//将字节秘钥转换成block快</span></span><br><span class="line">	block, _ := des.NewCipher(key)</span><br><span class="line">	<span class="comment">//设置解密方式</span></span><br><span class="line">	blockMode := cipher.NewCBCDecrypter(block,key)</span><br><span class="line">	<span class="comment">//创建密文大小的数组变量</span></span><br><span class="line">	origData := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(crypted))</span><br><span class="line">	<span class="comment">//解密密文到数组origData中</span></span><br><span class="line">	blockMode.CryptBlocks(origData,crypted)</span><br><span class="line">	<span class="comment">//去补码</span></span><br><span class="line">	origData = PKCS5UnPadding(origData)</span><br><span class="line">	<span class="comment">//打印明文</span></span><br><span class="line">	fmt.Println(<span class="keyword">string</span>(origData))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//去除补码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS5UnPadding</span><span class="params">(origData []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">	length := <span class="built_in">len</span>(origData)</span><br><span class="line">	<span class="comment">// 去掉最后一个字节 unpadding 次</span></span><br><span class="line">	unpadding := <span class="keyword">int</span>(origData[length<span class="number">-1</span>])</span><br><span class="line">	<span class="comment">//解密去补码时需取最后一个字节，值为m，则从数据尾部删除m个字节，剩余数据即为加密前的原文</span></span><br><span class="line">	<span class="keyword">return</span> origData[:(length - unpadding)]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span> <span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义明文</span></span><br><span class="line">	data := []<span class="keyword">byte</span>(<span class="string">"hello world"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//密钥</span></span><br><span class="line">	key := []<span class="keyword">byte</span>(<span class="string">"12345678"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//加密</span></span><br><span class="line">	MyDESEncrypt(data,key)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//解密</span></span><br><span class="line">	MyDESDecrypt(<span class="string">"CyqS6B+0nOGkMmaqyup7gQ=="</span>,key)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中解密只需把加密过程倒叙走一遍。</p>
<p><img src="http://p8ghkzll5.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-05-16%20%E4%B8%8B%E5%8D%8811.13.08.png" alt="DES"></p>
<h3 id="关于明文补码和去补码操作："><a href="#关于明文补码和去补码操作：" class="headerlink" title="关于明文补码和去补码操作："></a>关于明文补码和去补码操作：</h3><p>加密前明文补码规则 （cipher.NewCBCEncrypter 调用前操作）：</p>
<p>加密前：比如数据字节长度对8（这里的8只是举例说明，代码中使用 block.BlockSize() ）取余，余数为m，若m&gt;0,则补足8-m个字节，字节数值为8-m，即差几个字节就补几个字节，字节数值即为补充的字节数，若为0则补充8个字节的8 </p>
<p>对应的明文补码代码部分：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实现明文的补码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS5Padding</span><span class="params">(ciphertext []<span class="keyword">byte</span>, blockSize <span class="keyword">int</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">	<span class="comment">//计算出需要补多少位</span></span><br><span class="line">	padding := blockSize - <span class="built_in">len</span>(ciphertext)%blockSize</span><br><span class="line">	<span class="comment">//Repeat()函数的功能是把参数一 切片复制 参数二count个,然后合成一个新的字节切片返回</span></span><br><span class="line">	<span class="comment">// 需要补padding位的padding值</span></span><br><span class="line">	padtext := bytes.Repeat([]<span class="keyword">byte</span>&#123;<span class="keyword">byte</span>(padding)&#125;, padding)</span><br><span class="line">	<span class="comment">//把补充的内容拼接到明文后面</span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">append</span>(ciphertext,padtext...)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>解密后去除补码规则（cipher.NewCBCDecrypter调用解密完成后）：</p>
<p>解密后：取最后一个字节，值为m，则从数据尾部删除m个字节，剩余数据即为加密前的原文。</p>
<p>对应的去补码代码部分：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//去除补码</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS5UnPadding</span><span class="params">(origData []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">	length := <span class="built_in">len</span>(origData)</span><br><span class="line">	<span class="comment">// 去掉最后一个字节 unpadding 次</span></span><br><span class="line">	unpadding := <span class="keyword">int</span>(origData[length<span class="number">-1</span>])</span><br><span class="line">	<span class="comment">//解密去补码时需取最后一个字节，值为m，则从数据尾部删除m个字节，剩余数据即为加密前的原文</span></span><br><span class="line">	<span class="keyword">return</span> origData[:(length - unpadding)]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://liguoyu.com/2018/04/13/MD5加密算法原理及其GO语言实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李国玉">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李国玉区块链博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/13/MD5加密算法原理及其GO语言实现/" itemprop="url">
                  MD5加密算法原理及其GO语言实现
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-04-13 21:35:58" itemprop="dateCreated datePublished" datetime="2018-04-13T21:35:58+08:00">2018-04-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-05-23 23:35:48" itemprop="dateModified" datetime="2018-05-23T23:35:48+08:00">2018-05-23</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>MD5讯息摘要演算法（英语：MD5 Message-Digest Algorithm），一种被广泛使用的密码杂凑函数，可以产生出一个128位元（16位元组）的散列值（hash value），用于确保信息传输完整一致。</p>
<h2 id="go-调用-md5-方法"><a href="#go-调用-md5-方法" class="headerlink" title="go 调用 md5 方法"></a>go 调用 md5 方法</h2><p>新建 <code>md5.go</code> 文件，代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import(</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;crypto/md5&quot;</span><br><span class="line">	&quot;encoding/hex&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main()&#123;</span><br><span class="line">	data := []byte(&quot;hello world&quot;)</span><br><span class="line">    s := fmt.Sprintf(&quot;%x&quot;, md5.Sum(data))</span><br><span class="line">    fmt.Println(s)</span><br><span class="line"></span><br><span class="line">    // 也可以用这种方式</span><br><span class="line">    h := md5.New()</span><br><span class="line">    h.Write(data)</span><br><span class="line">    s = hex.EncodeToString(h.Sum(nil))</span><br><span class="line">    fmt.Println(s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>运行结果</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">go run md5.go</span><br><span class="line"></span><br><span class="line">//运行结果</span><br><span class="line">5eb63bbbe01eeed093cb22bb8f5acdc3</span><br><span class="line">5eb63bbbe01eeed093cb22bb8f5acdc3</span><br></pre></td></tr></table></figure>
<h2 id="md5-实现原理"><a href="#md5-实现原理" class="headerlink" title="md5 实现原理"></a>md5 实现原理</h2><p>对MD5算法简要的叙述可以为：MD5以512位分组来处理输入的信息，且每一分组又被划分为16个32位子分组，经过了一系列的处理后，算法的输出由四个32位分组组成，将这四个32位分组级联后将生成一个128位散列值。</p>
<ol>
<li><p><strong>填充</strong>：如果输入信息的长度(bit)对512求余的结果不等于448，就需要填充使得对512求余的结果等于448。填充的方法是填充一个1和n个0。填充完后，信息的长度就为N*512+448(bit)；</p>
</li>
<li><p><strong>记录信息长度</strong>：用64位来存储填充前信息长度。这64位加在第一步结果的后面，这样信息长度就变为N*512+448+64=(N+1)*512位。</p>
</li>
<li><p><strong>装入标准的幻数（四个整数）</strong>：标准的幻数（物理顺序）是（A=(01234567)16，B=(89ABCDEF)16，C=(FEDCBA98)16，D=(76543210)16）。如果在程序中定义应该是（A=0X67452301，B=0XEFCDAB89，C=0X98BADCFE，D=0X10325476）</p>
</li>
<li><p>四轮循环运算：循环的次数是分组的个数（N+1） </p>
<ul>
<li>将每一512字节细分成16个小组，每个小组64位（8个字节）</li>
<li>先认识四个线性函数(&amp;是与,|是或,^是异或)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">F(X,Y,Z)=(Y ^ Z) &amp; X) ^ Z  </span><br><span class="line">G(X,Y,Z)=((X ^ Y) &amp; Z) ^ Y  </span><br><span class="line">H(X,Y,Z)=X ^ Y ^ Z  </span><br><span class="line">I(X,Y,Z)=Y ^ (X | ^Z)</span><br></pre></td></tr></table></figure>
<ul>
<li>设Mj表示消息的第j个子分组（从0到15），&lt;&lt;&lt;s表示循环左移s位，则四种操作为：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FF(a,b,c,d,Mj,s,ti)表示a=b+((a+F(b,c,d)+Mj+ti)&lt;&lt;&lt;s)</span><br><span class="line">GG(a,b,c,d,Mj,s,ti)表示a=b+((a+G(b,c,d)+Mj+ti)&lt;&lt;&lt;s)</span><br><span class="line">HH(a,b,c,d,Mj,s,ti)表示a=b+((a+H(b,c,d)+Mj+ti)&lt;&lt;&lt;s)</span><br><span class="line">II(a,b,c,d,Mj,s,ti)表示a=b+((a+I(b,c,d)+Mj+ti)&lt;&lt;&lt;s)</span><br></pre></td></tr></table></figure>
<ul>
<li>四轮运算</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line">// Round 1.</span><br><span class="line"></span><br><span class="line">	a += (((c ^ d) &amp; b) ^ d) + X[0] + 3614090360</span><br><span class="line">	a = a&lt;&lt;7 | a&gt;&gt;(32-7) + b</span><br><span class="line"></span><br><span class="line">	d += (((b ^ c) &amp; a) ^ c) + X[1] + 3905402710</span><br><span class="line">	d = d&lt;&lt;12 | d&gt;&gt;(32-12) + a</span><br><span class="line"></span><br><span class="line">	c += (((a ^ b) &amp; d) ^ b) + X[2] + 606105819</span><br><span class="line">	c = c&lt;&lt;17 | c&gt;&gt;(32-17) + d</span><br><span class="line"></span><br><span class="line">	b += (((d ^ a) &amp; c) ^ a) + X[3] + 3250441966</span><br><span class="line">	b = b&lt;&lt;22 | b&gt;&gt;(32-22) + c</span><br><span class="line"></span><br><span class="line">	a += (((c ^ d) &amp; b) ^ d) + X[4] + 4118548399</span><br><span class="line">	a = a&lt;&lt;7 | a&gt;&gt;(32-7) + b</span><br><span class="line"></span><br><span class="line">	d += (((b ^ c) &amp; a) ^ c) + X[5] + 1200080426</span><br><span class="line">	d = d&lt;&lt;12 | d&gt;&gt;(32-12) + a</span><br><span class="line"></span><br><span class="line">	c += (((a ^ b) &amp; d) ^ b) + X[6] + 2821735955</span><br><span class="line">	c = c&lt;&lt;17 | c&gt;&gt;(32-17) + d</span><br><span class="line"></span><br><span class="line">	b += (((d ^ a) &amp; c) ^ a) + X[7] + 4249261313</span><br><span class="line">	b = b&lt;&lt;22 | b&gt;&gt;(32-22) + c</span><br><span class="line"></span><br><span class="line">	a += (((c ^ d) &amp; b) ^ d) + X[8] + 1770035416</span><br><span class="line">	a = a&lt;&lt;7 | a&gt;&gt;(32-7) + b</span><br><span class="line"></span><br><span class="line">	d += (((b ^ c) &amp; a) ^ c) + X[9] + 2336552879</span><br><span class="line">	d = d&lt;&lt;12 | d&gt;&gt;(32-12) + a</span><br><span class="line"></span><br><span class="line">	c += (((a ^ b) &amp; d) ^ b) + X[10] + 4294925233</span><br><span class="line">	c = c&lt;&lt;17 | c&gt;&gt;(32-17) + d</span><br><span class="line"></span><br><span class="line">	b += (((d ^ a) &amp; c) ^ a) + X[11] + 2304563134</span><br><span class="line">	b = b&lt;&lt;22 | b&gt;&gt;(32-22) + c</span><br><span class="line"></span><br><span class="line">	a += (((c ^ d) &amp; b) ^ d) + X[12] + 1804603682</span><br><span class="line">	a = a&lt;&lt;7 | a&gt;&gt;(32-7) + b</span><br><span class="line"></span><br><span class="line">	d += (((b ^ c) &amp; a) ^ c) + X[13] + 4254626195</span><br><span class="line">	d = d&lt;&lt;12 | d&gt;&gt;(32-12) + a</span><br><span class="line"></span><br><span class="line">	c += (((a ^ b) &amp; d) ^ b) + X[14] + 2792965006</span><br><span class="line">	c = c&lt;&lt;17 | c&gt;&gt;(32-17) + d</span><br><span class="line"></span><br><span class="line">	b += (((d ^ a) &amp; c) ^ a) + X[15] + 1236535329</span><br><span class="line">	b = b&lt;&lt;22 | b&gt;&gt;(32-22) + c</span><br><span class="line"></span><br><span class="line">	// Round 2.</span><br><span class="line"></span><br><span class="line">	a += (((b ^ c) &amp; d) ^ c) + X[(1+5*0)&amp;15] + 4129170786</span><br><span class="line">	a = a&lt;&lt;5 | a&gt;&gt;(32-5) + b</span><br><span class="line"></span><br><span class="line">	d += (((a ^ b) &amp; c) ^ b) + X[(1+5*1)&amp;15] + 3225465664</span><br><span class="line">	d = d&lt;&lt;9 | d&gt;&gt;(32-9) + a</span><br><span class="line"></span><br><span class="line">	c += (((d ^ a) &amp; b) ^ a) + X[(1+5*2)&amp;15] + 643717713</span><br><span class="line">	c = c&lt;&lt;14 | c&gt;&gt;(32-14) + d</span><br><span class="line"></span><br><span class="line">	b += (((c ^ d) &amp; a) ^ d) + X[(1+5*3)&amp;15] + 3921069994</span><br><span class="line">	b = b&lt;&lt;20 | b&gt;&gt;(32-20) + c</span><br><span class="line"></span><br><span class="line">	a += (((b ^ c) &amp; d) ^ c) + X[(1+5*4)&amp;15] + 3593408605</span><br><span class="line">	a = a&lt;&lt;5 | a&gt;&gt;(32-5) + b</span><br><span class="line"></span><br><span class="line">	d += (((a ^ b) &amp; c) ^ b) + X[(1+5*5)&amp;15] + 38016083</span><br><span class="line">	d = d&lt;&lt;9 | d&gt;&gt;(32-9) + a</span><br><span class="line"></span><br><span class="line">	c += (((d ^ a) &amp; b) ^ a) + X[(1+5*6)&amp;15] + 3634488961</span><br><span class="line">	c = c&lt;&lt;14 | c&gt;&gt;(32-14) + d</span><br><span class="line"></span><br><span class="line">	b += (((c ^ d) &amp; a) ^ d) + X[(1+5*7)&amp;15] + 3889429448</span><br><span class="line">	b = b&lt;&lt;20 | b&gt;&gt;(32-20) + c</span><br><span class="line"></span><br><span class="line">	a += (((b ^ c) &amp; d) ^ c) + X[(1+5*8)&amp;15] + 568446438</span><br><span class="line">	a = a&lt;&lt;5 | a&gt;&gt;(32-5) + b</span><br><span class="line"></span><br><span class="line">	d += (((a ^ b) &amp; c) ^ b) + X[(1+5*9)&amp;15] + 3275163606</span><br><span class="line">	d = d&lt;&lt;9 | d&gt;&gt;(32-9) + a</span><br><span class="line"></span><br><span class="line">	c += (((d ^ a) &amp; b) ^ a) + X[(1+5*10)&amp;15] + 4107603335</span><br><span class="line">	c = c&lt;&lt;14 | c&gt;&gt;(32-14) + d</span><br><span class="line"></span><br><span class="line">	b += (((c ^ d) &amp; a) ^ d) + X[(1+5*11)&amp;15] + 1163531501</span><br><span class="line">	b = b&lt;&lt;20 | b&gt;&gt;(32-20) + c</span><br><span class="line"></span><br><span class="line">	a += (((b ^ c) &amp; d) ^ c) + X[(1+5*12)&amp;15] + 2850285829</span><br><span class="line">	a = a&lt;&lt;5 | a&gt;&gt;(32-5) + b</span><br><span class="line"></span><br><span class="line">	d += (((a ^ b) &amp; c) ^ b) + X[(1+5*13)&amp;15] + 4243563512</span><br><span class="line">	d = d&lt;&lt;9 | d&gt;&gt;(32-9) + a</span><br><span class="line"></span><br><span class="line">	c += (((d ^ a) &amp; b) ^ a) + X[(1+5*14)&amp;15] + 1735328473</span><br><span class="line">	c = c&lt;&lt;14 | c&gt;&gt;(32-14) + d</span><br><span class="line"></span><br><span class="line">	b += (((c ^ d) &amp; a) ^ d) + X[(1+5*15)&amp;15] + 2368359562</span><br><span class="line">	b = b&lt;&lt;20 | b&gt;&gt;(32-20) + c</span><br><span class="line"></span><br><span class="line">	// Round 3.</span><br><span class="line"></span><br><span class="line">	a += (b ^ c ^ d) + X[(5+3*0)&amp;15] + 4294588738</span><br><span class="line">	a = a&lt;&lt;4 | a&gt;&gt;(32-4) + b</span><br><span class="line"></span><br><span class="line">	d += (a ^ b ^ c) + X[(5+3*1)&amp;15] + 2272392833</span><br><span class="line">	d = d&lt;&lt;11 | d&gt;&gt;(32-11) + a</span><br><span class="line"></span><br><span class="line">	c += (d ^ a ^ b) + X[(5+3*2)&amp;15] + 1839030562</span><br><span class="line">	c = c&lt;&lt;16 | c&gt;&gt;(32-16) + d</span><br><span class="line"></span><br><span class="line">	b += (c ^ d ^ a) + X[(5+3*3)&amp;15] + 4259657740</span><br><span class="line">	b = b&lt;&lt;23 | b&gt;&gt;(32-23) + c</span><br><span class="line"></span><br><span class="line">	a += (b ^ c ^ d) + X[(5+3*4)&amp;15] + 2763975236</span><br><span class="line">	a = a&lt;&lt;4 | a&gt;&gt;(32-4) + b</span><br><span class="line"></span><br><span class="line">	d += (a ^ b ^ c) + X[(5+3*5)&amp;15] + 1272893353</span><br><span class="line">	d = d&lt;&lt;11 | d&gt;&gt;(32-11) + a</span><br><span class="line"></span><br><span class="line">	c += (d ^ a ^ b) + X[(5+3*6)&amp;15] + 4139469664</span><br><span class="line">	c = c&lt;&lt;16 | c&gt;&gt;(32-16) + d</span><br><span class="line"></span><br><span class="line">	b += (c ^ d ^ a) + X[(5+3*7)&amp;15] + 3200236656</span><br><span class="line">	b = b&lt;&lt;23 | b&gt;&gt;(32-23) + c</span><br><span class="line"></span><br><span class="line">	a += (b ^ c ^ d) + X[(5+3*8)&amp;15] + 681279174</span><br><span class="line">	a = a&lt;&lt;4 | a&gt;&gt;(32-4) + b</span><br><span class="line"></span><br><span class="line">	d += (a ^ b ^ c) + X[(5+3*9)&amp;15] + 3936430074</span><br><span class="line">	d = d&lt;&lt;11 | d&gt;&gt;(32-11) + a</span><br><span class="line"></span><br><span class="line">	c += (d ^ a ^ b) + X[(5+3*10)&amp;15] + 3572445317</span><br><span class="line">	c = c&lt;&lt;16 | c&gt;&gt;(32-16) + d</span><br><span class="line"></span><br><span class="line">	b += (c ^ d ^ a) + X[(5+3*11)&amp;15] + 76029189</span><br><span class="line">	b = b&lt;&lt;23 | b&gt;&gt;(32-23) + c</span><br><span class="line"></span><br><span class="line">	a += (b ^ c ^ d) + X[(5+3*12)&amp;15] + 3654602809</span><br><span class="line">	a = a&lt;&lt;4 | a&gt;&gt;(32-4) + b</span><br><span class="line"></span><br><span class="line">	d += (a ^ b ^ c) + X[(5+3*13)&amp;15] + 3873151461</span><br><span class="line">	d = d&lt;&lt;11 | d&gt;&gt;(32-11) + a</span><br><span class="line"></span><br><span class="line">	c += (d ^ a ^ b) + X[(5+3*14)&amp;15] + 530742520</span><br><span class="line">	c = c&lt;&lt;16 | c&gt;&gt;(32-16) + d</span><br><span class="line"></span><br><span class="line">	b += (c ^ d ^ a) + X[(5+3*15)&amp;15] + 3299628645</span><br><span class="line">	b = b&lt;&lt;23 | b&gt;&gt;(32-23) + c</span><br><span class="line"></span><br><span class="line">	// Round 4.</span><br><span class="line"></span><br><span class="line">	a += (c ^ (b | ^d)) + X[(7*0)&amp;15] + 4096336452</span><br><span class="line">	a = a&lt;&lt;6 | a&gt;&gt;(32-6) + b</span><br><span class="line"></span><br><span class="line">	d += (b ^ (a | ^c)) + X[(7*1)&amp;15] + 1126891415</span><br><span class="line">	d = d&lt;&lt;10 | d&gt;&gt;(32-10) + a</span><br><span class="line"></span><br><span class="line">	c += (a ^ (d | ^b)) + X[(7*2)&amp;15] + 2878612391</span><br><span class="line">	c = c&lt;&lt;15 | c&gt;&gt;(32-15) + d</span><br><span class="line"></span><br><span class="line">	b += (d ^ (c | ^a)) + X[(7*3)&amp;15] + 4237533241</span><br><span class="line">	b = b&lt;&lt;21 | b&gt;&gt;(32-21) + c</span><br><span class="line"></span><br><span class="line">	a += (c ^ (b | ^d)) + X[(7*4)&amp;15] + 1700485571</span><br><span class="line">	a = a&lt;&lt;6 | a&gt;&gt;(32-6) + b</span><br><span class="line"></span><br><span class="line">	d += (b ^ (a | ^c)) + X[(7*5)&amp;15] + 2399980690</span><br><span class="line">	d = d&lt;&lt;10 | d&gt;&gt;(32-10) + a</span><br><span class="line"></span><br><span class="line">	c += (a ^ (d | ^b)) + X[(7*6)&amp;15] + 4293915773</span><br><span class="line">	c = c&lt;&lt;15 | c&gt;&gt;(32-15) + d</span><br><span class="line"></span><br><span class="line">	b += (d ^ (c | ^a)) + X[(7*7)&amp;15] + 2240044497</span><br><span class="line">	b = b&lt;&lt;21 | b&gt;&gt;(32-21) + c</span><br><span class="line"></span><br><span class="line">	a += (c ^ (b | ^d)) + X[(7*8)&amp;15] + 1873313359</span><br><span class="line">	a = a&lt;&lt;6 | a&gt;&gt;(32-6) + b</span><br><span class="line"></span><br><span class="line">	d += (b ^ (a | ^c)) + X[(7*9)&amp;15] + 4264355552</span><br><span class="line">	d = d&lt;&lt;10 | d&gt;&gt;(32-10) + a</span><br><span class="line"></span><br><span class="line">	c += (a ^ (d | ^b)) + X[(7*10)&amp;15] + 2734768916</span><br><span class="line">	c = c&lt;&lt;15 | c&gt;&gt;(32-15) + d</span><br><span class="line"></span><br><span class="line">	b += (d ^ (c | ^a)) + X[(7*11)&amp;15] + 1309151649</span><br><span class="line">	b = b&lt;&lt;21 | b&gt;&gt;(32-21) + c</span><br><span class="line"></span><br><span class="line">	a += (c ^ (b | ^d)) + X[(7*12)&amp;15] + 4149444226</span><br><span class="line">	a = a&lt;&lt;6 | a&gt;&gt;(32-6) + b</span><br><span class="line"></span><br><span class="line">	d += (b ^ (a | ^c)) + X[(7*13)&amp;15] + 3174756917</span><br><span class="line">	d = d&lt;&lt;10 | d&gt;&gt;(32-10) + a</span><br><span class="line"></span><br><span class="line">	c += (a ^ (d | ^b)) + X[(7*14)&amp;15] + 718787259</span><br><span class="line">	c = c&lt;&lt;15 | c&gt;&gt;(32-15) + d</span><br><span class="line"></span><br><span class="line">	b += (d ^ (c | ^a)) + X[(7*15)&amp;15] + 3951481745</span><br><span class="line">	b = b&lt;&lt;21 | b&gt;&gt;(32-21) + c</span><br></pre></td></tr></table></figure>
<ul>
<li>每轮循环后，将A，B，C，D分别加上a，b，c，d，然后进入下一循环。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a += A</span><br><span class="line">b += B</span><br><span class="line">c += C</span><br><span class="line">d += D</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import(</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;unsafe&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">const Size = 16</span><br><span class="line"></span><br><span class="line">const (</span><br><span class="line">	chunk = 64</span><br><span class="line">	init0 = 0x67452301</span><br><span class="line">	init1 = 0xEFCDAB89</span><br><span class="line">	init2 = 0x98BADCFE</span><br><span class="line">	init3 = 0x10325476</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">// digest represents the partial evaluation of a checksum.</span><br><span class="line">type digest struct &#123;</span><br><span class="line">	s   [4]uint32</span><br><span class="line">	x   [chunk]byte</span><br><span class="line">	nx  int</span><br><span class="line">	len uint64</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (d *digest) Reset() &#123;</span><br><span class="line">	d.s[0] = init0</span><br><span class="line">	d.s[1] = init1</span><br><span class="line">	d.s[2] = init2</span><br><span class="line">	d.s[3] = init3</span><br><span class="line">	d.nx = 0</span><br><span class="line">	d.len = 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (d *digest) Write(p []byte) (nn int, err error) &#123;</span><br><span class="line">	nn = len(p)</span><br><span class="line">	d.len += uint64(nn)</span><br><span class="line">	if d.nx &gt; 0 &#123;</span><br><span class="line">		n := copy(d.x[d.nx:], p)</span><br><span class="line">		d.nx += n</span><br><span class="line">		if d.nx == chunk &#123;</span><br><span class="line">			blockGeneric(d, d.x[:])</span><br><span class="line">			d.nx = 0</span><br><span class="line">		&#125;</span><br><span class="line">		p = p[n:]</span><br><span class="line">	&#125;</span><br><span class="line">	if len(p) &gt;= chunk &#123;</span><br><span class="line">		n := len(p) &amp;^ (chunk - 1)</span><br><span class="line">		blockGeneric(d, p[:n])</span><br><span class="line">		p = p[n:]</span><br><span class="line">	&#125;</span><br><span class="line">	if len(p) &gt; 0 &#123;</span><br><span class="line">		d.nx = copy(d.x[:], p)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Printf(&quot;%v\n&quot;,d)</span><br><span class="line"></span><br><span class="line">	return</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (d *digest) checkSum() [Size]byte &#123;</span><br><span class="line">	// Padding. Add a 1 bit and 0 bits until 56 bytes mod 64.</span><br><span class="line">	len := d.len</span><br><span class="line">	var tmp [64]byte</span><br><span class="line">	tmp[0] = 0x80</span><br><span class="line">	if len%64 &lt; 56 &#123;</span><br><span class="line">		d.Write(tmp[0 : 56-len%64])</span><br><span class="line">		fmt.Printf(&quot;%v&quot;,d)</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		d.Write(tmp[0 : 64+56-len%64])</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	// Length in bits.</span><br><span class="line">	len &lt;&lt;= 3</span><br><span class="line">	for i := uint(0); i &lt; 8; i++ &#123;</span><br><span class="line">		tmp[i] = byte(len &gt;&gt; (8 * i))</span><br><span class="line">	&#125;</span><br><span class="line">	d.Write(tmp[0:8])</span><br><span class="line"></span><br><span class="line">	if d.nx != 0 &#123;</span><br><span class="line">		panic(&quot;d.nx != 0&quot;)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	var digest [Size]byte</span><br><span class="line">	for i, s := range d.s &#123;</span><br><span class="line">		digest[i*4] = byte(s)</span><br><span class="line">		digest[i*4+1] = byte(s &gt;&gt; 8)</span><br><span class="line">		digest[i*4+2] = byte(s &gt;&gt; 16)</span><br><span class="line">		digest[i*4+3] = byte(s &gt;&gt; 24)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	return digest</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func blockGeneric(dig *digest, p []byte) &#123;</span><br><span class="line">	a := dig.s[0]</span><br><span class="line">	b := dig.s[1]</span><br><span class="line">	c := dig.s[2]</span><br><span class="line">	d := dig.s[3]</span><br><span class="line">	var X *[16]uint32</span><br><span class="line">	for len(p) &gt;= chunk &#123;</span><br><span class="line">		aa, bb, cc, dd := a, b, c, d</span><br><span class="line"></span><br><span class="line">		X = (*[16]uint32)(unsafe.Pointer(&amp;p[0]))</span><br><span class="line"></span><br><span class="line">		// Round 1.</span><br><span class="line"></span><br><span class="line">		a += (((c ^ d) &amp; b) ^ d) + X[0] + 3614090360</span><br><span class="line">		a = a&lt;&lt;7 | a&gt;&gt;(32-7) + b</span><br><span class="line"></span><br><span class="line">		d += (((b ^ c) &amp; a) ^ c) + X[1] + 3905402710</span><br><span class="line">		d = d&lt;&lt;12 | d&gt;&gt;(32-12) + a</span><br><span class="line"></span><br><span class="line">		c += (((a ^ b) &amp; d) ^ b) + X[2] + 606105819</span><br><span class="line">		c = c&lt;&lt;17 | c&gt;&gt;(32-17) + d</span><br><span class="line"></span><br><span class="line">		b += (((d ^ a) &amp; c) ^ a) + X[3] + 3250441966</span><br><span class="line">		b = b&lt;&lt;22 | b&gt;&gt;(32-22) + c</span><br><span class="line"></span><br><span class="line">		a += (((c ^ d) &amp; b) ^ d) + X[4] + 4118548399</span><br><span class="line">		a = a&lt;&lt;7 | a&gt;&gt;(32-7) + b</span><br><span class="line"></span><br><span class="line">		d += (((b ^ c) &amp; a) ^ c) + X[5] + 1200080426</span><br><span class="line">		d = d&lt;&lt;12 | d&gt;&gt;(32-12) + a</span><br><span class="line"></span><br><span class="line">		c += (((a ^ b) &amp; d) ^ b) + X[6] + 2821735955</span><br><span class="line">		c = c&lt;&lt;17 | c&gt;&gt;(32-17) + d</span><br><span class="line"></span><br><span class="line">		b += (((d ^ a) &amp; c) ^ a) + X[7] + 4249261313</span><br><span class="line">		b = b&lt;&lt;22 | b&gt;&gt;(32-22) + c</span><br><span class="line"></span><br><span class="line">		a += (((c ^ d) &amp; b) ^ d) + X[8] + 1770035416</span><br><span class="line">		a = a&lt;&lt;7 | a&gt;&gt;(32-7) + b</span><br><span class="line"></span><br><span class="line">		d += (((b ^ c) &amp; a) ^ c) + X[9] + 2336552879</span><br><span class="line">		d = d&lt;&lt;12 | d&gt;&gt;(32-12) + a</span><br><span class="line"></span><br><span class="line">		c += (((a ^ b) &amp; d) ^ b) + X[10] + 4294925233</span><br><span class="line">		c = c&lt;&lt;17 | c&gt;&gt;(32-17) + d</span><br><span class="line"></span><br><span class="line">		b += (((d ^ a) &amp; c) ^ a) + X[11] + 2304563134</span><br><span class="line">		b = b&lt;&lt;22 | b&gt;&gt;(32-22) + c</span><br><span class="line"></span><br><span class="line">		a += (((c ^ d) &amp; b) ^ d) + X[12] + 1804603682</span><br><span class="line">		a = a&lt;&lt;7 | a&gt;&gt;(32-7) + b</span><br><span class="line"></span><br><span class="line">		d += (((b ^ c) &amp; a) ^ c) + X[13] + 4254626195</span><br><span class="line">		d = d&lt;&lt;12 | d&gt;&gt;(32-12) + a</span><br><span class="line"></span><br><span class="line">		c += (((a ^ b) &amp; d) ^ b) + X[14] + 2792965006</span><br><span class="line">		c = c&lt;&lt;17 | c&gt;&gt;(32-17) + d</span><br><span class="line"></span><br><span class="line">		b += (((d ^ a) &amp; c) ^ a) + X[15] + 1236535329</span><br><span class="line">		b = b&lt;&lt;22 | b&gt;&gt;(32-22) + c</span><br><span class="line"></span><br><span class="line">		// Round 2.</span><br><span class="line"></span><br><span class="line">		a += (((b ^ c) &amp; d) ^ c) + X[(1+5*0)&amp;15] + 4129170786</span><br><span class="line">		a = a&lt;&lt;5 | a&gt;&gt;(32-5) + b</span><br><span class="line"></span><br><span class="line">		d += (((a ^ b) &amp; c) ^ b) + X[(1+5*1)&amp;15] + 3225465664</span><br><span class="line">		d = d&lt;&lt;9 | d&gt;&gt;(32-9) + a</span><br><span class="line"></span><br><span class="line">		c += (((d ^ a) &amp; b) ^ a) + X[(1+5*2)&amp;15] + 643717713</span><br><span class="line">		c = c&lt;&lt;14 | c&gt;&gt;(32-14) + d</span><br><span class="line"></span><br><span class="line">		b += (((c ^ d) &amp; a) ^ d) + X[(1+5*3)&amp;15] + 3921069994</span><br><span class="line">		b = b&lt;&lt;20 | b&gt;&gt;(32-20) + c</span><br><span class="line"></span><br><span class="line">		a += (((b ^ c) &amp; d) ^ c) + X[(1+5*4)&amp;15] + 3593408605</span><br><span class="line">		a = a&lt;&lt;5 | a&gt;&gt;(32-5) + b</span><br><span class="line"></span><br><span class="line">		d += (((a ^ b) &amp; c) ^ b) + X[(1+5*5)&amp;15] + 38016083</span><br><span class="line">		d = d&lt;&lt;9 | d&gt;&gt;(32-9) + a</span><br><span class="line"></span><br><span class="line">		c += (((d ^ a) &amp; b) ^ a) + X[(1+5*6)&amp;15] + 3634488961</span><br><span class="line">		c = c&lt;&lt;14 | c&gt;&gt;(32-14) + d</span><br><span class="line"></span><br><span class="line">		b += (((c ^ d) &amp; a) ^ d) + X[(1+5*7)&amp;15] + 3889429448</span><br><span class="line">		b = b&lt;&lt;20 | b&gt;&gt;(32-20) + c</span><br><span class="line"></span><br><span class="line">		a += (((b ^ c) &amp; d) ^ c) + X[(1+5*8)&amp;15] + 568446438</span><br><span class="line">		a = a&lt;&lt;5 | a&gt;&gt;(32-5) + b</span><br><span class="line"></span><br><span class="line">		d += (((a ^ b) &amp; c) ^ b) + X[(1+5*9)&amp;15] + 3275163606</span><br><span class="line">		d = d&lt;&lt;9 | d&gt;&gt;(32-9) + a</span><br><span class="line"></span><br><span class="line">		c += (((d ^ a) &amp; b) ^ a) + X[(1+5*10)&amp;15] + 4107603335</span><br><span class="line">		c = c&lt;&lt;14 | c&gt;&gt;(32-14) + d</span><br><span class="line"></span><br><span class="line">		b += (((c ^ d) &amp; a) ^ d) + X[(1+5*11)&amp;15] + 1163531501</span><br><span class="line">		b = b&lt;&lt;20 | b&gt;&gt;(32-20) + c</span><br><span class="line"></span><br><span class="line">		a += (((b ^ c) &amp; d) ^ c) + X[(1+5*12)&amp;15] + 2850285829</span><br><span class="line">		a = a&lt;&lt;5 | a&gt;&gt;(32-5) + b</span><br><span class="line"></span><br><span class="line">		d += (((a ^ b) &amp; c) ^ b) + X[(1+5*13)&amp;15] + 4243563512</span><br><span class="line">		d = d&lt;&lt;9 | d&gt;&gt;(32-9) + a</span><br><span class="line"></span><br><span class="line">		c += (((d ^ a) &amp; b) ^ a) + X[(1+5*14)&amp;15] + 1735328473</span><br><span class="line">		c = c&lt;&lt;14 | c&gt;&gt;(32-14) + d</span><br><span class="line"></span><br><span class="line">		b += (((c ^ d) &amp; a) ^ d) + X[(1+5*15)&amp;15] + 2368359562</span><br><span class="line">		b = b&lt;&lt;20 | b&gt;&gt;(32-20) + c</span><br><span class="line"></span><br><span class="line">		// Round 3.</span><br><span class="line"></span><br><span class="line">		a += (b ^ c ^ d) + X[(5+3*0)&amp;15] + 4294588738</span><br><span class="line">		a = a&lt;&lt;4 | a&gt;&gt;(32-4) + b</span><br><span class="line"></span><br><span class="line">		d += (a ^ b ^ c) + X[(5+3*1)&amp;15] + 2272392833</span><br><span class="line">		d = d&lt;&lt;11 | d&gt;&gt;(32-11) + a</span><br><span class="line"></span><br><span class="line">		c += (d ^ a ^ b) + X[(5+3*2)&amp;15] + 1839030562</span><br><span class="line">		c = c&lt;&lt;16 | c&gt;&gt;(32-16) + d</span><br><span class="line"></span><br><span class="line">		b += (c ^ d ^ a) + X[(5+3*3)&amp;15] + 4259657740</span><br><span class="line">		b = b&lt;&lt;23 | b&gt;&gt;(32-23) + c</span><br><span class="line"></span><br><span class="line">		a += (b ^ c ^ d) + X[(5+3*4)&amp;15] + 2763975236</span><br><span class="line">		a = a&lt;&lt;4 | a&gt;&gt;(32-4) + b</span><br><span class="line"></span><br><span class="line">		d += (a ^ b ^ c) + X[(5+3*5)&amp;15] + 1272893353</span><br><span class="line">		d = d&lt;&lt;11 | d&gt;&gt;(32-11) + a</span><br><span class="line"></span><br><span class="line">		c += (d ^ a ^ b) + X[(5+3*6)&amp;15] + 4139469664</span><br><span class="line">		c = c&lt;&lt;16 | c&gt;&gt;(32-16) + d</span><br><span class="line"></span><br><span class="line">		b += (c ^ d ^ a) + X[(5+3*7)&amp;15] + 3200236656</span><br><span class="line">		b = b&lt;&lt;23 | b&gt;&gt;(32-23) + c</span><br><span class="line"></span><br><span class="line">		a += (b ^ c ^ d) + X[(5+3*8)&amp;15] + 681279174</span><br><span class="line">		a = a&lt;&lt;4 | a&gt;&gt;(32-4) + b</span><br><span class="line"></span><br><span class="line">		d += (a ^ b ^ c) + X[(5+3*9)&amp;15] + 3936430074</span><br><span class="line">		d = d&lt;&lt;11 | d&gt;&gt;(32-11) + a</span><br><span class="line"></span><br><span class="line">		c += (d ^ a ^ b) + X[(5+3*10)&amp;15] + 3572445317</span><br><span class="line">		c = c&lt;&lt;16 | c&gt;&gt;(32-16) + d</span><br><span class="line"></span><br><span class="line">		b += (c ^ d ^ a) + X[(5+3*11)&amp;15] + 76029189</span><br><span class="line">		b = b&lt;&lt;23 | b&gt;&gt;(32-23) + c</span><br><span class="line"></span><br><span class="line">		a += (b ^ c ^ d) + X[(5+3*12)&amp;15] + 3654602809</span><br><span class="line">		a = a&lt;&lt;4 | a&gt;&gt;(32-4) + b</span><br><span class="line"></span><br><span class="line">		d += (a ^ b ^ c) + X[(5+3*13)&amp;15] + 3873151461</span><br><span class="line">		d = d&lt;&lt;11 | d&gt;&gt;(32-11) + a</span><br><span class="line"></span><br><span class="line">		c += (d ^ a ^ b) + X[(5+3*14)&amp;15] + 530742520</span><br><span class="line">		c = c&lt;&lt;16 | c&gt;&gt;(32-16) + d</span><br><span class="line"></span><br><span class="line">		b += (c ^ d ^ a) + X[(5+3*15)&amp;15] + 3299628645</span><br><span class="line">		b = b&lt;&lt;23 | b&gt;&gt;(32-23) + c</span><br><span class="line"></span><br><span class="line">		// Round 4.</span><br><span class="line"></span><br><span class="line">		a += (c ^ (b | ^d)) + X[(7*0)&amp;15] + 4096336452</span><br><span class="line">		a = a&lt;&lt;6 | a&gt;&gt;(32-6) + b</span><br><span class="line"></span><br><span class="line">		d += (b ^ (a | ^c)) + X[(7*1)&amp;15] + 1126891415</span><br><span class="line">		d = d&lt;&lt;10 | d&gt;&gt;(32-10) + a</span><br><span class="line"></span><br><span class="line">		c += (a ^ (d | ^b)) + X[(7*2)&amp;15] + 2878612391</span><br><span class="line">		c = c&lt;&lt;15 | c&gt;&gt;(32-15) + d</span><br><span class="line"></span><br><span class="line">		b += (d ^ (c | ^a)) + X[(7*3)&amp;15] + 4237533241</span><br><span class="line">		b = b&lt;&lt;21 | b&gt;&gt;(32-21) + c</span><br><span class="line"></span><br><span class="line">		a += (c ^ (b | ^d)) + X[(7*4)&amp;15] + 1700485571</span><br><span class="line">		a = a&lt;&lt;6 | a&gt;&gt;(32-6) + b</span><br><span class="line"></span><br><span class="line">		d += (b ^ (a | ^c)) + X[(7*5)&amp;15] + 2399980690</span><br><span class="line">		d = d&lt;&lt;10 | d&gt;&gt;(32-10) + a</span><br><span class="line"></span><br><span class="line">		c += (a ^ (d | ^b)) + X[(7*6)&amp;15] + 4293915773</span><br><span class="line">		c = c&lt;&lt;15 | c&gt;&gt;(32-15) + d</span><br><span class="line"></span><br><span class="line">		b += (d ^ (c | ^a)) + X[(7*7)&amp;15] + 2240044497</span><br><span class="line">		b = b&lt;&lt;21 | b&gt;&gt;(32-21) + c</span><br><span class="line"></span><br><span class="line">		a += (c ^ (b | ^d)) + X[(7*8)&amp;15] + 1873313359</span><br><span class="line">		a = a&lt;&lt;6 | a&gt;&gt;(32-6) + b</span><br><span class="line"></span><br><span class="line">		d += (b ^ (a | ^c)) + X[(7*9)&amp;15] + 4264355552</span><br><span class="line">		d = d&lt;&lt;10 | d&gt;&gt;(32-10) + a</span><br><span class="line"></span><br><span class="line">		c += (a ^ (d | ^b)) + X[(7*10)&amp;15] + 2734768916</span><br><span class="line">		c = c&lt;&lt;15 | c&gt;&gt;(32-15) + d</span><br><span class="line"></span><br><span class="line">		b += (d ^ (c | ^a)) + X[(7*11)&amp;15] + 1309151649</span><br><span class="line">		b = b&lt;&lt;21 | b&gt;&gt;(32-21) + c</span><br><span class="line"></span><br><span class="line">		a += (c ^ (b | ^d)) + X[(7*12)&amp;15] + 4149444226</span><br><span class="line">		a = a&lt;&lt;6 | a&gt;&gt;(32-6) + b</span><br><span class="line"></span><br><span class="line">		d += (b ^ (a | ^c)) + X[(7*13)&amp;15] + 3174756917</span><br><span class="line">		d = d&lt;&lt;10 | d&gt;&gt;(32-10) + a</span><br><span class="line"></span><br><span class="line">		c += (a ^ (d | ^b)) + X[(7*14)&amp;15] + 718787259</span><br><span class="line">		c = c&lt;&lt;15 | c&gt;&gt;(32-15) + d</span><br><span class="line"></span><br><span class="line">		b += (d ^ (c | ^a)) + X[(7*15)&amp;15] + 3951481745</span><br><span class="line">		b = b&lt;&lt;21 | b&gt;&gt;(32-21) + c</span><br><span class="line"></span><br><span class="line">		a += aa</span><br><span class="line">		b += bb</span><br><span class="line">		c += cc</span><br><span class="line">		d += dd</span><br><span class="line"></span><br><span class="line">		p = p[chunk:]</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	dig.s[0] = a</span><br><span class="line">	dig.s[1] = b</span><br><span class="line">	dig.s[2] = c</span><br><span class="line">	dig.s[3] = d</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	var d digest</span><br><span class="line">	d.Reset()</span><br><span class="line">	data := []byte(&quot;hello world&quot;)</span><br><span class="line"></span><br><span class="line">	d.Write(data)</span><br><span class="line"></span><br><span class="line">	hashnum := d.checkSum()</span><br><span class="line"></span><br><span class="line">	fmt.Printf(&quot;%x\n&quot;,hashnum)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">李国玉</p>
              <p class="site-description motion-element" itemprop="description">李国玉的技术博客，主要研究区块链方向，坚信区块链是第三次革命，拥抱区块链</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">13</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李国玉</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.2.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.2.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.2.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.2.0"></script>



  



	





  





  










  





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
